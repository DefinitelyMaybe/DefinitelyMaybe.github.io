import{Y as Kt,Z as he,r as Ze,S as ie,i as se,s as ee,N as Te,O as Ae,P as be,q as B,o as I,e as pe,c as ge,a as we,d as D,b as Ue,g as X,_ as on,M as Ie,n as Vt,p as Nt,G as fi,Q as q,v as Un,T as Ye,K as Se,X as ue,$ as gt,D as Bt,a0 as wt,a1 as ve,w as N,k as oe,x as k,m as ae,y as G,a2 as Oe,B as j,a3 as V,a4 as di,l as Ve,a5 as It,J as _e,z as Dn,f as Ee,C as Kn,E as et,a6 as hi,t as Je,h as $e,j as Vn,L as mi}from"../../chunks/index-269e7057.js";import{O as Tt,g as Nn,F as kt,b as kn,C as Ke,d as Ce,h as Ct,U as xt,i as qe,V as Q,A as _i,j as pi,f as Gn,L as an,s as ht,N as gi,k as wi,W as Ti,e as At,c as Ai,R as jn,l as bi,m as Ne,n as Si,o as bt,p as Ku,q as Vu,r as Nu,t as ku,u as Ri,v as Mi,Q as Gt,E as yi,w as Gu,B as en,x as ju,y as Hu,T as zu,P as vi,z as Oi,G as Ei,D as Ci,I as Fi,J as Li,K as Wt,X as Xu,Y as Wu,Z as Yu,_ as Qu,M as mt,$ as Zu,a0 as qu,a1 as Ju,a2 as _n,a3 as $u,a4 as ef,a5 as tf,a6 as Pi,a7 as nf,a8 as sf,a9 as rf,aa as of,ab as af,ac as pn,ad as lf,ae as cf,af as uf,ag as ff,ah as df,ai as hf,aj as mf,ak as _f,al as pf,am as gf,an as wf,ao as Tf,ap as Af,aq as bf,ar as Sf,as as Rf,at as Mf,au as yf,av as tn,aw as vf,ax as Hn,ay as Bi,az as Ii,aA as We,aB as dt,aC as xi,aD as Ui,aE as Di,aF as Ki,aG as Vi,aH as Ni,aI as ki,aJ as Gi,aK as ji,aL as yt,aM as vt,aN as Ft,aO as Lt,aP as Hi,aQ as zi,aR as Of,aS as Ef,aT as Cf,aU as Pt,aV as Xi,aW as jt,aX as Wi,aY as Yi}from"../../chunks/OrbitControls-fa0eed82.js";import{d as nn,w as ye,r as Qi}from"../../chunks/index-a97c2f54.js";import{s as Ot}from"../../chunks/index-fba0100c.js";class St{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const Zi=new Tt(-1,1,1,-1,0,1),ln=new Nn;ln.setAttribute("position",new kt([-1,3,0,-1,-1,0,3,-1,0],3));ln.setAttribute("uv",new kt([0,2,0,0,2,0],2));class zn{constructor(e){this._mesh=new kn(ln,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Zi)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const Ut={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`},gn={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ke(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class _t extends St{constructor(e,t,i,s){super(),this.strength=t!==void 0?t:1,this.radius=i,this.threshold=s,this.resolution=e!==void 0?new Ce(e.x,e.y):new Ce(256,256),this.clearColor=new Ke(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let r=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Ct(r,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let m=0;m<this.nMips;m++){const u=new Ct(r,o);u.texture.name="UnrealBloomPass.h"+m,u.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(u);const h=new Ct(r,o);h.texture.name="UnrealBloomPass.v"+m,h.texture.generateMipmaps=!1,this.renderTargetsVertical.push(h),r=Math.round(r/2),o=Math.round(o/2)}gn===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const l=gn;this.highPassUniforms=xt.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new qe({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const a=[3,5,7,9,11];r=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let m=0;m<this.nMips;m++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(a[m])),this.separableBlurMaterials[m].uniforms.texSize.value=new Ce(r,o),r=Math.round(r/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const c=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=c,this.bloomTintColors=[new Q(1,1,1),new Q(1,1,1),new Q(1,1,1),new Q(1,1,1),new Q(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,Ut===void 0&&console.error("THREE.UnrealBloomPass relies on CopyShader");const _=Ut;this.copyUniforms=xt.clone(_.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new qe({uniforms:this.copyUniforms,vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,blending:_i,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ke,this.oldClearAlpha=1,this.basic=new pi,this.fsQuad=new zn(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,t){let i=Math.round(e/2),s=Math.round(t/2);this.renderTargetBright.setSize(i,s);for(let r=0;r<this.nMips;r++)this.renderTargetsHorizontal[r].setSize(i,s),this.renderTargetsVertical[r].setSize(i,s),this.separableBlurMaterials[r].uniforms.texSize.value=new Ce(i,s),i=Math.round(i/2),s=Math.round(s/2)}render(e,t,i,s,r){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),r&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let l=this.renderTargetBright;for(let a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=l.texture,this.separableBlurMaterials[a].uniforms.direction.value=_t.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[a]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=_t.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[a]),e.clear(),this.fsQuad.render(e),l=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,r&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new qe({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Ce(.5,.5)},direction:{value:new Ce(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new qe({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}_t.BlurDirectionX=new Ce(1,0);_t.BlurDirectionY=new Ce(0,1);const qi=Math.PI/180;class wn extends St{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof qe?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=xt.clone(e.uniforms),this.material=new qe({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new zn(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class Tn extends St{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const s=e.getContext(),r=e.state;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0);let o,l;this.inverse?(o=0,l=1):(o=1,l=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),r.buffers.stencil.setFunc(s.ALWAYS,o,4294967295),r.buffers.stencil.setClear(l),r.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.stencil.setLocked(!1),r.buffers.stencil.setFunc(s.EQUAL,1,4294967295),r.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),r.buffers.stencil.setLocked(!0)}}class Ji extends St{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class $i{constructor(e,t){if(this.renderer=e,t===void 0){const i=e.getSize(new Ce);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,t=new Ct(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],Ut===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),wn===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new wn(Ut),this.clock=new Gn}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let s=0,r=this.passes.length;s<r;s++){const o=this.passes[s];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const l=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}Tn!==void 0&&(o instanceof Tn?i=!0:o instanceof Ji&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new Ce);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let r=0;r<this.passes.length;r++)this.passes[r].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new Tt(-1,1,1,-1,0,1);const Xn=new Nn;Xn.setAttribute("position",new kt([-1,3,0,-1,-1,0,3,-1,0],3));Xn.setAttribute("uv",new kt([0,2,0,0,2,0],2));class Wn extends St{constructor(e,t,i,s,r){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=r!==void 0?r:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ke}render(e,t,i){const s=e.autoClear;e.autoClear=!1;let r,o;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,r),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=s}}const es=(n,e,t)=>{n.renderer=new Ti({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t}),n.composer=new $i(n.renderer),n.composer.addPass(new Wn(n.scene,Kt(n.camera)))},An=(n,e,t)=>{!n.renderer||(e?n.renderer.outputEncoding=an:n.renderer.outputEncoding=ht,t?n.renderer.toneMapping=gi:n.renderer.toneMapping=wi)},bn=(n,e,t)=>{!n.renderer||!n.composer||(n.renderer.setSize(e.width,e.height),n.renderer.setPixelRatio(t),n.composer.setSize(e.width,e.height),n.composer.setPixelRatio(t))},Sn=(n,e,t)=>{!n.renderer||(n.renderer.shadowMap.enabled=e,n.renderer.shadowMap.type=t)},Fe=n=>n.userData,ts=(n,e)=>{n.pointer.update(t=>n.renderer?t.set(e.offsetX/n.renderer.domElement.clientWidth*2-1,-(e.offsetY/n.renderer.domElement.clientHeight)*2+1):t)},Yn=(n,e,t,i)=>(n.raycaster.setFromCamera(e,t),n.raycaster.intersectObjects(i,!1)),ns=(n,e)=>n.object.uuid!==e.object.uuid||n.instanceId!==e.instanceId,is=(n,e,t)=>{let i;const s=n.camera.subscribe(a=>i=a);he(s);let r;const o=n.pointer.subscribe(a=>r=a);he(o);const l=a=>{var _,m;if(a.preventDefault(),n.pointerOverCanvas.set(!0),t.pointerInvalidated=!0,ts(n,a),e.interactiveObjects.size===0||e.raycastableObjects.size===0)return;const c=Yn(e,r,i,Array.from(e.raycastableObjects));c.length>0&&e.interactiveObjects.has(c[0].object)&&((m=(_=Fe(c[0].object)).eventDispatcher)==null||m.call(_,a.type,{...c[0],event:a}))};return{onClick:l,onContextMenu:l,onPointerUp:l,onPointerDown:l,onPointerMove:l}},ss=(n,e)=>{let t=Kt(n.pointerOverCanvas);const i=n.pointerOverCanvas.subscribe(c=>t=c);he(i);let s;const r=n.camera.subscribe(c=>s=c);he(r);let o;const l=n.pointer.subscribe(c=>o=c);return he(l),{raycast:()=>{var m,u,h,A,f,d,g,p;if(e.interactiveObjects.size===0||e.raycastableObjects.size===0)return;const c=t?Yn(e,o,s,Array.from(e.raycastableObjects)):[],_=c.length&&e.interactiveObjects.has(c[0].object)?c[0]:null;_?e.lastIntersection?e.lastIntersection&&ns(e.lastIntersection,_)&&((d=(f=Fe(e.lastIntersection.object)).eventDispatcher)==null||d.call(f,"pointerleave",e.lastIntersection),(p=(g=Fe(_.object)).eventDispatcher)==null||p.call(g,"pointerenter",_)):(A=(h=Fe(_.object)).eventDispatcher)==null||A.call(h,"pointerenter",_):e.lastIntersection&&((u=(m=Fe(e.lastIntersection.object)).eventDispatcher)==null||u.call(m,"pointerleave",e.lastIntersection)),e.lastIntersection=_}}},Ht=typeof window!="undefined",rs=n=>{if(!Ht)return;let e;const t=()=>{n(),e=requestAnimationFrame(t)};t(),he(()=>{!e||cancelAnimationFrame(e)})},os=(n,e)=>{if(e.frameHandlers.size===0)return;if(e.debugFrameloop){let s=0;e.frameHandlers.forEach(r=>{r.debugFrameloopMessage?e.invalidations[r.debugFrameloopMessage]=r.debugFrameloopMessage in e.invalidations?e.invalidations[r.debugFrameloopMessage]+1:1:++s}),s>0&&(e.invalidations.onFrame=e.frameHandlers.size)}const t=Array.from(e.frameHandlers).reduce((s,r)=>r.order?!0:s,!1),i=n.clock.getDelta();t?Array.from(e.frameHandlers).sort((s,r)=>{var o,l;return((o=s.order)!=null?o:0)>((l=r.order)!=null?l:0)?1:-1}).forEach(s=>s.fn(n,i)):e.frameHandlers.forEach(s=>s.fn(n,i))},as=n=>{!n.debugFrameloop||(n.frame+=1,console.log(`frame: ${n.frame}${Object.keys(n.invalidations).length>0?", requested by \u21B4":""}`),Object.keys(n.invalidations).length>0&&console.table(n.invalidations),n.invalidations={})},ls=(n,e,t)=>{let i=Kt(n.camera);const s=n.camera.subscribe(o=>i=o);he(s);const{raycast:r}=ss(n,e);rs(()=>{const o=t.frameloop==="always"||t.frameloop==="demand"&&(t.frameInvalidated||t.frameHandlers.size>0)||t.frameloop==="never"&&t.advance;(o||t.pointerInvalidated)&&(r(),t.pointerInvalidated=!1),o&&(!i||!n.composer||!n.renderer||(os(n,t),n.composer.passes.length>1?n.composer.render():n.renderer.render(n.scene,i),as(t),t.frameInvalidated=!1,t.advance=!1))})},cs=()=>{const n=new At(75,0,.1,1e3);return Fe(n).threlteDefaultCamera=!0,n.position.z=5,n.lookAt(0,0,0),n},us=n=>{const e=n.size.subscribe(t=>{Fe(Kt(n.camera)).threlteDefaultCamera&&n.camera.update(i=>{const s=i;return s.aspect=t.width/t.height,s.updateProjectionMatrix(),n.invalidate("Default camera: aspect ratio changed"),s})});he(e)},fs=(n,e,t,i,s,r,o)=>{const l={audioListeners:new Map,addAudioListener:(f,d)=>{if(d=d!=null?d:"default",l.audioListeners.has(d)){console.warn(`An AudioListener with the id "${d}" has already been added, aborting.`);return}l.audioListeners.set(d,f)},removeAudioListener:f=>{if(f=f!=null?f:"default",!l.audioListeners.has(f)){console.warn(`No AudioListener with the id "${f}" found, aborting.`);return}l.audioListeners.delete(f)},getAudioListener:f=>{if(f=f!=null?f:"default",!l.audioListeners.has(f)){console.warn(`No AudioListener with the id "${f}" found, aborting.`);return}return l.audioListeners.get(f)}},a={debugFrameloop:r,frameloop:o,frame:0,frameInvalidated:!0,pointerInvalidated:!0,invalidations:{},frameHandlers:new Set,advance:!1},c={size:nn([i,s],([f,d])=>f||d),pointer:ye(new Ce),pointerOverCanvas:ye(!1),clock:new Gn,camera:ye(cs()),scene:new Ai,renderer:void 0,composer:void 0,invalidate:f=>{a.frameInvalidated=!0,a.debugFrameloop&&f&&(a.invalidations[f]=a.invalidations[f]?a.invalidations[f]+1:1)},advance:()=>{a.advance=!0}},_={flat:ye(e),linear:ye(n),dpr:ye(t),setCamera:f=>{c.camera.set(f),c.composer&&(c.composer.passes.forEach(d=>{d instanceof Wn&&(d.camera=f)}),c.invalidate("Canvas: setting camera"))},raycastableObjects:new Set,interactiveObjects:new Set,raycaster:new jn,lastIntersection:null,addRaycastableObject:f=>{_.raycastableObjects.add(f)},removeRaycastableObject:f=>{_.raycastableObjects.delete(f)},addInteractiveObject:f=>{_.interactiveObjects.add(f)},removeInteractiveObject:f=>{_.interactiveObjects.delete(f)},addPass:f=>{!c.composer||(c.composer.addPass(f),c.invalidate("Canvas: adding pass"))},removePass:f=>{!c.composer||(c.composer.removePass(f),c.invalidate("Canvas: removing pass"))}};return Ze("threlte",c),Ze("threlte-root",_),Ze("threlte-render-context",a),Ze("threlte-audio-context",l),{ctx:c,rootCtx:_,renderCtx:a,audioCtx:l,getCtx:()=>c,getRootCtx:()=>_,getRenderCtx:()=>a,getAudioCtx:()=>l}},ds=()=>{const n=ye({width:0,height:0});let e={width:0,height:0};const t=n.subscribe(o=>e=o);he(t);let i;const s=()=>{const o=e;if(!i||!i.parentElement)return;const{clientWidth:l,clientHeight:a}=i.parentElement;(l!==o.width||a!==o.height)&&n.set({width:l,height:a})},r=o=>{i=o,s(),window.addEventListener("resize",s)};return Ht?(he(()=>{window.removeEventListener("resize",s)}),{parentSizeAction:r,parentSize:n}):{parentSize:n,parentSizeAction:r}};function Rn(n){let e;const t=n[30].default,i=Se(t,n,n[29],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[0]&536870912)&&Te(i,t,s,s[29],e?be(t,s[29],r,null):Ae(s[29]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function hs(n){let e,t,i,s,r=n[1]&&Rn(n);return{c(){e=pe("canvas"),r&&r.c(),this.h()},l(o){e=ge(o,"CANVAS",{class:!0});var l=we(e);r&&r.l(l),l.forEach(D),this.h()},h(){Ue(e,"class","svelte-15bl8wt")},m(o,l){X(o,e,l),r&&r.m(e,null),n[31](e),t=!0,i||(s=[on(n[2].call(null,e)),Ie(e,"click",n[8]),Ie(e,"contextmenu",n[9]),Ie(e,"pointerup",n[12]),Ie(e,"pointerdown",n[10]),Ie(e,"pointermove",n[11]),Ie(e,"pointerenter",n[32]),Ie(e,"pointerleave",n[33])],i=!0)},p(o,l){o[1]?r?(r.p(o,l),l[0]&2&&B(r,1)):(r=Rn(o),r.c(),B(r,1),r.m(e,null)):r&&(Vt(),I(r,1,1,()=>{r=null}),Nt())},i(o){t||(B(r),t=!0)},o(o){I(r),t=!1},d(o){o&&D(e),r&&r.d(),n[31](null),i=!1,fi(s)}}}const Mn=new Set;function ms(n,e,t){let i,s,r,o,{$$slots:l={},$$scope:a}=e,{dpr:c=Ht?window.devicePixelRatio:1}=e,{flat:_=!1}=e,{linear:m=!1}=e,{frameloop:u="demand"}=e,{debugFrameloop:h=!1}=e,{shadows:A=!0}=e,{shadowMapType:f=bi}=e,{size:d=void 0}=e,{rendererParameters:g=void 0}=e,p,w=!1;const b=ye(d),{parentSize:R,parentSizeAction:T}=ds(),C=fs(m,_,c,b,R,h,u),{getCtx:S,getRootCtx:y,getRenderCtx:x,renderCtx:v}=C,{ctx:U,rootCtx:E,audioCtx:L}=C;us(U),Mn.add(U.invalidate),he(()=>{Mn.delete(U.invalidate)});const{size:W,scene:$}=U;q(n,W,K=>t(26,s=K));const{flat:z,linear:Y,dpr:F}=E;q(n,z,K=>t(27,r=K)),q(n,Y,K=>t(28,o=K)),q(n,F,K=>t(25,i=K)),Ze("threlte-parent",ye($)),Un(()=>{!p||(es(U,p,g),An(U,o,r),bn(U,s,i),Sn(U,A,f),t(1,w=!0))}),ls(U,E,v);const{onClick:O,onContextMenu:te,onPointerDown:H,onPointerMove:ne,onPointerUp:le}=is(U,E,v);function P(K){ue[K?"unshift":"push"](()=>{p=K,t(0,p)})}const me=()=>S().pointerOverCanvas.set(!0),J=()=>S().pointerOverCanvas.set(!1);return n.$$set=K=>{"dpr"in K&&t(13,c=K.dpr),"flat"in K&&t(14,_=K.flat),"linear"in K&&t(15,m=K.linear),"frameloop"in K&&t(16,u=K.frameloop),"debugFrameloop"in K&&t(17,h=K.debugFrameloop),"shadows"in K&&t(18,A=K.shadows),"shadowMapType"in K&&t(19,f=K.shadowMapType),"size"in K&&t(20,d=K.size),"rendererParameters"in K&&t(21,g=K.rendererParameters),"$$scope"in K&&t(29,a=K.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1048576&&b.set(d),n.$$.dirty[0]&32768&&Ye(Y,o=m,o),n.$$.dirty[0]&16384&&Ye(z,r=_,r),n.$$.dirty[0]&8192&&Ye(F,i=c,i),n.$$.dirty[0]&402653184&&An(S(),o,r),n.$$.dirty[0]&100663296&&bn(S(),s,i),n.$$.dirty[0]&786432&&Sn(S(),A,f)},[p,w,T,S,W,z,Y,F,O,te,H,ne,le,c,_,m,u,h,A,f,d,g,U,E,L,i,s,r,o,a,l,P,me,J]}class _s extends ie{constructor(e){super(),se(this,e,ms,hs,ee,{dpr:13,flat:14,linear:15,frameloop:16,debugFrameloop:17,shadows:18,shadowMapType:19,size:20,rendererParameters:21,ctx:22,rootCtx:23,audioCtx:24},null,[-1,-1])}get ctx(){return this.$$.ctx[22]}get rootCtx(){return this.$$.ctx[23]}get audioCtx(){return this.$$.ctx[24]}}const Le=()=>gt("threlte"),zt=()=>gt("threlte-root"),cn=n=>{const e=ye(n);let t=n;const i=e.subscribe(r=>t=r);return he(i),{...e,set:r=>{r.uuid!==t.uuid&&e.set(r)}}};function ps(n){let e;const t=n[8].default,i=Se(t,n,n[7],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,[r]){i&&i.p&&(!e||r&128)&&Te(i,t,s,s[7],e?be(t,s[7],r,null):Ae(s[7]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}const gs=n=>{Ze("threlte-parent",n)},Qn=()=>gt("threlte-parent");function ws(n,e,t){let i,s,{$$slots:r={},$$scope:o}=e;const l=Qn();q(n,l,h=>t(6,s=h));let a=s,{object:c}=e;const _=ye(c);q(n,_,h=>t(5,i=h));let m=c;gs(_);const{invalidate:u}=Le();return s.add(i),u("HierarchicalObject: object added"),he(()=>{s.remove(i),u("HierarchicalObject: object removed")}),n.$$set=h=>{"object"in h&&t(2,c=h.object),"$$scope"in h&&t(7,o=h.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&Ye(_,i=c,i),n.$$.dirty&112&&i!==m&&(m&&s.remove(m),s.add(i),u("HierarchicalObject: object changed"),t(4,m=i)),n.$$.dirty&104&&s!==a&&(a.remove(i),s.add(i),u("HierarchicalObject: parent changed"),t(3,a=s))},[l,_,c,a,m,i,s,o,r]}class Zn extends ie{constructor(e){super(),se(this,e,ws,ps,ee,{object:2})}}function Ts(n,e,t){let i,s,{object:r}=e;const o=cn(r);q(n,o,c=>t(4,s=c));const l=gt("threlte-layers");q(n,l,c=>t(3,i=c));const{invalidate:a}=Le();return n.$$set=c=>{"object"in c&&t(2,r=c.object)},n.$$.update=()=>{if(n.$$.dirty&4&&o.set(r),n.$$.dirty&24){if(i==="all")s.layers.enableAll();else if(i==="none")s.layers.disableAll();else if(Array.isArray(i))for(let c=0;c<32;c+=1){const _=c;i.includes(_)?s.layers.enable(c):s.layers.disable(c)}else i!==void 0&&s.layers.set(i);a("LayerableObject")}},[o,l,r,i,s]}class As extends ie{constructor(e){super(),se(this,e,Ts,null,ee,{object:2})}}const Rt=(n,e)=>{var l;if(!Ht)return{start:()=>{},stop:()=>{},started:Qi(!1)};const t=gt("threlte-render-context"),i={fn:n,order:e==null?void 0:e.order,debugFrameloopMessage:e==null?void 0:e.debugFrameloopMessage},s=ye(!1),r=()=>{t.frameHandlers.delete(i),s.set(!1)},o=()=>{t.frameHandlers.add(i),s.set(!0)};return((l=e==null?void 0:e.autostart)==null||l)&&o(),he(()=>{r()}),{start:o,stop:r,started:{subscribe:s.subscribe}}},qn=()=>{const n=ye(!1);return(async()=>{await Bt(),n.set(!0)})(),n};function bs(n,e,t){let i,s,{object:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e;const _=new Q,m=wt(),{invalidate:u}=Le(),h=qn();q(n,h,w=>t(8,s=w));const A=async()=>{s||await Bt(),m("transform")},f=async()=>{u("TransformableObject: transformed"),await A()};Fe(r).onTransform=f;const{start:d,stop:g}=Rt(async()=>{c&&!a&&c instanceof Ne&&(c.getWorldPosition(_),r.lookAt(_),await A())},{autostart:!1,debugFrameloopMessage:"TransformableObject: tracking object"}),p=cn(r);return q(n,p,w=>t(7,i=w)),n.$$set=w=>{"object"in w&&t(2,r=w.object),"position"in w&&t(3,o=w.position),"scale"in w&&t(4,l=w.scale),"rotation"in w&&t(5,a=w.rotation),"lookAt"in w&&t(6,c=w.lookAt)},n.$$.update=()=>{var w,b,R,T,C,S,y,x,v,U,E,L,W;n.$$.dirty&4&&p.set(r),n.$$.dirty&232&&(o&&(i.position.set((w=o.x)!=null?w:0,(b=o.y)!=null?b:0,(R=o.z)!=null?R:0),f()),c&&!a&&(c instanceof Ne?d():(g(),i.lookAt((T=c.x)!=null?T:0,(C=c.y)!=null?C:0,(S=c.z)!=null?S:0),f())),c||g()),n.$$.dirty&144&&l&&(typeof l=="number"?i.scale.set(l,l,l):i.scale.set((y=l.x)!=null?y:1,(x=l.y)!=null?x:1,(v=l.z)!=null?v:1),f()),n.$$.dirty&160&&a&&(i.rotation.set((U=a.x)!=null?U:0,(E=a.y)!=null?E:0,(L=a.z)!=null?L:0,(W=a.order)!=null?W:"XYZ"),f())},[h,p,r,o,l,a,c,i]}class un extends ie{constructor(e){super(),se(this,e,bs,null,ee,{object:2,position:3,scale:4,rotation:5,lookAt:6})}}function Ss(n,e,t){let i,s,r,{object:o}=e,{viewportAware:l=!1}=e;const a=wt(),{camera:c,invalidate:_}=Le();q(n,c,T=>t(8,r=T));const m=new Si,u=new bt,h=T=>T.type==="Mesh",A=new Q,f=()=>r?(u.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),m.setFromProjectionMatrix(u),h(o)?m.intersectsObject(o):(o.getWorldPosition(A),m.containsPoint(A))):!0,d=qn();q(n,d,T=>t(7,s=T));let{inViewport:g=f()}=e;const p=async T=>{T?(s||await Bt(),a("viewportenter",o)):(s||await Bt(),a("viewportleave",o))},{start:w,stop:b,started:R}=Rt(()=>{const T=f();g===void 0?(t(3,g=f()),p(g)):T!==g&&(p(T),t(3,g=T))},{autostart:l,debugFrameloopMessage:"ViewportAwareObject: tracking viewport visibility"});return q(n,R,T=>t(6,i=T)),_("ViewportAwareObject"),n.$$set=T=>{"object"in T&&t(4,o=T.object),"viewportAware"in T&&t(5,l=T.viewportAware),"inViewport"in T&&t(3,g=T.inViewport)},n.$$.update=()=>{n.$$.dirty&96&&(l&&!i?w():!l&&i&&b())},[c,d,R,g,o,l,i]}class Rs extends ie{constructor(e){super(),se(this,e,Ss,null,ee,{object:4,viewportAware:5,inViewport:3})}}function Ms(n){let e;const t=n[12].default,i=Se(t,n,n[16],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&65536)&&Te(i,t,s,s[16],e?be(t,s[16],r,null):Ae(s[16]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function ys(n){let e,t,i,s,r,o,l,a,c;e=new As({props:{object:n[1]}}),i=new un({props:{object:n[1],position:n[2],rotation:n[4],scale:n[3],lookAt:n[5]}}),r=new Zn({props:{object:n[1],$$slots:{default:[Ms]},$$scope:{ctx:n}}});function _(u){n[13](u)}let m={object:n[1],viewportAware:n[6]};return n[0]!==void 0&&(m.inViewport=n[0]),l=new Rs({props:m}),ue.push(()=>ve(l,"inViewport",_)),l.$on("viewportenter",n[14]),l.$on("viewportleave",n[15]),{c(){N(e.$$.fragment),t=oe(),N(i.$$.fragment),s=oe(),N(r.$$.fragment),o=oe(),N(l.$$.fragment)},l(u){k(e.$$.fragment,u),t=ae(u),k(i.$$.fragment,u),s=ae(u),k(r.$$.fragment,u),o=ae(u),k(l.$$.fragment,u)},m(u,h){G(e,u,h),X(u,t,h),G(i,u,h),X(u,s,h),G(r,u,h),X(u,o,h),G(l,u,h),c=!0},p(u,[h]){const A={};h&2&&(A.object=u[1]),e.$set(A);const f={};h&2&&(f.object=u[1]),h&4&&(f.position=u[2]),h&16&&(f.rotation=u[4]),h&8&&(f.scale=u[3]),h&32&&(f.lookAt=u[5]),i.$set(f);const d={};h&2&&(d.object=u[1]),h&65536&&(d.$$scope={dirty:h,ctx:u}),r.$set(d);const g={};h&2&&(g.object=u[1]),h&64&&(g.viewportAware=u[6]),!a&&h&1&&(a=!0,g.inViewport=u[0],Oe(()=>a=!1)),l.$set(g)},i(u){c||(B(e.$$.fragment,u),B(i.$$.fragment,u),B(r.$$.fragment,u),B(l.$$.fragment,u),c=!0)},o(u){I(e.$$.fragment,u),I(i.$$.fragment,u),I(r.$$.fragment,u),I(l.$$.fragment,u),c=!1},d(u){j(e,u),u&&D(t),j(i,u),u&&D(s),j(r,u),u&&D(o),j(l,u)}}}function vs(n,e,t){let{$$slots:i={},$$scope:s}=e,{object:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e,{viewportAware:_=!1}=e,{inViewport:m=!1}=e,{castShadow:u=void 0}=e,{receiveShadow:h=void 0}=e,{frustumCulled:A=void 0}=e,{renderOrder:f=void 0}=e,{visible:d=void 0}=e;const{invalidate:g}=Le(),p=()=>r;function w(T){m=T,t(0,m)}function b(T){V.call(this,n,T)}function R(T){V.call(this,n,T)}return n.$$set=T=>{"object"in T&&t(1,r=T.object),"position"in T&&t(2,o=T.position),"scale"in T&&t(3,l=T.scale),"rotation"in T&&t(4,a=T.rotation),"lookAt"in T&&t(5,c=T.lookAt),"viewportAware"in T&&t(6,_=T.viewportAware),"inViewport"in T&&t(0,m=T.inViewport),"castShadow"in T&&t(7,u=T.castShadow),"receiveShadow"in T&&t(8,h=T.receiveShadow),"frustumCulled"in T&&t(9,A=T.frustumCulled),"renderOrder"in T&&t(10,f=T.renderOrder),"visible"in T&&t(11,d=T.visible),"$$scope"in T&&t(16,s=T.$$scope)},n.$$.update=()=>{n.$$.dirty&3968&&(d!==void 0&&(p().visible=d),u!==void 0&&(p().castShadow=u),h!==void 0&&(p().receiveShadow=h),A!==void 0&&(p().frustumCulled=A),f!==void 0&&(p().renderOrder=f),g("Object3DInstance: props changed"))},[m,r,o,l,a,c,_,u,h,A,f,d,i,w,b,R,s]}class Xt extends ie{constructor(e){super(),se(this,e,vs,ys,ee,{object:1,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:0,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11})}}function Os(n){let e;const t=n[15].default,i=Se(t,n,n[19],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&524288)&&Te(i,t,s,s[19],e?be(t,s[19],r,null):Ae(s[19]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function Es(n){let e,t,i;function s(o){n[16](o)}let r={object:n[1],lookAt:n[5],castShadow:n[7],receiveShadow:n[8],frustumCulled:n[9],renderOrder:n[10],position:n[2],scale:n[3],rotation:n[4],viewportAware:n[6],visible:n[11],$$slots:{default:[Os]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.inViewport=n[0]),e=new Xt({props:r}),ue.push(()=>ve(e,"inViewport",s)),e.$on("viewportenter",n[17]),e.$on("viewportleave",n[18]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,[l]){const a={};l&2&&(a.object=o[1]),l&32&&(a.lookAt=o[5]),l&128&&(a.castShadow=o[7]),l&256&&(a.receiveShadow=o[8]),l&512&&(a.frustumCulled=o[9]),l&1024&&(a.renderOrder=o[10]),l&4&&(a.position=o[2]),l&8&&(a.scale=o[3]),l&16&&(a.rotation=o[4]),l&64&&(a.viewportAware=o[6]),l&2048&&(a.visible=o[11]),l&524288&&(a.$$scope={dirty:l,ctx:o}),!t&&l&1&&(t=!0,a.inViewport=o[0],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function Cs(n,e,t){let i,{$$slots:s={},$$scope:r}=e,{camera:o}=e,{position:l=void 0}=e,{scale:a=void 0}=e,{rotation:c=void 0}=e,{lookAt:_=void 0}=e,{viewportAware:m=!1}=e,{inViewport:u=!1}=e,{castShadow:h=void 0}=e,{receiveShadow:A=void 0}=e,{frustumCulled:f=void 0}=e,{renderOrder:d=void 0}=e,{visible:g=void 0}=e,{useCamera:p=!1}=e;const w=cn(o);q(n,w,S=>t(14,i=S));const{setCamera:b}=zt();function R(S){u=S,t(0,u)}function T(S){V.call(this,n,S)}function C(S){V.call(this,n,S)}return n.$$set=S=>{"camera"in S&&t(1,o=S.camera),"position"in S&&t(2,l=S.position),"scale"in S&&t(3,a=S.scale),"rotation"in S&&t(4,c=S.rotation),"lookAt"in S&&t(5,_=S.lookAt),"viewportAware"in S&&t(6,m=S.viewportAware),"inViewport"in S&&t(0,u=S.inViewport),"castShadow"in S&&t(7,h=S.castShadow),"receiveShadow"in S&&t(8,A=S.receiveShadow),"frustumCulled"in S&&t(9,f=S.frustumCulled),"renderOrder"in S&&t(10,d=S.renderOrder),"visible"in S&&t(11,g=S.visible),"useCamera"in S&&t(13,p=S.useCamera),"$$scope"in S&&t(19,r=S.$$scope)},n.$$.update=()=>{n.$$.dirty&2&&w.set(o),n.$$.dirty&24576&&p&&b(i)},[u,o,l,a,c,_,m,h,A,f,d,g,w,p,i,s,R,T,C,r]}class Fs extends ie{constructor(e){super(),se(this,e,Cs,Es,ee,{camera:1,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:0,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11,useCamera:13})}}function Ls(n){let e;const t=n[18].default,i=Se(t,n,n[22],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&4194304)&&Te(i,t,s,s[22],e?be(t,s[22],r,null):Ae(s[22]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function Ps(n){let e,t,i;function s(o){n[19](o)}let r={camera:n[0],position:n[2],scale:n[3],rotation:n[4],castShadow:n[6],receiveShadow:n[7],frustumCulled:n[8],renderOrder:n[9],visible:n[10],viewportAware:n[11],lookAt:n[5],useCamera:n[12],$$slots:{default:[Ls]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.inViewport=n[1]),e=new Fs({props:r}),ue.push(()=>ve(e,"inViewport",s)),e.$on("viewportenter",n[20]),e.$on("viewportleave",n[21]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,[l]){const a={};l&1&&(a.camera=o[0]),l&4&&(a.position=o[2]),l&8&&(a.scale=o[3]),l&16&&(a.rotation=o[4]),l&64&&(a.castShadow=o[6]),l&128&&(a.receiveShadow=o[7]),l&256&&(a.frustumCulled=o[8]),l&512&&(a.renderOrder=o[9]),l&1024&&(a.visible=o[10]),l&2048&&(a.viewportAware=o[11]),l&32&&(a.lookAt=o[5]),l&4096&&(a.useCamera=o[12]),l&4194304&&(a.$$scope={dirty:l,ctx:o}),!t&&l&2&&(t=!0,a.inViewport=o[1],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function Bs(n,e,t){let i,{$$slots:s={},$$scope:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e,{castShadow:_=void 0}=e,{receiveShadow:m=void 0}=e,{frustumCulled:u=void 0}=e,{renderOrder:h=void 0}=e,{visible:A=void 0}=e,{viewportAware:f=!1}=e,{inViewport:d=!1}=e,{useCamera:g=!0}=e,{near:p=void 0}=e,{far:w=void 0}=e,{fov:b=void 0}=e;const{size:R,invalidate:T}=Le();q(n,R,v=>t(17,i=v));const C=new At(b,i.width/i.height,p,w);function S(v){d=v,t(1,d)}function y(v){V.call(this,n,v)}function x(v){V.call(this,n,v)}return n.$$set=v=>{"position"in v&&t(2,o=v.position),"scale"in v&&t(3,l=v.scale),"rotation"in v&&t(4,a=v.rotation),"lookAt"in v&&t(5,c=v.lookAt),"castShadow"in v&&t(6,_=v.castShadow),"receiveShadow"in v&&t(7,m=v.receiveShadow),"frustumCulled"in v&&t(8,u=v.frustumCulled),"renderOrder"in v&&t(9,h=v.renderOrder),"visible"in v&&t(10,A=v.visible),"viewportAware"in v&&t(11,f=v.viewportAware),"inViewport"in v&&t(1,d=v.inViewport),"useCamera"in v&&t(12,g=v.useCamera),"near"in v&&t(14,p=v.near),"far"in v&&t(15,w=v.far),"fov"in v&&t(16,b=v.fov),"$$scope"in v&&t(22,r=v.$$scope)},n.$$.update=()=>{n.$$.dirty&131073&&(t(0,C.aspect=i.width/i.height,C),C.updateProjectionMatrix(),T("PerspectiveCamera: aspect changed")),n.$$.dirty&114689&&(p!==void 0&&t(0,C.near=p,C),w!==void 0&&t(0,C.far=w,C),b!==void 0&&t(0,C.fov=b,C),C.updateProjectionMatrix(),T("PerspectiveCamera: props changed"))},[C,d,o,l,a,c,_,m,u,h,A,f,g,R,p,w,b,i,s,S,y,x,r]}class Is extends ie{constructor(e){super(),se(this,e,Bs,Ps,ee,{position:2,scale:3,rotation:4,lookAt:5,castShadow:6,receiveShadow:7,frustumCulled:8,renderOrder:9,visible:10,viewportAware:11,inViewport:1,useCamera:12,near:14,far:15,fov:16,camera:0})}get camera(){return this.$$.ctx[0]}}const yn=[],xs=(n,e)=>{const t=yn.find(s=>s instanceof n);if(t)return t;const i=e();return yn.push(i),i};function Us(n){let e,t;return e=new un({props:{object:n[2],position:n[0]}}),e.$on("transform",n[3]),{c(){N(e.$$.fragment)},l(i){k(e.$$.fragment,i)},m(i,s){G(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.position=i[0]),e.$set(r)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){j(e,i)}}}function Ds(n,e,t){let i,{autoRotate:s=void 0}=e,{autoRotateSpeed:r=void 0}=e,{dampingFactor:o=void 0}=e,{enableDamping:l=void 0}=e,{enabled:a=void 0}=e,{enablePan:c=void 0}=e,{enableRotate:_=void 0}=e,{enableZoom:m=void 0}=e,{keyPanSpeed:u=void 0}=e,{keys:h=void 0}=e,{maxAzimuthAngle:A=void 0}=e,{maxDistance:f=void 0}=e,{maxPolarAngle:d=void 0}=e,{maxZoom:g=void 0}=e,{minAzimuthAngle:p=void 0}=e,{minDistance:w=void 0}=e,{minPolarAngle:b=void 0}=e,{minZoom:R=void 0}=e,{mouseButtons:T=void 0}=e,{panSpeed:C=void 0}=e,{rotateSpeed:S=void 0}=e,{screenSpacePanning:y=void 0}=e,{touches:x=void 0}=e,{zoomSpeed:v=void 0}=e,{target:U=void 0}=e;const E=Qn();q(n,E,P=>t(29,i=P));const{renderer:L,invalidate:W}=Le();if(!L)throw new Error("Threlte Context missing: Is <OrbitControls> a child of <Canvas>?");if(!(i instanceof Ri))throw new Error("Parent missing: <OrbitControls> need to be a child of a <Camera>");const $=wt(),z=()=>{W("Orbitcontrols: change event"),$("change")},Y=()=>$("start"),F=()=>$("end"),O=new Mi(i,L.domElement);Fe(i).orbitControls=O,O.addEventListener("change",z),O.addEventListener("start",Y),O.addEventListener("end",F),he(()=>{delete Fe(i).orbitControls,O.removeEventListener("change",z),O.removeEventListener("start",Y),O.removeEventListener("end",F)});const{start:te,stop:H}=Rt(()=>O.update(),{autostart:!1,debugFrameloopMessage:"OrbitControlts: updating controls"}),ne=new Ne,le=()=>{t(4,O.target=ne.position,O),O.update(),W("OrbitControls: target changed")};return he(()=>{O.dispose(),W("OrbitControls: onDestroy")}),n.$$set=P=>{"autoRotate"in P&&t(5,s=P.autoRotate),"autoRotateSpeed"in P&&t(6,r=P.autoRotateSpeed),"dampingFactor"in P&&t(7,o=P.dampingFactor),"enableDamping"in P&&t(8,l=P.enableDamping),"enabled"in P&&t(9,a=P.enabled),"enablePan"in P&&t(10,c=P.enablePan),"enableRotate"in P&&t(11,_=P.enableRotate),"enableZoom"in P&&t(12,m=P.enableZoom),"keyPanSpeed"in P&&t(13,u=P.keyPanSpeed),"keys"in P&&t(14,h=P.keys),"maxAzimuthAngle"in P&&t(15,A=P.maxAzimuthAngle),"maxDistance"in P&&t(16,f=P.maxDistance),"maxPolarAngle"in P&&t(17,d=P.maxPolarAngle),"maxZoom"in P&&t(18,g=P.maxZoom),"minAzimuthAngle"in P&&t(19,p=P.minAzimuthAngle),"minDistance"in P&&t(20,w=P.minDistance),"minPolarAngle"in P&&t(21,b=P.minPolarAngle),"minZoom"in P&&t(22,R=P.minZoom),"mouseButtons"in P&&t(23,T=P.mouseButtons),"panSpeed"in P&&t(24,C=P.panSpeed),"rotateSpeed"in P&&t(25,S=P.rotateSpeed),"screenSpacePanning"in P&&t(26,y=P.screenSpacePanning),"touches"in P&&t(27,x=P.touches),"zoomSpeed"in P&&t(28,v=P.zoomSpeed),"target"in P&&t(0,U=P.target)},n.$$.update=()=>{n.$$.dirty[0]&536870896&&(s!==void 0&&t(4,O.autoRotate=s,O),r!==void 0&&t(4,O.autoRotateSpeed=r,O),o!==void 0&&t(4,O.dampingFactor=o,O),l!==void 0&&t(4,O.enableDamping=l,O),a!==void 0&&t(4,O.enabled=a,O),c!==void 0&&t(4,O.enablePan=c,O),_!==void 0&&t(4,O.enableRotate=_,O),m!==void 0&&t(4,O.enableZoom=m,O),u!==void 0&&t(4,O.keyPanSpeed=u,O),h!==void 0&&t(4,O.keys=h,O),A!==void 0&&t(4,O.maxAzimuthAngle=A,O),f!==void 0&&t(4,O.maxDistance=f,O),d!==void 0&&t(4,O.maxPolarAngle=d,O),g!==void 0&&t(4,O.maxZoom=g,O),p!==void 0&&t(4,O.minAzimuthAngle=p,O),w!==void 0&&t(4,O.minDistance=w,O),b!==void 0&&t(4,O.minPolarAngle=b,O),R!==void 0&&t(4,O.minZoom=R,O),T!==void 0&&t(4,O.mouseButtons=T,O),C!==void 0&&t(4,O.panSpeed=C,O),S!==void 0&&t(4,O.rotateSpeed=S,O),y!==void 0&&t(4,O.screenSpacePanning=y,O),x!==void 0&&t(4,O.touches=x,O),v!==void 0&&t(4,O.zoomSpeed=v,O),O.update(),W("OrbitControls: props changed")),n.$$.dirty[0]&288&&(s||l?te():H())},[U,E,ne,le,O,s,r,o,l,a,c,_,m,u,h,A,f,d,g,p,w,b,R,T,C,S,y,x,v]}class Ks extends ie{constructor(e){super(),se(this,e,Ds,Us,ee,{autoRotate:5,autoRotateSpeed:6,dampingFactor:7,enableDamping:8,enabled:9,enablePan:10,enableRotate:11,enableZoom:12,keyPanSpeed:13,keys:14,maxAzimuthAngle:15,maxDistance:16,maxPolarAngle:17,maxZoom:18,minAzimuthAngle:19,minDistance:20,minPolarAngle:21,minZoom:22,mouseButtons:23,panSpeed:24,rotateSpeed:25,screenSpacePanning:26,touches:27,zoomSpeed:28,target:0,controls:4},null,[-1,-1])}get controls(){return this.$$.ctx[4]}}const Pf=new jn,Bf=new Q,If=new Q,xf=new Gt,Uf={X:new Q(1,0,0),Y:new Q(0,1,0),Z:new Q(0,0,1)};const Df=new yi,Kf=new Q(0,1,0),Vf=new Q(0,0,0),Nf=new bt,kf=new Gt,Gf=new Gt,jf=new Q,Hf=new bt,zf=new Q(1,0,0),Xf=new Q(0,1,0),Wf=new Q(0,0,1),Yf=new Q,Qf=new Q,Zf=new Q;const Vs=(n,e)=>e?new Ke(n):new Ke().setHex(new Ke(n).getHex()).convertSRGBToLinear();function Ns(n){let e;const t=n[16].default,i=Se(t,n,n[20],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&1048576)&&Te(i,t,s,s[20],e?be(t,s[20],r,null):Ae(s[20]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function ks(n){let e,t,i;function s(o){n[17](o)}let r={object:n[0],lookAt:n[5],castShadow:n[7],receiveShadow:n[8],frustumCulled:n[9],renderOrder:n[10],position:n[2],scale:n[3],rotation:n[4],viewportAware:n[6],visible:n[11],$$slots:{default:[Ns]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.inViewport=n[1]),e=new Xt({props:r}),ue.push(()=>ve(e,"inViewport",s)),e.$on("viewportenter",n[18]),e.$on("viewportleave",n[19]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,[l]){const a={};l&1&&(a.object=o[0]),l&32&&(a.lookAt=o[5]),l&128&&(a.castShadow=o[7]),l&256&&(a.receiveShadow=o[8]),l&512&&(a.frustumCulled=o[9]),l&1024&&(a.renderOrder=o[10]),l&4&&(a.position=o[2]),l&8&&(a.scale=o[3]),l&16&&(a.rotation=o[4]),l&64&&(a.viewportAware=o[6]),l&2048&&(a.visible=o[11]),l&1048576&&(a.$$scope={dirty:l,ctx:o}),!t&&l&2&&(t=!0,a.inViewport=o[1],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function Gs(n,e,t){let i,{$$slots:s={},$$scope:r}=e,{light:o}=e,{position:l=void 0}=e,{scale:a=void 0}=e,{rotation:c=void 0}=e,{lookAt:_=void 0}=e,{viewportAware:m=!1}=e,{inViewport:u=!1}=e,{castShadow:h=void 0}=e,{receiveShadow:A=void 0}=e,{frustumCulled:f=void 0}=e,{renderOrder:d=void 0}=e,{visible:g=void 0}=e,{color:p=void 0}=e,{intensity:w=void 0}=e;const{invalidate:b}=Le(),{linear:R}=zt();q(n,R,y=>t(15,i=y));function T(y){u=y,t(1,u)}function C(y){V.call(this,n,y)}function S(y){V.call(this,n,y)}return n.$$set=y=>{"light"in y&&t(0,o=y.light),"position"in y&&t(2,l=y.position),"scale"in y&&t(3,a=y.scale),"rotation"in y&&t(4,c=y.rotation),"lookAt"in y&&t(5,_=y.lookAt),"viewportAware"in y&&t(6,m=y.viewportAware),"inViewport"in y&&t(1,u=y.inViewport),"castShadow"in y&&t(7,h=y.castShadow),"receiveShadow"in y&&t(8,A=y.receiveShadow),"frustumCulled"in y&&t(9,f=y.frustumCulled),"renderOrder"in y&&t(10,d=y.renderOrder),"visible"in y&&t(11,g=y.visible),"color"in y&&t(13,p=y.color),"intensity"in y&&t(14,w=y.intensity),"$$scope"in y&&t(20,r=y.$$scope)},n.$$.update=()=>{n.$$.dirty&57344&&(w!==void 0&&t(0,o.intensity=w,o),p!==void 0&&t(0,o.color=Vs(p,i),o),b("LightInstance: props changed"))},[o,u,l,a,c,_,m,h,A,f,d,g,R,p,w,i,s,T,C,S,r]}class Jn extends ie{constructor(e){super(),se(this,e,Gs,ks,ee,{light:0,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:1,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11,color:13,intensity:14})}}function js(n){let e;const t=n[14].default,i=Se(t,n,n[18],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&262144)&&Te(i,t,s,s[18],e?be(t,s[18],r,null):Ae(s[18]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function Hs(n){let e,t,i;function s(o){n[15](o)}let r={light:n[13],lookAt:n[4],position:n[1],scale:n[2],rotation:n[3],castShadow:n[5],receiveShadow:n[6],frustumCulled:n[7],renderOrder:n[8],visible:n[9],viewportAware:n[10],color:n[11],intensity:n[12],$$slots:{default:[js]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.inViewport=n[0]),e=new Jn({props:r}),ue.push(()=>ve(e,"inViewport",s)),e.$on("viewportenter",n[16]),e.$on("viewportleave",n[17]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,[l]){const a={};l&16&&(a.lookAt=o[4]),l&2&&(a.position=o[1]),l&4&&(a.scale=o[2]),l&8&&(a.rotation=o[3]),l&32&&(a.castShadow=o[5]),l&64&&(a.receiveShadow=o[6]),l&128&&(a.frustumCulled=o[7]),l&256&&(a.renderOrder=o[8]),l&512&&(a.visible=o[9]),l&1024&&(a.viewportAware=o[10]),l&2048&&(a.color=o[11]),l&4096&&(a.intensity=o[12]),l&262144&&(a.$$scope={dirty:l,ctx:o}),!t&&l&1&&(t=!0,a.inViewport=o[0],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function zs(n,e,t){let{$$slots:i={},$$scope:s}=e,{position:r=void 0}=e,{scale:o=void 0}=e,{rotation:l=void 0}=e,{lookAt:a=void 0}=e,{castShadow:c=void 0}=e,{receiveShadow:_=void 0}=e,{frustumCulled:m=void 0}=e,{renderOrder:u=void 0}=e,{visible:h=void 0}=e,{viewportAware:A=!1}=e,{inViewport:f=!1}=e,{color:d=void 0}=e,{intensity:g=void 0}=e;const p=new Ei(d,g);function w(T){f=T,t(0,f)}function b(T){V.call(this,n,T)}function R(T){V.call(this,n,T)}return n.$$set=T=>{"position"in T&&t(1,r=T.position),"scale"in T&&t(2,o=T.scale),"rotation"in T&&t(3,l=T.rotation),"lookAt"in T&&t(4,a=T.lookAt),"castShadow"in T&&t(5,c=T.castShadow),"receiveShadow"in T&&t(6,_=T.receiveShadow),"frustumCulled"in T&&t(7,m=T.frustumCulled),"renderOrder"in T&&t(8,u=T.renderOrder),"visible"in T&&t(9,h=T.visible),"viewportAware"in T&&t(10,A=T.viewportAware),"inViewport"in T&&t(0,f=T.inViewport),"color"in T&&t(11,d=T.color),"intensity"in T&&t(12,g=T.intensity),"$$scope"in T&&t(18,s=T.$$scope)},[f,r,o,l,a,c,_,m,u,h,A,d,g,p,i,w,b,R,s]}class Xs extends ie{constructor(e){super(),se(this,e,zs,Hs,ee,{position:1,scale:2,rotation:3,lookAt:4,castShadow:5,receiveShadow:6,frustumCulled:7,renderOrder:8,visible:9,viewportAware:10,inViewport:0,color:11,intensity:12,light:13})}get light(){return this.$$.ctx[13]}}function vn(n){let e,t,i,s;return e=new Zn({props:{object:n[14]}}),i=new un({props:{object:n[14],position:n[13]}}),{c(){N(e.$$.fragment),t=oe(),N(i.$$.fragment)},l(r){k(e.$$.fragment,r),t=ae(r),k(i.$$.fragment,r)},m(r,o){G(e,r,o),X(r,t,o),G(i,r,o),s=!0},p(r,o){const l={};o&8192&&(l.position=r[13]),i.$set(l)},i(r){s||(B(e.$$.fragment,r),B(i.$$.fragment,r),s=!0)},o(r){I(e.$$.fragment,r),I(i.$$.fragment,r),s=!1},d(r){j(e,r),r&&D(t),j(i,r)}}}function Ws(n){let e;const t=n[16].default,i=Se(t,n,n[20],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&1048576)&&Te(i,t,s,s[20],e?be(t,s[20],r,null):Ae(s[20]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function Ys(n){let e,t,i,s,r=n[13]&&!(n[13]instanceof Ne)&&vn(n);function o(a){n[17](a)}let l={light:n[1],position:n[2],scale:n[3],rotation:n[4],castShadow:!!n[12],receiveShadow:n[5],frustumCulled:n[6],renderOrder:n[7],visible:n[8],viewportAware:n[9],color:n[10],intensity:n[11],$$slots:{default:[Ws]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.inViewport=n[0]),t=new Jn({props:l}),ue.push(()=>ve(t,"inViewport",o)),t.$on("viewportenter",n[18]),t.$on("viewportleave",n[19]),{c(){r&&r.c(),e=oe(),N(t.$$.fragment)},l(a){r&&r.l(a),e=ae(a),k(t.$$.fragment,a)},m(a,c){r&&r.m(a,c),X(a,e,c),G(t,a,c),s=!0},p(a,[c]){a[13]&&!(a[13]instanceof Ne)?r?(r.p(a,c),c&8192&&B(r,1)):(r=vn(a),r.c(),B(r,1),r.m(e.parentNode,e)):r&&(Vt(),I(r,1,1,()=>{r=null}),Nt());const _={};c&2&&(_.light=a[1]),c&4&&(_.position=a[2]),c&8&&(_.scale=a[3]),c&16&&(_.rotation=a[4]),c&4096&&(_.castShadow=!!a[12]),c&32&&(_.receiveShadow=a[5]),c&64&&(_.frustumCulled=a[6]),c&128&&(_.renderOrder=a[7]),c&256&&(_.visible=a[8]),c&512&&(_.viewportAware=a[9]),c&1024&&(_.color=a[10]),c&2048&&(_.intensity=a[11]),c&1048576&&(_.$$scope={dirty:c,ctx:a}),!i&&c&1&&(i=!0,_.inViewport=a[0],Oe(()=>i=!1)),t.$set(_)},i(a){s||(B(r),B(t.$$.fragment,a),s=!0)},o(a){I(r),I(t.$$.fragment,a),s=!1},d(a){r&&r.d(a),a&&D(e),j(t,a)}}}function Qs(n,e,t){let i,{$$slots:s={},$$scope:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{receiveShadow:c=void 0}=e,{frustumCulled:_=void 0}=e,{renderOrder:m=void 0}=e,{visible:u=void 0}=e,{viewportAware:h=!1}=e,{inViewport:A=!1}=e,{color:f=void 0}=e,{intensity:d=void 0}=e,{shadow:g=void 0}=e,{target:p=void 0}=e;const w=new Ci(f,d),{invalidate:b}=Le(),R=w.target,{start:T,stop:C,started:S}=Rt(()=>{},{autostart:!1,debugFrameloopMessage:"DirectionalLight: tracking target"});q(n,S,L=>t(21,i=L));const y=L=>{L&&L instanceof Ne&&!i?(t(1,w.target=L,w),T(),b("DirectionalLight: target changed")):(!L||!(L instanceof Ne))&&i&&(t(1,w.target=R,w),C(),b("DirectionalLight: target changed"))},x=L=>{if(L){const{mapSize:W=[512,512],camera:{left:$=-5,bottom:z=-5,right:Y=5,top:F=5,near:O=.5,far:te=500}={},bias:H=0,radius:ne=1}=L===!0?{}:L;w.shadow.mapSize.set(W[0],W[1]),t(1,w.shadow.camera.left=$,w),t(1,w.shadow.camera.top=F,w),t(1,w.shadow.camera.right=Y,w),t(1,w.shadow.camera.bottom=z,w),t(1,w.shadow.camera.near=O,w),t(1,w.shadow.camera.far=te,w),t(1,w.shadow.bias=H,w),t(1,w.shadow.radius=ne,w)}b("DirectionalLight: shadow changed")};function v(L){A=L,t(0,A)}function U(L){V.call(this,n,L)}function E(L){V.call(this,n,L)}return n.$$set=L=>{"position"in L&&t(2,o=L.position),"scale"in L&&t(3,l=L.scale),"rotation"in L&&t(4,a=L.rotation),"receiveShadow"in L&&t(5,c=L.receiveShadow),"frustumCulled"in L&&t(6,_=L.frustumCulled),"renderOrder"in L&&t(7,m=L.renderOrder),"visible"in L&&t(8,u=L.visible),"viewportAware"in L&&t(9,h=L.viewportAware),"inViewport"in L&&t(0,A=L.inViewport),"color"in L&&t(10,f=L.color),"intensity"in L&&t(11,d=L.intensity),"shadow"in L&&t(12,g=L.shadow),"target"in L&&t(13,p=L.target),"$$scope"in L&&t(20,r=L.$$scope)},n.$$.update=()=>{n.$$.dirty&8192&&y(p),n.$$.dirty&4096&&x(g)},[A,w,o,l,a,c,_,m,u,h,f,d,g,p,R,S,s,v,U,E,r]}class Zs extends ie{constructor(e){super(),se(this,e,Qs,Ys,ee,{position:2,scale:3,rotation:4,receiveShadow:5,frustumCulled:6,renderOrder:7,visible:8,viewportAware:9,inViewport:0,color:10,intensity:11,shadow:12,target:13,light:1})}get light(){return this.$$.ctx[1]}}function qs(n,e,t){let{object:i}=e,s=i,{interactive:r=!1}=e,{ignorePointer:o=!1}=e;const l=wt(),{addInteractiveObject:a,removeInteractiveObject:c,addRaycastableObject:_,removeRaycastableObject:m}=zt(),{invalidate:u}=Le(),h=f=>{m(f),c(f),delete Fe(f).eventDispatcher},A=(f,d,g)=>{Fe(f).eventDispatcher=l,d?(m(f),c(f)):(_(f),g?a(f):c(f))};return he(()=>{h(i),u("InteractiveObject: object removed")}),n.$$set=f=>{"object"in f&&t(0,i=f.object),"interactive"in f&&t(1,r=f.interactive),"ignorePointer"in f&&t(2,o=f.ignorePointer)},n.$$.update=()=>{n.$$.dirty&15&&(i!==s?(h(s),A(i,o,r),u("InteractiveObject: object changed"),t(3,s=i)):i===s&&(A(i,o,r),u("InteractiveObject: props changed")))},[i,r,o,s]}class Js extends ie{constructor(e){super(),se(this,e,qs,null,ee,{object:0,interactive:1,ignorePointer:2})}}function $s(n){let e;const t=n[14].default,i=Se(t,n,n[25],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&33554432)&&Te(i,t,s,s[25],e?be(t,s[25],r,null):Ae(s[25]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function er(n){let e,t,i,s,r;function o(a){n[15](a)}let l={object:n[1],lookAt:n[5],position:n[2],scale:n[3],rotation:n[4],castShadow:n[7],receiveShadow:n[8],frustumCulled:n[9],renderOrder:n[10],visible:n[11],viewportAware:n[6],$$slots:{default:[$s]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.inViewport=n[0]),e=new Xt({props:l}),ue.push(()=>ve(e,"inViewport",o)),e.$on("viewportenter",n[16]),e.$on("viewportleave",n[17]),s=new Js({props:{object:n[1],interactive:n[12],ignorePointer:n[13]}}),s.$on("click",n[18]),s.$on("contextmenu",n[19]),s.$on("pointerup",n[20]),s.$on("pointerdown",n[21]),s.$on("pointerenter",n[22]),s.$on("pointerleave",n[23]),s.$on("pointermove",n[24]),{c(){N(e.$$.fragment),i=oe(),N(s.$$.fragment)},l(a){k(e.$$.fragment,a),i=ae(a),k(s.$$.fragment,a)},m(a,c){G(e,a,c),X(a,i,c),G(s,a,c),r=!0},p(a,[c]){const _={};c&2&&(_.object=a[1]),c&32&&(_.lookAt=a[5]),c&4&&(_.position=a[2]),c&8&&(_.scale=a[3]),c&16&&(_.rotation=a[4]),c&128&&(_.castShadow=a[7]),c&256&&(_.receiveShadow=a[8]),c&512&&(_.frustumCulled=a[9]),c&1024&&(_.renderOrder=a[10]),c&2048&&(_.visible=a[11]),c&64&&(_.viewportAware=a[6]),c&33554432&&(_.$$scope={dirty:c,ctx:a}),!t&&c&1&&(t=!0,_.inViewport=a[0],Oe(()=>t=!1)),e.$set(_);const m={};c&2&&(m.object=a[1]),c&4096&&(m.interactive=a[12]),c&8192&&(m.ignorePointer=a[13]),s.$set(m)},i(a){r||(B(e.$$.fragment,a),B(s.$$.fragment,a),r=!0)},o(a){I(e.$$.fragment,a),I(s.$$.fragment,a),r=!1},d(a){j(e,a),a&&D(i),j(s,a)}}}function tr(n,e,t){let{$$slots:i={},$$scope:s}=e,{mesh:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e,{viewportAware:_=!1}=e,{inViewport:m=!1}=e,{castShadow:u=void 0}=e,{receiveShadow:h=void 0}=e,{frustumCulled:A=void 0}=e,{renderOrder:f=void 0}=e,{visible:d=void 0}=e,{interactive:g=!1}=e,{ignorePointer:p=!1}=e;function w(E){m=E,t(0,m)}function b(E){V.call(this,n,E)}function R(E){V.call(this,n,E)}function T(E){V.call(this,n,E)}function C(E){V.call(this,n,E)}function S(E){V.call(this,n,E)}function y(E){V.call(this,n,E)}function x(E){V.call(this,n,E)}function v(E){V.call(this,n,E)}function U(E){V.call(this,n,E)}return n.$$set=E=>{"mesh"in E&&t(1,r=E.mesh),"position"in E&&t(2,o=E.position),"scale"in E&&t(3,l=E.scale),"rotation"in E&&t(4,a=E.rotation),"lookAt"in E&&t(5,c=E.lookAt),"viewportAware"in E&&t(6,_=E.viewportAware),"inViewport"in E&&t(0,m=E.inViewport),"castShadow"in E&&t(7,u=E.castShadow),"receiveShadow"in E&&t(8,h=E.receiveShadow),"frustumCulled"in E&&t(9,A=E.frustumCulled),"renderOrder"in E&&t(10,f=E.renderOrder),"visible"in E&&t(11,d=E.visible),"interactive"in E&&t(12,g=E.interactive),"ignorePointer"in E&&t(13,p=E.ignorePointer),"$$scope"in E&&t(25,s=E.$$scope)},[m,r,o,l,a,c,_,u,h,A,f,d,g,p,i,w,b,R,T,C,S,y,x,v,U,s]}class nr extends ie{constructor(e){super(),se(this,e,tr,er,ee,{mesh:1,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:0,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11,interactive:12,ignorePointer:13})}}function ir(n){let e;const t=n[18].default,i=Se(t,n,n[29],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[0]&536870912)&&Te(i,t,s,s[29],e?be(t,s[29],r,null):Ae(s[29]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function sr(n){let e,t,i;function s(o){n[19](o)}let r={mesh:n[13],position:n[1],scale:n[2],rotation:n[3],lookAt:n[12],castShadow:n[5],receiveShadow:n[6],frustumCulled:n[7],renderOrder:n[8],visible:n[9],interactive:n[10],ignorePointer:n[11],viewportAware:n[4],$$slots:{default:[ir]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.inViewport=n[0]),e=new nr({props:r}),ue.push(()=>ve(e,"inViewport",s)),e.$on("click",n[20]),e.$on("contextmenu",n[21]),e.$on("pointerup",n[22]),e.$on("pointerdown",n[23]),e.$on("pointerenter",n[24]),e.$on("pointerleave",n[25]),e.$on("pointermove",n[26]),e.$on("viewportenter",n[27]),e.$on("viewportleave",n[28]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,l){const a={};l[0]&2&&(a.position=o[1]),l[0]&4&&(a.scale=o[2]),l[0]&8&&(a.rotation=o[3]),l[0]&4096&&(a.lookAt=o[12]),l[0]&32&&(a.castShadow=o[5]),l[0]&64&&(a.receiveShadow=o[6]),l[0]&128&&(a.frustumCulled=o[7]),l[0]&256&&(a.renderOrder=o[8]),l[0]&512&&(a.visible=o[9]),l[0]&1024&&(a.interactive=o[10]),l[0]&2048&&(a.ignorePointer=o[11]),l[0]&16&&(a.viewportAware=o[4]),l[0]&536870912&&(a.$$scope={dirty:l,ctx:o}),!t&&l[0]&1&&(t=!0,a.inViewport=o[0],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function rr(n,e,t){let{$$slots:i={},$$scope:s}=e,{position:r=void 0}=e,{scale:o=void 0}=e,{rotation:l=void 0}=e,{viewportAware:a=!1}=e,{inViewport:c=!1}=e,{castShadow:_=void 0}=e,{receiveShadow:m=void 0}=e,{frustumCulled:u=void 0}=e,{renderOrder:h=void 0}=e,{visible:A=void 0}=e,{interactive:f=!1}=e,{ignorePointer:d=!1}=e,{lookAt:g=void 0}=e,{geometry:p}=e,{material:w}=e,b=w,R=p;const{invalidate:T}=Le(),C=new kn(p,w),S=()=>C;function y(F){c=F,t(0,c)}function x(F){V.call(this,n,F)}function v(F){V.call(this,n,F)}function U(F){V.call(this,n,F)}function E(F){V.call(this,n,F)}function L(F){V.call(this,n,F)}function W(F){V.call(this,n,F)}function $(F){V.call(this,n,F)}function z(F){V.call(this,n,F)}function Y(F){V.call(this,n,F)}return n.$$set=F=>{"position"in F&&t(1,r=F.position),"scale"in F&&t(2,o=F.scale),"rotation"in F&&t(3,l=F.rotation),"viewportAware"in F&&t(4,a=F.viewportAware),"inViewport"in F&&t(0,c=F.inViewport),"castShadow"in F&&t(5,_=F.castShadow),"receiveShadow"in F&&t(6,m=F.receiveShadow),"frustumCulled"in F&&t(7,u=F.frustumCulled),"renderOrder"in F&&t(8,h=F.renderOrder),"visible"in F&&t(9,A=F.visible),"interactive"in F&&t(10,f=F.interactive),"ignorePointer"in F&&t(11,d=F.ignorePointer),"lookAt"in F&&t(12,g=F.lookAt),"geometry"in F&&t(14,p=F.geometry),"material"in F&&t(15,w=F.material),"$$scope"in F&&t(29,s=F.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&98304&&(w!==b?(S().material=w,T("Mesh: material changed")):T("Mesh: material props changed"),t(16,b=w)),n.$$.dirty[0]&147456&&(p!==R?(S().geometry=p,T("Mesh: geometry changed")):T("Mesh: geometry props changed"),t(17,R=p))},[c,r,o,l,a,_,m,u,h,A,f,d,g,C,p,w,b,R,i,y,x,v,U,E,L,W,$,z,Y,s]}class pt extends ie{constructor(e){super(),se(this,e,rr,sr,ee,{position:1,scale:2,rotation:3,viewportAware:4,inViewport:0,castShadow:5,receiveShadow:6,frustumCulled:7,renderOrder:8,visible:9,interactive:10,ignorePointer:11,lookAt:12,geometry:14,material:15,mesh:13},null,[-1,-1])}get mesh(){return this.$$.ctx[13]}}const $n=new Ne;$n.scale.set(0,0,0);$n.matrix;new bt().fromArray(new Array(16).fill(0));new Ke(16777215);function or(n){let e;const t=n[12].default,i=Se(t,n,n[16],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&65536)&&Te(i,t,s,s[16],e?be(t,s[16],r,null):Ae(s[16]),null)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function ar(n){let e,t,i;function s(o){n[13](o)}let r={object:n[11],position:n[1],scale:n[2],rotation:n[3],lookAt:n[4],frustumCulled:n[8],renderOrder:n[9],visible:n[10],castShadow:n[6],receiveShadow:n[7],viewportAware:n[5],$$slots:{default:[or]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.inViewport=n[0]),e=new Xt({props:r}),ue.push(()=>ve(e,"inViewport",s)),e.$on("viewportenter",n[14]),e.$on("viewportleave",n[15]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,[l]){const a={};l&2&&(a.position=o[1]),l&4&&(a.scale=o[2]),l&8&&(a.rotation=o[3]),l&16&&(a.lookAt=o[4]),l&256&&(a.frustumCulled=o[8]),l&512&&(a.renderOrder=o[9]),l&1024&&(a.visible=o[10]),l&64&&(a.castShadow=o[6]),l&128&&(a.receiveShadow=o[7]),l&32&&(a.viewportAware=o[5]),l&65536&&(a.$$scope={dirty:l,ctx:o}),!t&&l&1&&(t=!0,a.inViewport=o[0],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function lr(n,e,t){let{$$slots:i={},$$scope:s}=e,{position:r=void 0}=e,{scale:o=void 0}=e,{rotation:l=void 0}=e,{lookAt:a=void 0}=e,{viewportAware:c=!1}=e,{inViewport:_=!1}=e,{castShadow:m=void 0}=e,{receiveShadow:u=void 0}=e,{frustumCulled:h=void 0}=e,{renderOrder:A=void 0}=e,{visible:f=void 0}=e;const d=new Fi;function g(b){_=b,t(0,_)}function p(b){V.call(this,n,b)}function w(b){V.call(this,n,b)}return n.$$set=b=>{"position"in b&&t(1,r=b.position),"scale"in b&&t(2,o=b.scale),"rotation"in b&&t(3,l=b.rotation),"lookAt"in b&&t(4,a=b.lookAt),"viewportAware"in b&&t(5,c=b.viewportAware),"inViewport"in b&&t(0,_=b.inViewport),"castShadow"in b&&t(6,m=b.castShadow),"receiveShadow"in b&&t(7,u=b.receiveShadow),"frustumCulled"in b&&t(8,h=b.frustumCulled),"renderOrder"in b&&t(9,A=b.renderOrder),"visible"in b&&t(10,f=b.visible),"$$scope"in b&&t(16,s=b.$$scope)},[_,r,o,l,a,c,m,u,h,A,f,d,i,g,p,w,s]}class Dt extends ie{constructor(e){super(),se(this,e,lr,ar,ee,{position:1,scale:2,rotation:3,lookAt:4,viewportAware:5,inViewport:0,castShadow:6,receiveShadow:7,frustumCulled:8,renderOrder:9,visible:10,group:11})}get group(){return this.$$.ctx[11]}}const qf=new Gt;class cr{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const i=this.workersResolve[e];if(i&&i(t),this.queue.length){const{resolve:s,msg:r,transfer:o}=this.queue.shift();this.workersResolve[e]=s,this.workers[e].postMessage(r,o)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(i=>{const s=this._getIdleWorker();s!==-1?(this._initWorker(s),this.workerStatus|=1<<s,this.workersResolve[s]=i,this.workers[s].postMessage(e,t)):this.queue.push({resolve:i,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const ur=0,fr=1,dr=2,hr=3,mr=0,_r=0,pr=2,gr=0,wr=1,Tr=160,Ar=161,br=162,Sr=163,Rr=0,Mr=1,yr=0,vr=1,Or=2,Er=3,Cr=4,Fr=5,Lr=6,Pr=7,Br=8,Ir=9,xr=10,Ur=11,Dr=12,Kr=13,Vr=14,Nr=15,kr=16,Gr=17,jr=18,Hr=0,zr=1,Xr=2,Wr=3,Yr=4,Qr=5,Zr=6,qr=7,Jr=8,$r=9,eo=10,to=11,no=0,io=1,so=2,ro=13,oo=14,ao=15,lo=128,co=64,uo=32,fo=16,ho=0,mo=1,_o=2,po=3,go=4,wo=5,To=6,Ao=7,bo=8,So=9,Ro=10,Mo=13,yo=14,vo=15,Oo=16,Eo=17,Co=20,Fo=21,Lo=22,Po=23,Bo=24,Io=27,xo=28,Uo=29,Do=30,Ko=31,Vo=34,No=35,ko=36,Go=37,jo=38,Ho=41,zo=42,Xo=43,Wo=44,Yo=45,Qo=48,Zo=49,qo=50,Jo=58,$o=59,ea=62,ta=63,na=64,ia=65,sa=68,ra=69,oa=70,aa=71,la=74,ca=75,ua=76,fa=77,da=78,ha=81,ma=82,_a=83,pa=84,ga=85,wa=88,Ta=89,Aa=90,ba=91,Sa=92,Ra=95,Ma=96,ya=97,va=98,Oa=99,Ea=100,Ca=101,Fa=102,La=103,Pa=104,Ba=105,Ia=106,xa=107,Ua=108,Da=109,Ka=110,Va=111,Na=112,ka=113,Ga=114,ja=115,Ha=116,za=117,Xa=118,Wa=119,Ya=120,Qa=121,Za=122,qa=123,Ja=124,$a=125,el=126,tl=127,nl=128,il=129,sl=130,rl=131,ol=132,al=133,ll=134,cl=135,ul=136,fl=137,dl=138,hl=139,ml=140,_l=141,pl=142,gl=143,wl=144,Tl=145,Al=146,bl=147,Sl=148,Rl=149,Ml=150,yl=151,vl=152,Ol=153,El=154,Cl=155,Fl=156,Ll=157,Pl=158,Bl=159,Il=160,xl=161,Ul=162,Dl=163,Kl=164,Vl=165,Nl=166,kl=167,Gl=168,jl=169,Hl=170,zl=171,Xl=172,Wl=173,Yl=174,Ql=175,Zl=176,ql=177,Jl=178,$l=179,ec=180,tc=181,nc=182,ic=183,sc=184,rc=1000156007,oc=1000156008,ac=1000156009,lc=1000156010,cc=1000156011,uc=1000156017,fc=1000156018,dc=1000156019,hc=1000156020,mc=1000156021,_c=1000054e3,pc=1000054001,gc=1000054002,wc=1000054003,Tc=1000054004,Ac=1000054005,bc=1000054006,Sc=1000054007,Rc=1000066e3,Mc=1000066001,yc=1000066002,vc=1000066003,Oc=1000066004,Ec=1000066005,Cc=1000066006,Fc=1000066007,Lc=1000066008,Pc=1000066009,Bc=1000066010,Ic=1000066011,xc=1000066012,Uc=1000066013,Dc=100034e4,Kc=1000340001;class ei{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class ut{constructor(e,t,i,s){this._dataView=new DataView(e.buffer,e.byteOffset+t,i),this._littleEndian=s,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const i=this._offset;let s=0;for(;this._dataView.getUint8(this._offset)!==t&&s<e;)s++,this._offset++;return s<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,s)}}const On=new Uint8Array([0]),de=[171,75,84,88,32,50,48,187,13,10,26,10];function En(n){return typeof TextEncoder!="undefined"?new TextEncoder().encode(n):Buffer.from(n)}function Cn(n){return typeof TextDecoder!="undefined"?new TextDecoder().decode(n):Buffer.from(n).toString("utf8")}function Et(n){let e=0;for(const s of n)e+=s.byteLength;const t=new Uint8Array(e);let i=0;for(const s of n)t.set(new Uint8Array(s),i),i+=s.byteLength;return t}function Vc(n){const e=new Uint8Array(n.buffer,n.byteOffset,de.length);if(e[0]!==de[0]||e[1]!==de[1]||e[2]!==de[2]||e[3]!==de[3]||e[4]!==de[4]||e[5]!==de[5]||e[6]!==de[6]||e[7]!==de[7]||e[8]!==de[8]||e[9]!==de[9]||e[10]!==de[10]||e[11]!==de[11])throw new Error("Missing KTX 2.0 identifier.");const t=new ei,i=17*Uint32Array.BYTES_PER_ELEMENT,s=new ut(n,de.length,i,!0);t.vkFormat=s._nextUint32(),t.typeSize=s._nextUint32(),t.pixelWidth=s._nextUint32(),t.pixelHeight=s._nextUint32(),t.pixelDepth=s._nextUint32(),t.layerCount=s._nextUint32(),t.faceCount=s._nextUint32();const r=s._nextUint32();t.supercompressionScheme=s._nextUint32();const o=s._nextUint32(),l=s._nextUint32(),a=s._nextUint32(),c=s._nextUint32(),_=s._nextUint64(),m=s._nextUint64(),u=new ut(n,de.length+i,3*r*8,!0);for(let z=0;z<r;z++)t.levels.push({levelData:new Uint8Array(n.buffer,n.byteOffset+u._nextUint64(),u._nextUint64()),uncompressedByteLength:u._nextUint64()});const h=new ut(n,o,l,!0),A={vendorId:h._skip(4)._nextUint16(),descriptorType:h._nextUint16(),versionNumber:h._nextUint16(),descriptorBlockSize:h._nextUint16(),colorModel:h._nextUint8(),colorPrimaries:h._nextUint8(),transferFunction:h._nextUint8(),flags:h._nextUint8(),texelBlockDimension:[h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8()],bytesPlane:[h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8()],samples:[]},f=(A.descriptorBlockSize/4-6)/4;for(let z=0;z<f;z++){const Y={bitOffset:h._nextUint16(),bitLength:h._nextUint8(),channelType:h._nextUint8(),samplePosition:[h._nextUint8(),h._nextUint8(),h._nextUint8(),h._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&Y.channelType?(Y.sampleLower=h._nextInt32(),Y.sampleUpper=h._nextInt32()):(Y.sampleLower=h._nextUint32(),Y.sampleUpper=h._nextUint32()),A.samples[z]=Y}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(A);const d=new ut(n,a,c,!0);for(;d._offset<c;){const z=d._nextUint32(),Y=d._scan(z),F=Cn(Y),O=d._scan(z-Y.byteLength);t.keyValue[F]=F.match(/^ktx/i)?Cn(O):O,d._offset%4&&d._skip(4-d._offset%4)}if(m<=0)return t;const g=new ut(n,_,m,!0),p=g._nextUint16(),w=g._nextUint16(),b=g._nextUint32(),R=g._nextUint32(),T=g._nextUint32(),C=g._nextUint32(),S=[];for(let z=0;z<r;z++)S.push({imageFlags:g._nextUint32(),rgbSliceByteOffset:g._nextUint32(),rgbSliceByteLength:g._nextUint32(),alphaSliceByteOffset:g._nextUint32(),alphaSliceByteLength:g._nextUint32()});const y=_+g._offset,x=y+b,v=x+R,U=v+T,E=new Uint8Array(n.buffer,n.byteOffset+y,b),L=new Uint8Array(n.buffer,n.byteOffset+x,R),W=new Uint8Array(n.buffer,n.byteOffset+v,T),$=new Uint8Array(n.buffer,n.byteOffset+U,C);return t.globalData={endpointCount:p,selectorCount:w,imageDescs:S,endpointsData:E,selectorsData:L,tablesData:W,extendedData:$},t}function sn(){return(sn=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n}).apply(this,arguments)}const Nc={keepWriter:!1};function kc(n,e={}){e=sn({},Nc,e);let t=new ArrayBuffer(0);if(n.globalData){const p=new ArrayBuffer(20+5*n.globalData.imageDescs.length*4),w=new DataView(p);w.setUint16(0,n.globalData.endpointCount,!0),w.setUint16(2,n.globalData.selectorCount,!0),w.setUint32(4,n.globalData.endpointsData.byteLength,!0),w.setUint32(8,n.globalData.selectorsData.byteLength,!0),w.setUint32(12,n.globalData.tablesData.byteLength,!0),w.setUint32(16,n.globalData.extendedData.byteLength,!0);for(let b=0;b<n.globalData.imageDescs.length;b++){const R=n.globalData.imageDescs[b];w.setUint32(20+5*b*4+0,R.imageFlags,!0),w.setUint32(20+5*b*4+4,R.rgbSliceByteOffset,!0),w.setUint32(20+5*b*4+8,R.rgbSliceByteLength,!0),w.setUint32(20+5*b*4+12,R.alphaSliceByteOffset,!0),w.setUint32(20+5*b*4+16,R.alphaSliceByteLength,!0)}t=Et([p,n.globalData.endpointsData,n.globalData.selectorsData,n.globalData.tablesData,n.globalData.extendedData])}const i=[];let s=n.keyValue;e.keepWriter||(s=sn({},n.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const p in s){const w=s[p],b=En(p),R=typeof w=="string"?En(w):w,T=b.byteLength+1+R.byteLength+1,C=T%4?4-T%4:0;i.push(Et([new Uint32Array([T]),b,On,R,On,new Uint8Array(C).fill(0)]))}const r=Et(i);if(n.dataFormatDescriptor.length!==1||n.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const o=n.dataFormatDescriptor[0],l=new ArrayBuffer(28+16*o.samples.length),a=new DataView(l),c=24+16*o.samples.length;if(a.setUint32(0,l.byteLength,!0),a.setUint16(4,o.vendorId,!0),a.setUint16(6,o.descriptorType,!0),a.setUint16(8,o.versionNumber,!0),a.setUint16(10,c,!0),a.setUint8(12,o.colorModel),a.setUint8(13,o.colorPrimaries),a.setUint8(14,o.transferFunction),a.setUint8(15,o.flags),!Array.isArray(o.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");a.setUint8(16,o.texelBlockDimension[0]),a.setUint8(17,o.texelBlockDimension[1]),a.setUint8(18,o.texelBlockDimension[2]),a.setUint8(19,o.texelBlockDimension[3]);for(let p=0;p<8;p++)a.setUint8(20+p,o.bytesPlane[p]);for(let p=0;p<o.samples.length;p++){const w=o.samples[p],b=28+16*p;if(w.channelID)throw new Error("channelID has been renamed to channelType.");a.setUint16(b+0,w.bitOffset,!0),a.setUint8(b+2,w.bitLength),a.setUint8(b+3,w.channelType),a.setUint8(b+4,w.samplePosition[0]),a.setUint8(b+5,w.samplePosition[1]),a.setUint8(b+6,w.samplePosition[2]),a.setUint8(b+7,w.samplePosition[3]),64&w.channelType?(a.setInt32(b+8,w.sampleLower,!0),a.setInt32(b+12,w.sampleUpper,!0)):(a.setUint32(b+8,w.sampleLower,!0),a.setUint32(b+12,w.sampleUpper,!0))}const _=de.length+68+3*n.levels.length*8,m=_+l.byteLength;let u=t.byteLength>0?m+r.byteLength:0;u%8&&(u+=8-u%8);const h=[],A=new DataView(new ArrayBuffer(3*n.levels.length*8));let f=(u||m+r.byteLength)+t.byteLength;for(let p=0;p<n.levels.length;p++){const w=n.levels[p];h.push(w.levelData),A.setBigUint64(24*p+0,BigInt(f),!0),A.setBigUint64(24*p+8,BigInt(w.levelData.byteLength),!0),A.setBigUint64(24*p+16,BigInt(w.uncompressedByteLength),!0),f+=w.levelData.byteLength}const d=new ArrayBuffer(68),g=new DataView(d);return g.setUint32(0,n.vkFormat,!0),g.setUint32(4,n.typeSize,!0),g.setUint32(8,n.pixelWidth,!0),g.setUint32(12,n.pixelHeight,!0),g.setUint32(16,n.pixelDepth,!0),g.setUint32(20,n.layerCount,!0),g.setUint32(24,n.faceCount,!0),g.setUint32(28,n.levels.length,!0),g.setUint32(32,n.supercompressionScheme,!0),g.setUint32(36,_,!0),g.setUint32(40,l.byteLength,!0),g.setUint32(44,m,!0),g.setUint32(48,r.byteLength,!0),g.setBigUint64(52,BigInt(t.byteLength>0?u:0),!0),g.setBigUint64(60,BigInt(t.byteLength),!0),new Uint8Array(Et([new Uint8Array(de).buffer,d,A.buffer,l,r,u>0?new ArrayBuffer(u-(m+r.byteLength)):new ArrayBuffer(0),t,...h]))}var Gc=Object.freeze(Object.defineProperty({__proto__:null,KHR_DF_CHANNEL_RGBSDA_ALPHA:ao,KHR_DF_CHANNEL_RGBSDA_BLUE:so,KHR_DF_CHANNEL_RGBSDA_DEPTH:oo,KHR_DF_CHANNEL_RGBSDA_GREEN:io,KHR_DF_CHANNEL_RGBSDA_RED:no,KHR_DF_CHANNEL_RGBSDA_STENCIL:ro,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:Mr,KHR_DF_FLAG_ALPHA_STRAIGHT:Rr,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:mr,KHR_DF_MODEL_ASTC:br,KHR_DF_MODEL_ETC1:Tr,KHR_DF_MODEL_ETC1S:Sr,KHR_DF_MODEL_ETC2:Ar,KHR_DF_MODEL_RGBSDA:wr,KHR_DF_MODEL_UNSPECIFIED:gr,KHR_DF_PRIMARIES_ACES:Zr,KHR_DF_PRIMARIES_ACESCC:qr,KHR_DF_PRIMARIES_ADOBERGB:to,KHR_DF_PRIMARIES_BT2020:Yr,KHR_DF_PRIMARIES_BT601_EBU:Xr,KHR_DF_PRIMARIES_BT601_SMPTE:Wr,KHR_DF_PRIMARIES_BT709:zr,KHR_DF_PRIMARIES_CIEXYZ:Qr,KHR_DF_PRIMARIES_DISPLAYP3:eo,KHR_DF_PRIMARIES_NTSC1953:Jr,KHR_DF_PRIMARIES_PAL525:$r,KHR_DF_PRIMARIES_UNSPECIFIED:Hr,KHR_DF_SAMPLE_DATATYPE_EXPONENT:uo,KHR_DF_SAMPLE_DATATYPE_FLOAT:lo,KHR_DF_SAMPLE_DATATYPE_LINEAR:fo,KHR_DF_SAMPLE_DATATYPE_SIGNED:co,KHR_DF_TRANSFER_ACESCC:kr,KHR_DF_TRANSFER_ACESCCT:Gr,KHR_DF_TRANSFER_ADOBERGB:jr,KHR_DF_TRANSFER_BT1886:Pr,KHR_DF_TRANSFER_DCIP3:Dr,KHR_DF_TRANSFER_HLG_EOTF:Ir,KHR_DF_TRANSFER_HLG_OETF:Br,KHR_DF_TRANSFER_ITU:Er,KHR_DF_TRANSFER_LINEAR:vr,KHR_DF_TRANSFER_NTSC:Cr,KHR_DF_TRANSFER_PAL625_EOTF:Vr,KHR_DF_TRANSFER_PAL_OETF:Kr,KHR_DF_TRANSFER_PQ_EOTF:xr,KHR_DF_TRANSFER_PQ_OETF:Ur,KHR_DF_TRANSFER_SLOG:Fr,KHR_DF_TRANSFER_SLOG2:Lr,KHR_DF_TRANSFER_SRGB:Or,KHR_DF_TRANSFER_ST240:Nr,KHR_DF_TRANSFER_UNSPECIFIED:yr,KHR_DF_VENDORID_KHRONOS:_r,KHR_DF_VERSION:pr,KHR_SUPERCOMPRESSION_BASISLZ:fr,KHR_SUPERCOMPRESSION_NONE:ur,KHR_SUPERCOMPRESSION_ZLIB:hr,KHR_SUPERCOMPRESSION_ZSTD:dr,KTX2Container:ei,VK_FORMAT_A1R5G5B5_UNORM_PACK16:bo,VK_FORMAT_A2B10G10R10_SINT_PACK32:ra,VK_FORMAT_A2B10G10R10_SNORM_PACK32:ia,VK_FORMAT_A2B10G10R10_UINT_PACK32:sa,VK_FORMAT_A2B10G10R10_UNORM_PACK32:na,VK_FORMAT_A2R10G10B10_SINT_PACK32:ta,VK_FORMAT_A2R10G10B10_SNORM_PACK32:$o,VK_FORMAT_A2R10G10B10_UINT_PACK32:ea,VK_FORMAT_A2R10G10B10_UNORM_PACK32:Jo,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:Kc,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:Dc,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:Ic,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:ec,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:$l,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:Lc,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:Yl,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:Wl,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:Pc,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:Zl,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:Ql,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:Bc,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:Jl,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:ql,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:xc,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:nc,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:tc,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:Uc,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:sc,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:ic,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:Rc,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:Pl,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:Ll,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:Mc,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:Il,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:Bl,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:yc,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:Ul,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:xl,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:vc,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:Kl,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:Dl,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:Oc,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:Nl,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:Vl,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:Ec,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:Gl,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:kl,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:Cc,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:Hl,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:jl,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:Fc,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:Xl,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:zl,VK_FORMAT_B10G11R11_UFLOAT_PACK32:Za,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:cc,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:mc,VK_FORMAT_B4G4R4A4_UNORM_PACK16:po,VK_FORMAT_B5G5R5A1_UNORM_PACK16:Ao,VK_FORMAT_B5G6R5_UNORM_PACK16:wo,VK_FORMAT_B8G8R8A8_SINT:Zo,VK_FORMAT_B8G8R8A8_SNORM:Yo,VK_FORMAT_B8G8R8A8_SRGB:qo,VK_FORMAT_B8G8R8A8_UINT:Qo,VK_FORMAT_B8G8R8A8_UNORM:Wo,VK_FORMAT_B8G8R8_SINT:No,VK_FORMAT_B8G8R8_SNORM:Ko,VK_FORMAT_B8G8R8_SRGB:ko,VK_FORMAT_B8G8R8_UINT:Vo,VK_FORMAT_B8G8R8_UNORM:Do,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:ll,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:al,VK_FORMAT_BC1_RGB_SRGB_BLOCK:ol,VK_FORMAT_BC1_RGB_UNORM_BLOCK:rl,VK_FORMAT_BC2_SRGB_BLOCK:ul,VK_FORMAT_BC2_UNORM_BLOCK:cl,VK_FORMAT_BC3_SRGB_BLOCK:dl,VK_FORMAT_BC3_UNORM_BLOCK:fl,VK_FORMAT_BC4_SNORM_BLOCK:ml,VK_FORMAT_BC4_UNORM_BLOCK:hl,VK_FORMAT_BC5_SNORM_BLOCK:pl,VK_FORMAT_BC5_UNORM_BLOCK:_l,VK_FORMAT_BC6H_SFLOAT_BLOCK:wl,VK_FORMAT_BC6H_UFLOAT_BLOCK:gl,VK_FORMAT_BC7_SRGB_BLOCK:Al,VK_FORMAT_BC7_UNORM_BLOCK:Tl,VK_FORMAT_D16_UNORM:Ja,VK_FORMAT_D16_UNORM_S8_UINT:nl,VK_FORMAT_D24_UNORM_S8_UINT:il,VK_FORMAT_D32_SFLOAT:el,VK_FORMAT_D32_SFLOAT_S8_UINT:sl,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:qa,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:Fl,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:Cl,VK_FORMAT_EAC_R11_SNORM_BLOCK:El,VK_FORMAT_EAC_R11_UNORM_BLOCK:Ol,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:Ml,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:Rl,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:vl,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:yl,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:Sl,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:bl,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:lc,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:hc,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:Tc,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:_c,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:Ac,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:pc,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:bc,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:gc,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:Sc,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:wc,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:ac,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:oc,VK_FORMAT_R10X6_UNORM_PACK16:rc,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:dc,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:fc,VK_FORMAT_R12X4_UNORM_PACK16:uc,VK_FORMAT_R16G16B16A16_SFLOAT:ya,VK_FORMAT_R16G16B16A16_SINT:Ma,VK_FORMAT_R16G16B16A16_SNORM:Sa,VK_FORMAT_R16G16B16A16_UINT:Ra,VK_FORMAT_R16G16B16A16_UNORM:ba,VK_FORMAT_R16G16B16_SFLOAT:Aa,VK_FORMAT_R16G16B16_SINT:Ta,VK_FORMAT_R16G16B16_SNORM:ga,VK_FORMAT_R16G16B16_UINT:wa,VK_FORMAT_R16G16B16_UNORM:pa,VK_FORMAT_R16G16_SFLOAT:_a,VK_FORMAT_R16G16_SINT:ma,VK_FORMAT_R16G16_SNORM:da,VK_FORMAT_R16G16_UINT:ha,VK_FORMAT_R16G16_UNORM:fa,VK_FORMAT_R16_SFLOAT:ua,VK_FORMAT_R16_SINT:ca,VK_FORMAT_R16_SNORM:aa,VK_FORMAT_R16_UINT:la,VK_FORMAT_R16_UNORM:oa,VK_FORMAT_R32G32B32A32_SFLOAT:Da,VK_FORMAT_R32G32B32A32_SINT:Ua,VK_FORMAT_R32G32B32A32_UINT:xa,VK_FORMAT_R32G32B32_SFLOAT:Ia,VK_FORMAT_R32G32B32_SINT:Ba,VK_FORMAT_R32G32B32_UINT:Pa,VK_FORMAT_R32G32_SFLOAT:La,VK_FORMAT_R32G32_SINT:Fa,VK_FORMAT_R32G32_UINT:Ca,VK_FORMAT_R32_SFLOAT:Ea,VK_FORMAT_R32_SINT:Oa,VK_FORMAT_R32_UINT:va,VK_FORMAT_R4G4B4A4_UNORM_PACK16:_o,VK_FORMAT_R4G4_UNORM_PACK8:mo,VK_FORMAT_R5G5B5A1_UNORM_PACK16:To,VK_FORMAT_R5G6B5_UNORM_PACK16:go,VK_FORMAT_R64G64B64A64_SFLOAT:Qa,VK_FORMAT_R64G64B64A64_SINT:Ya,VK_FORMAT_R64G64B64A64_UINT:Wa,VK_FORMAT_R64G64B64_SFLOAT:Xa,VK_FORMAT_R64G64B64_SINT:za,VK_FORMAT_R64G64B64_UINT:Ha,VK_FORMAT_R64G64_SFLOAT:ja,VK_FORMAT_R64G64_SINT:Ga,VK_FORMAT_R64G64_UINT:ka,VK_FORMAT_R64_SFLOAT:Na,VK_FORMAT_R64_SINT:Va,VK_FORMAT_R64_UINT:Ka,VK_FORMAT_R8G8B8A8_SINT:zo,VK_FORMAT_R8G8B8A8_SNORM:jo,VK_FORMAT_R8G8B8A8_SRGB:Xo,VK_FORMAT_R8G8B8A8_UINT:Ho,VK_FORMAT_R8G8B8A8_UNORM:Go,VK_FORMAT_R8G8B8_SINT:xo,VK_FORMAT_R8G8B8_SNORM:Bo,VK_FORMAT_R8G8B8_SRGB:Uo,VK_FORMAT_R8G8B8_UINT:Io,VK_FORMAT_R8G8B8_UNORM:Po,VK_FORMAT_R8G8_SINT:Fo,VK_FORMAT_R8G8_SNORM:Eo,VK_FORMAT_R8G8_SRGB:Lo,VK_FORMAT_R8G8_UINT:Co,VK_FORMAT_R8G8_UNORM:Oo,VK_FORMAT_R8_SINT:yo,VK_FORMAT_R8_SNORM:Ro,VK_FORMAT_R8_SRGB:vo,VK_FORMAT_R8_UINT:Mo,VK_FORMAT_R8_UNORM:So,VK_FORMAT_S8_UINT:tl,VK_FORMAT_UNDEFINED:ho,VK_FORMAT_X8_D24_UNORM_PACK32:$a,read:Vc,write:kc},Symbol.toStringTag,{value:"Module"}));const{read:jc,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:Hc,KHR_DF_TRANSFER_SRGB:zc,VK_FORMAT_UNDEFINED:Xc,VK_FORMAT_R16_SFLOAT:ti,VK_FORMAT_R16G16_SFLOAT:ni,VK_FORMAT_R16G16B16A16_SFLOAT:ii,VK_FORMAT_R32_SFLOAT:si,VK_FORMAT_R32G32_SFLOAT:ri,VK_FORMAT_R32G32B32A32_SFLOAT:oi,VK_FORMAT_R8_SRGB:fn,VK_FORMAT_R8_UNORM:ai,VK_FORMAT_R8G8_SRGB:dn,VK_FORMAT_R8G8_UNORM:li,VK_FORMAT_R8G8B8A8_SRGB:hn,VK_FORMAT_R8G8B8A8_UNORM:ci}=Gc,Yt=new WeakMap;let Qt=0;class xe extends Li{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new cr,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER!="undefined"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}detectSupport(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const e=new Wt(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),i=new Wt(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);const s=i.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,s]).then(([r,o])=>{const l=xe.BasisWorker.toString(),a=["/* constants */","let _EngineFormat = "+JSON.stringify(xe.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(xe.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(xe.BasisFormat),"/* basis_transcoder.js */",r,"/* worker */",l.substring(l.indexOf("{")+1,l.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a])),this.transcoderBinary=o,this.workerPool.setWorkerCreator(()=>{const c=new Worker(this.workerSourceURL),_=this.transcoderBinary.slice(0);return c.postMessage({type:"init",config:this.workerConfig,transcoderBinary:_},[_]),c})}),Qt>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Qt++}return this.transcoderPending}load(e,t,i,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const r=new Wt(this.manager);r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials),r.load(e,o=>{if(Yt.has(o))return Yt.get(o).promise.then(t).catch(s);this._createTexture(o).then(l=>t?t(l):null).catch(s)},i,s)}_createTextureFrom(e){const{mipmaps:t,width:i,height:s,format:r,type:o,error:l,dfdTransferFn:a,dfdFlags:c}=e;if(o==="error")return Promise.reject(l);const _=new Ii(t,i,s,r,We);return _.minFilter=t.length===1?_n:Pi,_.magFilter=_n,_.generateMipmaps=!1,_.needsUpdate=!0,_.encoding=a===zc?ht:an,_.premultiplyAlpha=!!(c&Hc),_}_createTexture(e,t={}){const i=jc(new Uint8Array(e));if(i.vkFormat!==Xc)return Yc(i);const s=t,r=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:s},[e])).then(o=>this._createTextureFrom(o.data));return Yt.set(e,{promise:r}),r}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Qt--,this}}xe.BasisFormat={ETC1S:0,UASTC_4x4:1};xe.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16};xe.EngineFormat={RGBAFormat:dt,RGBA_ASTC_4x4_Format:xi,RGBA_BPTC_Format:Ui,RGBA_ETC2_EAC_Format:Di,RGBA_PVRTC_4BPPV1_Format:Ki,RGBA_S3TC_DXT5_Format:Vi,RGB_ETC1_Format:Ni,RGB_ETC2_Format:ki,RGB_PVRTC_4BPPV1_Format:Gi,RGB_S3TC_DXT1_Format:ji};xe.BasisWorker=function(){let n,e,t;const i=_EngineFormat,s=_TranscoderFormat,r=_BasisFormat;self.addEventListener("message",function(h){const A=h.data;switch(A.type){case"init":n=A.config,o(A.transcoderBinary);break;case"transcode":e.then(()=>{try{const{width:f,height:d,hasAlpha:g,mipmaps:p,format:w,dfdTransferFn:b,dfdFlags:R}=l(A.buffer),T=[];for(let C=0;C<p.length;++C)T.push(p[C].data.buffer);self.postMessage({type:"transcode",id:A.id,width:f,height:d,hasAlpha:g,mipmaps:p,format:w,dfdTransferFn:b,dfdFlags:R},T)}catch(f){console.error(f),self.postMessage({type:"error",id:A.id,error:f.message})}});break}});function o(h){e=new Promise(A=>{t={wasmBinary:h,onRuntimeInitialized:A},BASIS(t)}).then(()=>{t.initializeBasis(),t.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function l(h){const A=new t.KTX2File(new Uint8Array(h));function f(){A.close(),A.delete()}if(!A.isValid())throw f(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const d=A.isUASTC()?r.UASTC_4x4:r.ETC1S,g=A.getWidth(),p=A.getHeight(),w=A.getLevels(),b=A.getHasAlpha(),R=A.getDFDTransferFunc(),T=A.getDFDFlags(),{transcoderFormat:C,engineFormat:S}=m(d,g,p,b);if(!g||!p||!w)throw f(),new Error("THREE.KTX2Loader:	Invalid texture");if(!A.startTranscoding())throw f(),new Error("THREE.KTX2Loader: .startTranscoding failed");const y=[];for(let x=0;x<w;x++){const v=A.getImageLevelInfo(x,0,0),U=v.origWidth,E=v.origHeight,L=new Uint8Array(A.getImageTranscodedSizeInBytes(x,0,0,C));if(!A.transcodeImage(L,x,0,0,C,0,-1,-1))throw f(),new Error("THREE.KTX2Loader: .transcodeImage failed.");y.push({data:L,width:U,height:E})}return f(),{width:g,height:p,hasAlpha:b,mipmaps:y,format:S,dfdTransferFn:R,dfdFlags:T}}const a=[{if:"astcSupported",basisFormat:[r.UASTC_4x4],transcoderFormat:[s.ASTC_4x4,s.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.BC7_M5,s.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.BC1,s.BC3],engineFormat:[i.RGB_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.ETC1,s.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.ETC1],engineFormat:[i.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.PVRTC1_4_RGB,s.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],c=a.sort(function(h,A){return h.priorityETC1S-A.priorityETC1S}),_=a.sort(function(h,A){return h.priorityUASTC-A.priorityUASTC});function m(h,A,f,d){let g,p;const w=h===r.ETC1S?c:_;for(let b=0;b<w.length;b++){const R=w[b];if(!!n[R.if]&&!!R.basisFormat.includes(h)&&!(d&&R.transcoderFormat.length<2)&&!(R.needsPowerOfTwo&&!(u(A)&&u(f))))return g=R.transcoderFormat[d?1:0],p=R.engineFormat[d?1:0],{transcoderFormat:g,engineFormat:p}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),g=s.RGBA32,p=i.RGBAFormat,{transcoderFormat:g,engineFormat:p}}function u(h){return h<=2?!0:(h&h-1)===0&&h!==0}};const Fn={[oi]:dt,[ii]:dt,[ci]:dt,[hn]:dt,[ri]:yt,[ni]:yt,[li]:yt,[dn]:yt,[si]:vt,[ti]:vt,[fn]:vt,[ai]:vt},Zt={[oi]:Ft,[ii]:Lt,[ci]:We,[hn]:We,[ri]:Ft,[ni]:Lt,[li]:We,[dn]:We,[si]:Ft,[ti]:Lt,[fn]:We,[ai]:We},Wc={[hn]:ht,[dn]:ht,[fn]:ht};function Yc(n){const{vkFormat:e,pixelWidth:t,pixelHeight:i,pixelDepth:s}=n;if(Fn[e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let r;const o=n.levels[0].levelData;Zt[e]===Ft?r=new Float32Array(o.buffer,o.byteOffset,o.byteLength/Float32Array.BYTES_PER_ELEMENT):Zt[e]===Lt?r=new Uint16Array(o.buffer,o.byteOffset,o.byteLength/Uint16Array.BYTES_PER_ELEMENT):r=o;const l=s===0?new Hi(r,t,i):new zi(r,t,i,s);return l.type=Zt[e],l.format=Fn[e],l.encoding=Wc[e]||an,l.needsUpdate=!0,Promise.resolve(l)}const Jf=new Hn,$f=new Q;Pt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ce(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Xi.line={uniforms:xt.merge([Pt.common,Pt.fog,Pt.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};const ed=new Q,td=new Q,nd=new jt,id=new jt,sd=new jt,rd=new Q,od=new bt,ad=new Wi,ld=new Q,cd=new Hn,ud=new Bi,fd=new jt;xs(pn,()=>new pn);const Qc=()=>{const n=di();return{hasEventListeners:t=>{const i=n.$$.callbacks;return t in i&&i[t].length>0}}},Zc=n=>({}),Ln=n=>({});function qc(n){let e;const t=n[31].threlte,i=Se(t,n,n[40],Ln);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[1]&512)&&Te(i,t,s,s[40],e?be(t,s[40],r,Zc):Ae(s[40]),Ln)},i(s){e||(B(i,s),e=!0)},o(s){I(i,s),e=!1},d(s){i&&i.d(s)}}}function Jc(n){let e=n[10],t,i,s=n[10]&&qt(n);return{c(){s&&s.c(),t=Ve()},l(r){s&&s.l(r),t=Ve()},m(r,o){s&&s.m(r,o),X(r,t,o),i=!0},p(r,o){r[10]?e?ee(e,r[10])?(s.d(1),s=qt(r),s.c(),s.m(t.parentNode,t)):s.p(r,o):(s=qt(r),s.c(),s.m(t.parentNode,t)):e&&(s.d(1),s=null),e=r[10]},i(r){i||(B(s),i=!0)},o(r){I(s),i=!1},d(r){r&&D(t),s&&s.d(r)}}}function $c(n){let e=n[10],t,i,s=n[10]&&Jt(n);return{c(){s&&s.c(),t=Ve()},l(r){s&&s.l(r),t=Ve()},m(r,o){s&&s.m(r,o),X(r,t,o),i=!0},p(r,o){r[10]?e?ee(e,r[10])?(s.d(1),s=Jt(r),s.c(),s.m(t.parentNode,t)):s.p(r,o):(s=Jt(r),s.c(),s.m(t.parentNode,t)):e&&(s.d(1),s=null),e=r[10]},i(r){i||(B(s),i=!0)},o(r){I(s),i=!1},d(r){r&&D(t),s&&s.d(r)}}}function qt(n){let e,t,i,s,r,o,l;const a=n[31].default,c=Se(a,n,n[40],null);let _=[],m={};for(let u=0;u<_.length;u+=1)m=Kn(m,_[u]);return{c(){e=pe(n[10]),t=pe("div"),c&&c.c(),this.h()},l(u){e=ge(u,(n[10]||"null").toUpperCase(),{});var h=we(e);t=ge(h,"DIV",{style:!0});var A=we(t);c&&c.l(A),A.forEach(D),h.forEach(D),this.h()},h(){Ue(t,"style",i=["position: absolute",n[8]?"transform: translate3d(-50%,-50%,0)":"transform: none",n[9]&&`top: ${-n[16]}px; left: ${-n[17]}px; width: ${n[15].width}px; height: ${n[15].height}px`].filter(Pn).join("; ")),It(e,m)},m(u,h){X(u,e,h),_e(e,t),c&&c.m(t,null),n[39](e),r=!0,o||(l=on(s=n[22].call(null,e)),o=!0)},p(u,h){c&&c.p&&(!r||h[1]&512)&&Te(c,a,u,u[40],r?be(a,u[40],h,null):Ae(u[40]),null),(!r||h[0]&230144&&i!==(i=["position: absolute",u[8]?"transform: translate3d(-50%,-50%,0)":"transform: none",u[9]&&`top: ${-u[16]}px; left: ${-u[17]}px; width: ${u[15].width}px; height: ${u[15].height}px`].filter(Pn).join("; ")))&&Ue(t,"style",i),It(e,m=Dn(_,[]))},i(u){r||(B(c,u),r=!0)},o(u){I(c,u),r=!1},d(u){u&&D(e),c&&c.d(u),n[39](null),o=!1,l()}}}function Jt(n){let e,t,i,s,r,o,l;const a=n[31].default,c=Se(a,n,n[40],null);let _=[{style:"position: absolute; top: 0; left: 0; pointer-events: none; overflow: hidden; display: block"}],m={};for(let u=0;u<_.length;u+=1)m=Kn(m,_[u]);return{c(){e=pe(n[10]),t=pe("div"),i=pe("div"),c&&c.c(),this.h()},l(u){e=ge(u,(n[10]||"null").toUpperCase(),{style:!0});var h=we(e);t=ge(h,"DIV",{style:!0});var A=we(t);i=ge(A,"DIV",{style:!0});var f=we(i);c&&c.l(f),f.forEach(D),A.forEach(D),h.forEach(D),this.h()},h(){Ee(i,"position","absolute"),Ee(i,"pointer-events",n[7]),Ee(t,"position","absolute"),Ee(t,"top","0"),Ee(t,"left","0"),Ee(t,"width",n[15].width+"px"),Ee(t,"height",n[15].height+"px"),Ee(t,"transform-style","preserve-3d"),Ee(t,"pointer-events","none"),It(e,m)},m(u,h){X(u,e,h),_e(e,t),_e(t,i),c&&c.m(i,null),n[36](i),n[37](t),n[38](e),r=!0,o||(l=on(s=n[22].call(null,e)),o=!0)},p(u,h){c&&c.p&&(!r||h[1]&512)&&Te(c,a,u,u[40],r?be(a,u[40],h,null):Ae(u[40]),null),(!r||h[0]&128)&&Ee(i,"pointer-events",u[7]),(!r||h[0]&32768)&&Ee(t,"width",u[15].width+"px"),(!r||h[0]&32768)&&Ee(t,"height",u[15].height+"px"),It(e,m=Dn(_,[{style:"position: absolute; top: 0; left: 0; pointer-events: none; overflow: hidden; display: block"}]))},i(u){r||(B(c,u),r=!0)},o(u){I(c,u),r=!1},d(u){u&&D(e),c&&c.d(u),n[36](null),n[37](null),n[38](null),o=!1,l()}}}function eu(n){let e,t,i,s,r,o,l,a;function c(f){n[32](f)}function _(f){n[33](f)}let m={position:n[1],scale:n[2],rotation:n[3],lookAt:n[4],viewportAware:n[5],$$slots:{default:[qc]},$$scope:{ctx:n}};n[11]!==void 0&&(m.group=n[11]),n[0]!==void 0&&(m.inViewport=n[0]),e=new Dt({props:m}),ue.push(()=>ve(e,"group",c)),ue.push(()=>ve(e,"inViewport",_)),e.$on("viewportenter",n[34]),e.$on("viewportleave",n[35]);const u=[$c,Jc],h=[];function A(f,d){return f[6]?0:1}return r=A(n),o=h[r]=u[r](n),{c(){N(e.$$.fragment),s=oe(),o.c(),l=Ve()},l(f){k(e.$$.fragment,f),s=ae(f),o.l(f),l=Ve()},m(f,d){G(e,f,d),X(f,s,d),h[r].m(f,d),X(f,l,d),a=!0},p(f,d){const g={};d[0]&2&&(g.position=f[1]),d[0]&4&&(g.scale=f[2]),d[0]&8&&(g.rotation=f[3]),d[0]&16&&(g.lookAt=f[4]),d[0]&32&&(g.viewportAware=f[5]),d[1]&512&&(g.$$scope={dirty:d,ctx:f}),!t&&d[0]&2048&&(t=!0,g.group=f[11],Oe(()=>t=!1)),!i&&d[0]&1&&(i=!0,g.inViewport=f[0],Oe(()=>i=!1)),e.$set(g);let p=r;r=A(f),r===p?h[r].p(f,d):(Vt(),I(h[p],1,1,()=>{h[p]=null}),Nt(),o=h[r],o?o.p(f,d):(o=h[r]=u[r](f),o.c()),B(o,1),o.m(l.parentNode,l))},i(f){a||(B(e.$$.fragment,f),B(o),a=!0)},o(f){I(e.$$.fragment,f),I(o),a=!1},d(f){j(e,f),f&&D(s),h[r].d(f),f&&D(l)}}}const Mt=new Q,mn=new Q,tu=new Q,nu=(n,e,t)=>{const i=Mt.setFromMatrixPosition(n.matrixWorld);i.project(e);const s=t.width/2,r=t.height/2;return[i.x*s+s,-(i.y*r)+r]},iu=(n,e)=>{const t=Mt.setFromMatrixPosition(n.matrixWorld),i=mn.setFromMatrixPosition(e.matrixWorld),s=t.sub(i),r=e.getWorldDirection(tu);return s.angleTo(r)>Math.PI/2},su=(n,e,t,i)=>{const s=Mt.setFromMatrixPosition(n.matrixWorld),r=s.clone();r.project(e),t.setFromCamera(r,e);const o=t.intersectObjects(i,!0);if(o.length){const l=o[0].distance;return s.distanceTo(t.ray.origin)<l}return!0},ru=(n,e)=>{if(e instanceof Tt)return e.zoom;if(e instanceof At){const t=Mt.setFromMatrixPosition(n.matrixWorld),i=mn.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,r=t.distanceTo(i),o=2*Math.tan(s/2)*r;return 1/o}else return 1},ou=(n,e,t)=>{if(e instanceof At||e instanceof Tt){const i=Mt.setFromMatrixPosition(n.matrixWorld),s=mn.setFromMatrixPosition(e.matrixWorld),r=i.distanceTo(s),o=(t[1]-t[0])/(e.far-e.near),l=t[1]-o*e.far;return Math.round(o*r+l)}},rn=n=>Math.abs(n)<1e-10?0:n,ui=(n,e,t="")=>{let i="matrix3d(";for(let s=0;s!==16;s++)i+=rn(e[s]*n.elements[s])+(s!==15?",":")");return t+i},au=(n=>e=>ui(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),lu=(n=>(e,t)=>ui(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]),Pn=n=>!!n;function cu(n,e,t){let i,s,r,o,{$$slots:l={},$$scope:a}=e,{position:c=void 0}=e,{scale:_=void 0}=e,{rotation:m=void 0}=e,{lookAt:u=void 0}=e,{viewportAware:h=!1}=e,{inViewport:A=!1}=e,{transform:f=!1}=e,{calculatePosition:d=nu}=e,{eps:g=.001}=e,{occlude:p=void 0}=e,{zIndexRange:w=[16777271,0]}=e,{sprite:b=!1}=e,{pointerEvents:R="auto"}=e,{center:T=!1}=e,{fullscreen:C=!1}=e,{distanceFactor:S=void 0}=e,{as:y="div"}=e,{portal:x=void 0}=e;const v=wt();let U;const{renderer:E,camera:L,scene:W,size:$}=Le();q(n,L,M=>t(44,s=M)),q(n,$,M=>t(15,i=M));const z=()=>{if(!(s instanceof At)&&!(s instanceof Tt))throw new Error("Only PerspectiveCamera or OrthographicCamera supported for component <HTML>");return s},{raycaster:Y}=zt();let F=[0,0],O=0,{visible:te=!0}=e,H=document.createElement(y),ne,le;const{hasEventListeners:P}=Qc();let me=typeof p=="boolean"&&p===!0?[W]:Array.isArray(p)?p:void 0;const J=nn($,M=>M.width/2);q(n,J,M=>t(17,o=M));const K=nn($,M=>M.height/2);q(n,K,M=>t(16,r=M)),Rt(()=>{if(!U||!H)return;const M=z();M.updateMatrixWorld(),U.updateWorldMatrix(!0,!1);const Pe=f?F:d(U,M,i);if(f||Math.abs(O-M.zoom)>g||Math.abs(F[0]-Pe[0])>g||Math.abs(F[1]-Pe[1])>g){const Qe=iu(U,M),ke=te;if(me){const Re=su(U,M,Y,me);t(23,te=Re&&!Qe)}else t(23,te=!Qe);if(ke!==te&&(P("visibilitychange")?v("visibilitychange",te):t(12,H.style.display=te?"block":"none",H)),t(12,H.style.zIndex=`${ou(U,M,w)}`,H),f){const Re=M.projectionMatrix.elements[5]*r,{isOrthographicCamera:De,top:Ge,left:je,bottom:He,right:ze}=M;let Me=U.matrixWorld;if(b&&(Me=M.matrixWorldInverse.clone().transpose().copyPosition(Me).scale(U.scale),Me.elements[3]=Me.elements[7]=Me.elements[11]=0,Me.elements[15]=1),t(12,H.style.width=i.width+"px",H),t(12,H.style.height=i.height+"px",H),t(12,H.style.perspective=De?"":`${Re}px`,H),ne&&le){const Xe=De?`scale(${Re}) translate(${rn(-(ze+je)/2)}px,${rn((Ge+He)/2)}px)`:`translateZ(${Re}px)`,Z=au(M.matrixWorldInverse);t(13,ne.style.transform=`${Xe}${Z}translate(${o}px, ${r}px)`,ne),t(14,le.style.transform=lu(Me,1/((S||10)/400)),le)}}else{const Re=S===void 0?1:ru(U,M)*S;t(12,H.style.transform=`translate3d(${Pe[0]}px, ${Pe[1]}px, 0) scale(${Re})`,H)}F=Pe,O=M.zoom}},{debugFrameloopMessage:"HTML: tracking parent"}),Un(()=>{if(!U||f||!H)return;W.updateMatrixWorld();const M=d(U,s,i);t(12,H.style.cssText=`position: absolute; top: 0; left: 0; transform: translate3d(${M[0]}px, ${M[1]}px, 0); transform-origin: 0 0;`,H)});const tt=M=>((x!=null?x:E.domElement.parentElement).appendChild(M),{destroy:()=>{!M.parentNode||M.parentNode.removeChild(M)}});function nt(M){U=M,t(11,U)}function it(M){A=M,t(0,A)}function st(M){V.call(this,n,M)}function rt(M){V.call(this,n,M)}function ot(M){ue[M?"unshift":"push"](()=>{le=M,t(14,le)})}function at(M){ue[M?"unshift":"push"](()=>{ne=M,t(13,ne)})}function lt(M){ue[M?"unshift":"push"](()=>{H=M,t(12,H)})}function ct(M){ue[M?"unshift":"push"](()=>{H=M,t(12,H)})}return n.$$set=M=>{"position"in M&&t(1,c=M.position),"scale"in M&&t(2,_=M.scale),"rotation"in M&&t(3,m=M.rotation),"lookAt"in M&&t(4,u=M.lookAt),"viewportAware"in M&&t(5,h=M.viewportAware),"inViewport"in M&&t(0,A=M.inViewport),"transform"in M&&t(6,f=M.transform),"calculatePosition"in M&&t(24,d=M.calculatePosition),"eps"in M&&t(25,g=M.eps),"occlude"in M&&t(26,p=M.occlude),"zIndexRange"in M&&t(27,w=M.zIndexRange),"sprite"in M&&t(28,b=M.sprite),"pointerEvents"in M&&t(7,R=M.pointerEvents),"center"in M&&t(8,T=M.center),"fullscreen"in M&&t(9,C=M.fullscreen),"distanceFactor"in M&&t(29,S=M.distanceFactor),"as"in M&&t(10,y=M.as),"portal"in M&&t(30,x=M.portal),"visible"in M&&t(23,te=M.visible),"$$scope"in M&&t(40,a=M.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&67108864&&(me=typeof p=="boolean"&&p===!0?[W]:Array.isArray(p)?p:void 0)},[A,c,_,m,u,h,f,R,T,C,y,U,H,ne,le,i,r,o,L,$,J,K,tt,te,d,g,p,w,b,S,x,l,nt,it,st,rt,ot,at,lt,ct,a]}class uu extends ie{constructor(e){super(),se(this,e,cu,eu,ee,{position:1,scale:2,rotation:3,lookAt:4,viewportAware:5,inViewport:0,transform:6,calculatePosition:24,eps:25,occlude:26,zIndexRange:27,sprite:28,pointerEvents:7,center:8,fullscreen:9,distanceFactor:29,as:10,portal:30,visible:23},null,[-1,-1])}}function Bn(n,e,t){const i=n.slice();i[2]=e[t];const s=Math.random();i[3]=s;const r=Math.random()>.5?1:-1;i[4]=r;const o=Math.random();i[5]=o;const l=Math.random()>.5?1:-1;return i[6]=l,i}function In(n){let e,t;return e=new pt({props:{castShadow:!0,receiveShadow:!0,position:{x:n[4]*n[3],y:0,z:n[6]*n[5]},geometry:new en(1,1,1),material:new mt({side:tn,color:"black"})}}),{c(){N(e.$$.fragment)},l(i){k(e.$$.fragment,i)},m(i,s){G(e,i,s),t=!0},p:et,i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){j(e,i)}}}function fu(n){let e,t,i=[1,1,1],s=[];for(let o=0;o<3;o+=1)s[o]=In(Bn(n,i,o));const r=o=>I(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<3;o+=1)s[o].c();e=Ve()},l(o){for(let l=0;l<3;l+=1)s[l].l(o);e=Ve()},m(o,l){for(let a=0;a<3;a+=1)s[a].m(o,l);X(o,e,l),t=!0},p(o,l){if(l&0){i=[1,1,1];let a;for(a=0;a<3;a+=1){const c=Bn(o,i,a);s[a]?(s[a].p(c,l),B(s[a],1)):(s[a]=In(c),s[a].c(),B(s[a],1),s[a].m(e.parentNode,e))}for(Vt(),a=3;a<3;a+=1)r(a);Nt()}},i(o){if(!t){for(let l=0;l<3;l+=1)B(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<3;l+=1)I(s[l]);t=!1},d(o){hi(s,o),o&&D(e)}}}function du(n){let e,t;return e=new Dt({props:{position:n[0],rotation:n[1],castShadow:!0,receiveShadow:!0,$$slots:{default:[fu]},$$scope:{ctx:n}}}),{c(){N(e.$$.fragment)},l(i){k(e.$$.fragment,i)},m(i,s){G(e,i,s),t=!0},p(i,[s]){const r={};s&1&&(r.position=i[0]),s&2&&(r.rotation=i[1]),s&512&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){j(e,i)}}}function hu(n,e,t){let{position:i=void 0}=e,{rotation:s=void 0}=e;return n.$$set=r=>{"position"in r&&t(0,i=r.position),"rotation"in r&&t(1,s=r.rotation)},[i,s]}class $t extends ie{constructor(e){super(),se(this,e,hu,du,ee,{position:0,rotation:1})}}const mu=.5*(Math.sqrt(3)-1),ft=(3-Math.sqrt(3))/6,_u=1/3,Be=1/6,pu=(Math.sqrt(5)-1)/4,fe=(5-Math.sqrt(5))/20,ce=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),re=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class gu{constructor(e=Math.random){const t=typeof e=="function"?e:Au(e);this.p=Tu(t),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let i=0;i<512;i++)this.perm[i]=this.p[i&255],this.permMod12[i]=this.perm[i]%12}noise2D(e,t){const i=this.permMod12,s=this.perm;let r=0,o=0,l=0;const a=(e+t)*mu,c=Math.floor(e+a),_=Math.floor(t+a),m=(c+_)*ft,u=c-m,h=_-m,A=e-u,f=t-h;let d,g;A>f?(d=1,g=0):(d=0,g=1);const p=A-d+ft,w=f-g+ft,b=A-1+2*ft,R=f-1+2*ft,T=c&255,C=_&255;let S=.5-A*A-f*f;if(S>=0){const v=i[T+s[C]]*3;S*=S,r=S*S*(ce[v]*A+ce[v+1]*f)}let y=.5-p*p-w*w;if(y>=0){const v=i[T+d+s[C+g]]*3;y*=y,o=y*y*(ce[v]*p+ce[v+1]*w)}let x=.5-b*b-R*R;if(x>=0){const v=i[T+1+s[C+1]]*3;x*=x,l=x*x*(ce[v]*b+ce[v+1]*R)}return 70*(r+o+l)}noise3D(e,t,i){const s=this.permMod12,r=this.perm;let o,l,a,c;const _=(e+t+i)*_u,m=Math.floor(e+_),u=Math.floor(t+_),h=Math.floor(i+_),A=(m+u+h)*Be,f=m-A,d=u-A,g=h-A,p=e-f,w=t-d,b=i-g;let R,T,C,S,y,x;p>=w?w>=b?(R=1,T=0,C=0,S=1,y=1,x=0):p>=b?(R=1,T=0,C=0,S=1,y=0,x=1):(R=0,T=0,C=1,S=1,y=0,x=1):w<b?(R=0,T=0,C=1,S=0,y=1,x=1):p<b?(R=0,T=1,C=0,S=0,y=1,x=1):(R=0,T=1,C=0,S=1,y=1,x=0);const v=p-R+Be,U=w-T+Be,E=b-C+Be,L=p-S+2*Be,W=w-y+2*Be,$=b-x+2*Be,z=p-1+3*Be,Y=w-1+3*Be,F=b-1+3*Be,O=m&255,te=u&255,H=h&255;let ne=.6-p*p-w*w-b*b;if(ne<0)o=0;else{const J=s[O+r[te+r[H]]]*3;ne*=ne,o=ne*ne*(ce[J]*p+ce[J+1]*w+ce[J+2]*b)}let le=.6-v*v-U*U-E*E;if(le<0)l=0;else{const J=s[O+R+r[te+T+r[H+C]]]*3;le*=le,l=le*le*(ce[J]*v+ce[J+1]*U+ce[J+2]*E)}let P=.6-L*L-W*W-$*$;if(P<0)a=0;else{const J=s[O+S+r[te+y+r[H+x]]]*3;P*=P,a=P*P*(ce[J]*L+ce[J+1]*W+ce[J+2]*$)}let me=.6-z*z-Y*Y-F*F;if(me<0)c=0;else{const J=s[O+1+r[te+1+r[H+1]]]*3;me*=me,c=me*me*(ce[J]*z+ce[J+1]*Y+ce[J+2]*F)}return 32*(o+l+a+c)}noise4D(e,t,i,s){const r=this.perm;let o,l,a,c,_;const m=(e+t+i+s)*pu,u=Math.floor(e+m),h=Math.floor(t+m),A=Math.floor(i+m),f=Math.floor(s+m),d=(u+h+A+f)*fe,g=u-d,p=h-d,w=A-d,b=f-d,R=e-g,T=t-p,C=i-w,S=s-b;let y=0,x=0,v=0,U=0;R>T?y++:x++,R>C?y++:v++,R>S?y++:U++,T>C?x++:v++,T>S?x++:U++,C>S?v++:U++;const E=y>=3?1:0,L=x>=3?1:0,W=v>=3?1:0,$=U>=3?1:0,z=y>=2?1:0,Y=x>=2?1:0,F=v>=2?1:0,O=U>=2?1:0,te=y>=1?1:0,H=x>=1?1:0,ne=v>=1?1:0,le=U>=1?1:0,P=R-E+fe,me=T-L+fe,J=C-W+fe,K=S-$+fe,tt=R-z+2*fe,nt=T-Y+2*fe,it=C-F+2*fe,st=S-O+2*fe,rt=R-te+3*fe,ot=T-H+3*fe,at=C-ne+3*fe,lt=S-le+3*fe,ct=R-1+4*fe,M=T-1+4*fe,Pe=C-1+4*fe,Qe=S-1+4*fe,ke=u&255,Re=h&255,De=A&255,Ge=f&255;let je=.6-R*R-T*T-C*C-S*S;if(je<0)o=0;else{const Z=r[ke+r[Re+r[De+r[Ge]]]]%32*4;je*=je,o=je*je*(re[Z]*R+re[Z+1]*T+re[Z+2]*C+re[Z+3]*S)}let He=.6-P*P-me*me-J*J-K*K;if(He<0)l=0;else{const Z=r[ke+E+r[Re+L+r[De+W+r[Ge+$]]]]%32*4;He*=He,l=He*He*(re[Z]*P+re[Z+1]*me+re[Z+2]*J+re[Z+3]*K)}let ze=.6-tt*tt-nt*nt-it*it-st*st;if(ze<0)a=0;else{const Z=r[ke+z+r[Re+Y+r[De+F+r[Ge+O]]]]%32*4;ze*=ze,a=ze*ze*(re[Z]*tt+re[Z+1]*nt+re[Z+2]*it+re[Z+3]*st)}let Me=.6-rt*rt-ot*ot-at*at-lt*lt;if(Me<0)c=0;else{const Z=r[ke+te+r[Re+H+r[De+ne+r[Ge+le]]]]%32*4;Me*=Me,c=Me*Me*(re[Z]*rt+re[Z+1]*ot+re[Z+2]*at+re[Z+3]*lt)}let Xe=.6-ct*ct-M*M-Pe*Pe-Qe*Qe;if(Xe<0)_=0;else{const Z=r[ke+1+r[Re+1+r[De+1+r[Ge+1]]]]%32*4;Xe*=Xe,_=Xe*Xe*(re[Z]*ct+re[Z+1]*M+re[Z+2]*Pe+re[Z+3]*Qe)}return 27*(o+l+a+c+_)}}var wu=gu;function Tu(n){const e=new Uint8Array(256);for(let t=0;t<256;t++)e[t]=t;for(let t=0;t<255;t++){const i=t+~~(n()*(256-t)),s=e[t];e[t]=e[i],e[i]=s}return e}function Au(n){let e=0,t=0,i=0,s=1;const r=bu();return e=r(" "),t=r(" "),i=r(" "),e-=r(n),e<0&&(e+=1),t-=r(n),t<0&&(t+=1),i-=r(n),i<0&&(i+=1),function(){const o=2091639*e+s*23283064365386963e-26;return e=t,t=i,i=o-(s=o|0)}}function bu(){let n=4022871197;return function(e){e=e.toString();for(let t=0;t<e.length;t++){n+=e.charCodeAt(t);let i=.02519603282416938*n;n=i>>>0,i-=n,i*=n,n=i>>>0,i-=n,n+=i*4294967296}return(n>>>0)*23283064365386963e-26}}function Su(n){let e,t;return e=new pt({props:{interactive:!0,receiveShadow:!0,rotation:{x:-90*(Math.PI/180)},geometry:n[0],material:new mt({side:Oi,color:"grey"})}}),e.$on("click",n[10]),e.$on("contextmenu",n[11]),{c(){N(e.$$.fragment)},l(i){k(e.$$.fragment,i)},m(i,s){G(e,i,s),t=!0},p:et,i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){j(e,i)}}}function Ru(n,e,t){let{seed:i=123456789}=e,{exponentiation:s=7.5}=e,{height:r=800}=e,{lacunarity:o=1.6}=e,{octaves:l=10}=e,{persistence:a=.5}=e,{scale:c=1800}=e,{planeWidth:_=100}=e,{planeheight:m=100}=e,u=new wu(i),h=new vi(_,m,_,m);const A=h.attributes.position.array;for(let p=0,w=0,b=A.length;p<b;p++,w+=3)A[w+2]=f(A[w],A[w+1]);h.computeVertexNormals();function f(p,w){const b=Math.pow(2,-a),R=p/c,T=w/c;let C=1,S=1,y=0,x=0;for(let v=0;v<l;v++)x+=(u.noise2D(R*S,T*S)*.5+.5)*C,y+=C,C*=b,S*=o;return x/=y,Math.pow(x,s)*r}function d(p){V.call(this,n,p)}function g(p){V.call(this,n,p)}return n.$$set=p=>{"seed"in p&&t(1,i=p.seed),"exponentiation"in p&&t(2,s=p.exponentiation),"height"in p&&t(3,r=p.height),"lacunarity"in p&&t(4,o=p.lacunarity),"octaves"in p&&t(5,l=p.octaves),"persistence"in p&&t(6,a=p.persistence),"scale"in p&&t(7,c=p.scale),"planeWidth"in p&&t(8,_=p.planeWidth),"planeheight"in p&&t(9,m=p.planeheight)},[h,i,s,r,o,l,a,c,_,m,d,g]}class Mu extends ie{constructor(e){super(),se(this,e,Ru,Su,ee,{seed:1,exponentiation:2,height:3,lacunarity:4,octaves:5,persistence:6,scale:7,planeWidth:8,planeheight:9})}}function xn(n){let e,t,i=n[0].position+"",s;return{c(){e=pe("p"),t=Je("camera - "),s=Je(i)},l(r){e=ge(r,"P",{});var o=we(e);t=$e(o,"camera - "),s=$e(o,i),o.forEach(D)},m(r,o){X(r,e,o),_e(e,t),_e(e,s)},p(r,o){o&1&&i!==(i=r[0].position+"")&&Vn(s,i)},d(r){r&&D(e)}}}function yu(n){let e,t;return e=new Ks({props:{maxPolarAngle:qi*80,target:{y:.5},enablePan:!1}}),{c(){N(e.$$.fragment)},l(i){k(e.$$.fragment,i)},m(i,s){G(e,i,s),t=!0},p:et,i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){j(e,i)}}}function vu(n){let e,t,i,s,r;return{c(){e=pe("div"),t=pe("button"),i=Je("hello"),this.h()},l(o){e=ge(o,"DIV",{});var l=we(e);t=ge(l,"BUTTON",{class:!0});var a=we(t);i=$e(a,"hello"),a.forEach(D),l.forEach(D),this.h()},h(){Ue(t,"class","btn")},m(o,l){X(o,e,l),_e(e,t),_e(t,i),s||(r=Ie(t,"click",n[13]),s=!0)},p:et,d(o){o&&D(e),s=!1,r()}}}function Ou(n){let e,t;return e=new uu({props:{center:!0,position:{x:0,y:4,z:0},$$slots:{default:[vu]},$$scope:{ctx:n}}}),{c(){N(e.$$.fragment)},l(i){k(e.$$.fragment,i)},m(i,s){G(e,i,s),t=!0},p(i,s){const r={};s&262144&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(B(e.$$.fragment,i),t=!0)},o(i){I(e.$$.fragment,i),t=!1},d(i){j(e,i)}}}function Eu(n){let e,t,i;function s(o){n[14](o)}let r={interactive:!0,receiveShadow:!0,castShadow:!0,geometry:new Yi(1,3,2,10),material:new mt({color:"#333333"}),position:{y:2},$$slots:{default:[Ou]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.mesh=n[1]),e=new pt({props:r}),ue.push(()=>ve(e,"mesh",s)),e.$on("click",n[15]),e.$on("contextmenu",n[16]),{c(){N(e.$$.fragment)},l(o){k(e.$$.fragment,o)},m(o,l){G(e,o,l),i=!0},p(o,l){const a={};l&262144&&(a.$$scope={dirty:l,ctx:o}),!t&&l&2&&(t=!0,a.mesh=o[1],Oe(()=>t=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){I(e.$$.fragment,o),i=!1},d(o){j(e,o)}}}function Cu(n){let e,t,i,s,r,o,l,a,c,_;return e=new pt({props:{castShadow:!0,receiveShadow:!0,position:{x:7,y:.5,z:5},geometry:new en(1,1,1),material:new mt({side:tn,color:"black"})}}),i=new pt({props:{castShadow:!0,receiveShadow:!0,position:{x:0,y:.5,z:-8},geometry:new en(1,1,1),material:new mt({side:tn,color:"black"})}}),r=new $t({props:{position:{x:6,y:.5,z:-5}}}),l=new $t({props:{position:{x:-7,y:.5,z:-2}}}),c=new $t({props:{position:{x:-6,y:.5,z:6}}}),{c(){N(e.$$.fragment),t=oe(),N(i.$$.fragment),s=oe(),N(r.$$.fragment),o=oe(),N(l.$$.fragment),a=oe(),N(c.$$.fragment)},l(m){k(e.$$.fragment,m),t=ae(m),k(i.$$.fragment,m),s=ae(m),k(r.$$.fragment,m),o=ae(m),k(l.$$.fragment,m),a=ae(m),k(c.$$.fragment,m)},m(m,u){G(e,m,u),X(m,t,u),G(i,m,u),X(m,s,u),G(r,m,u),X(m,o,u),G(l,m,u),X(m,a,u),G(c,m,u),_=!0},p:et,i(m){_||(B(e.$$.fragment,m),B(i.$$.fragment,m),B(r.$$.fragment,m),B(l.$$.fragment,m),B(c.$$.fragment,m),_=!0)},o(m){I(e.$$.fragment,m),I(i.$$.fragment,m),I(r.$$.fragment,m),I(l.$$.fragment,m),I(c.$$.fragment,m),_=!1},d(m){j(e,m),m&&D(t),j(i,m),m&&D(s),j(r,m),m&&D(o),j(l,m),m&&D(a),j(c,m)}}}function Fu(n){let e,t,i,s,r,o,l,a,c,_,m,u,h;function A(d){n[12](d)}let f={position:{x:0,y:20,z:20},fov:90,$$slots:{default:[yu]},$$scope:{ctx:n}};return n[0]!==void 0&&(f.camera=n[0]),e=new Is({props:f}),ue.push(()=>ve(e,"camera",A)),s=new Zs({props:{shadow:{mapSize:[2048,2048],camera:{bottom:-10,left:-10,right:10,top:10}},position:{x:10,y:10,z:10}}}),o=new Xs({props:{intensity:.2}}),a=new Dt({props:{scale:n[3],position:{x:n[4],y:n[5],z:n[6]},$$slots:{default:[Eu]},$$scope:{ctx:n}}}),_=new Mu({}),_.$on("click",Pu),_.$on("contextmenu",n[17]),u=new Dt({props:{$$slots:{default:[Cu]},$$scope:{ctx:n}}}),{c(){N(e.$$.fragment),i=oe(),N(s.$$.fragment),r=oe(),N(o.$$.fragment),l=oe(),N(a.$$.fragment),c=oe(),N(_.$$.fragment),m=oe(),N(u.$$.fragment)},l(d){k(e.$$.fragment,d),i=ae(d),k(s.$$.fragment,d),r=ae(d),k(o.$$.fragment,d),l=ae(d),k(a.$$.fragment,d),c=ae(d),k(_.$$.fragment,d),m=ae(d),k(u.$$.fragment,d)},m(d,g){G(e,d,g),X(d,i,g),G(s,d,g),X(d,r,g),G(o,d,g),X(d,l,g),G(a,d,g),X(d,c,g),G(_,d,g),X(d,m,g),G(u,d,g),h=!0},p(d,g){const p={};g&262144&&(p.$$scope={dirty:g,ctx:d}),!t&&g&1&&(t=!0,p.camera=d[0],Oe(()=>t=!1)),e.$set(p);const w={};g&8&&(w.scale=d[3]),g&112&&(w.position={x:d[4],y:d[5],z:d[6]}),g&262150&&(w.$$scope={dirty:g,ctx:d}),a.$set(w);const b={};g&262144&&(b.$$scope={dirty:g,ctx:d}),u.$set(b)},i(d){h||(B(e.$$.fragment,d),B(s.$$.fragment,d),B(o.$$.fragment,d),B(a.$$.fragment,d),B(_.$$.fragment,d),B(u.$$.fragment,d),h=!0)},o(d){I(e.$$.fragment,d),I(s.$$.fragment,d),I(o.$$.fragment,d),I(a.$$.fragment,d),I(_.$$.fragment,d),I(u.$$.fragment,d),h=!1},d(d){j(e,d),d&&D(i),j(s,d),d&&D(r),j(o,d),d&&D(l),j(a,d),d&&D(c),j(_,d),d&&D(m),j(u,d)}}}function Lu(n){let e,t,i,s=Math.round(n[3])+"",r,o,l,a,c,_,m,u,h,A,f,d=n[0]&&xn(n);return u=new _s({props:{$$slots:{default:[Fu]},$$scope:{ctx:n}}}),{c(){e=pe("div"),t=pe("p"),i=Je("scale - "),r=Je(s),o=oe(),d&&d.c(),l=oe(),a=pe("button"),c=Je("test"),_=oe(),m=pe("div"),N(u.$$.fragment),this.h()},l(g){e=ge(g,"DIV",{class:!0});var p=we(e);t=ge(p,"P",{});var w=we(t);i=$e(w,"scale - "),r=$e(w,s),w.forEach(D),o=ae(p),d&&d.l(p),l=ae(p),a=ge(p,"BUTTON",{class:!0});var b=we(a);c=$e(b,"test"),b.forEach(D),p.forEach(D),_=ae(g),m=ge(g,"DIV",{class:!0});var R=we(m);k(u.$$.fragment,R),R.forEach(D),this.h()},h(){Ue(a,"class","btn"),Ue(e,"class","absolute z-10 flex flex-col items-center justify-center"),Ue(m,"class","w-full h-full overflow-clip")},m(g,p){X(g,e,p),_e(e,t),_e(t,i),_e(t,r),_e(e,o),d&&d.m(e,null),_e(e,l),_e(e,a),_e(a,c),X(g,_,p),X(g,m,p),G(u,m,null),h=!0,A||(f=Ie(a,"click",n[11]),A=!0)},p(g,[p]){(!h||p&8)&&s!==(s=Math.round(g[3])+"")&&Vn(r,s),g[0]?d?d.p(g,p):(d=xn(g),d.c(),d.m(e,l)):d&&(d.d(1),d=null);const w={};p&262271&&(w.$$scope={dirty:p,ctx:g}),u.$set(w)},i(g){h||(B(u.$$.fragment,g),h=!0)},o(g){I(u.$$.fragment,g),h=!1},d(g){g&&D(e),d&&d.d(),g&&D(_),g&&D(m),j(u),A=!1,f()}}}const Pu=n=>{};function Bu(n,e,t){let i,s,r,o;const l=Ot(1);q(n,l,R=>t(3,i=R));const a=Ot(0);q(n,a,R=>t(4,s=R));const c=Ot(0);q(n,c,R=>t(5,r=R));const _=Ot(0);q(n,_,R=>t(6,o=R));let m,u,h=!1;const A=()=>{console.log(m.position)};function f(R){m=R,t(0,m)}const d=()=>{console.log("world")};function g(R){u=R,t(1,u)}return[m,u,h,i,s,r,o,l,a,c,_,A,f,d,g,()=>{t(2,h=!0)},()=>{t(2,h=!1)},R=>{const{x:T,y:C,z:S}=R.detail.point;Ye(a,s=T,s),Ye(c,r=C,r),Ye(_,o=S,o)}]}class Iu extends ie{constructor(e){super(),se(this,e,Bu,Lu,ee,{})}}function xu(n){let e,t,i,s,r;return s=new Iu({}),{c(){e=oe(),t=pe("div"),i=pe("div"),N(s.$$.fragment),this.h()},l(o){mi('[data-svelte="svelte-1hi2ed4"]',document.head).forEach(D),e=ae(o),t=ge(o,"DIV",{class:!0});var a=we(t);i=ge(a,"DIV",{class:!0});var c=we(i);k(s.$$.fragment,c),c.forEach(D),a.forEach(D),this.h()},h(){document.title="Once Upon a Threlte",Ue(i,"class","relative w-full"),Ue(t,"class","flex grow")},m(o,l){X(o,e,l),X(o,t,l),_e(t,i),G(s,i,null),r=!0},p:et,i(o){r||(B(s.$$.fragment,o),r=!0)},o(o){I(s.$$.fragment,o),r=!1},d(o){o&&D(e),o&&D(t),j(s)}}}class dd extends ie{constructor(e){super(),se(this,e,null,xu,ee,{})}}export{dd as default};
