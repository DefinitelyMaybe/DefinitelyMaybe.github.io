import{V as jt,W as pe,X as ct,S as ee,i as te,s as J,k as we,l as Te,m as Ae,h as K,n as Ce,b as Q,Y as un,I as Ue,f as B,g as Ht,t as x,d as zt,C as Ri,M as W,o as Gn,O as tt,G as Se,J as be,K as Re,L as Me,U as fe,Z as St,z as Kt,_ as bt,$ as ye,v as k,a as re,w as G,c as oe,x as j,a0 as ve,y as H,a1 as N,a2 as Mi,e as ke,P as jn,a3 as Vt,F as ue,a4 as Hn,a5 as yi,A as ft,q as Be,r as xe,u as Bt,H as vi}from"../../../../chunks/index-8c8034ba.js";import{O as Rt,g as zn,h as Xt,b as Xn,C as Ne,d as Ee,i as xt,U as Nt,j as ut,V as q,A as Oi,k as Ei,f as Wn,L as fn,s as gt,N as Ci,l as Fi,W as Li,e as Mt,c as Pi,R as Yn,m as Bi,n as Ge,o as xi,p as yt,q as Zu,r as qu,t as Ju,u as $u,v as Ii,w as Ui,Q as Wt,E as Di,x as ef,B as on,y as tf,z as nf,T as sf,P as Ki,G as Vi,I as Ni,D as ki,J as Gi,K as ji,X as Jt,Y as rf,Z as of,_ as af,$ as lf,M as wt,a0 as cf,a1 as uf,a2 as ff,a3 as Sn,a4 as df,a5 as hf,a6 as mf,a7 as Hi,a8 as _f,a9 as pf,aa as gf,ab as wf,ac as Tf,ad as bn,ae as Af,af as Sf,ag as bf,ah as Rf,ai as Mf,aj as yf,ak as vf,al as Of,am as Ef,an as Cf,ao as Ff,ap as Lf,aq as Pf,ar as Bf,as as xf,at as If,au as Uf,av as Df,aw as an,ax as Kf,ay as Qn,az as zi,aA as Xi,aB as et,aC as pt,aD as Wi,aE as Yi,aF as Qi,aG as Zi,aH as qi,aI as Ji,aJ as $i,aK as es,aL as ts,aM as Ct,aN as Ft,aO as It,aP as Ut,aQ as ns,aR as is,aS as Vf,aT as Nf,aU as kf,aV as Dt,aW as ss,aX as Yt,aY as rs,aZ as os}from"../../../../chunks/OrbitControls-48ea929b.js";import{d as Ve,w as ae,r as as}from"../../../../chunks/index-f1450eca.js";import{s as Lt}from"../../../../chunks/index-bbc19d4c.js";class vt{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const ls=new Rt(-1,1,1,-1,0,1),dn=new zn;dn.setAttribute("position",new Xt([-1,3,0,-1,-1,0,3,-1,0],3));dn.setAttribute("uv",new Xt([0,2,0,0,2,0],2));class Zn{constructor(e){this._mesh=new Xn(dn,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,ls)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const kt={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`},Rn={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ne(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Tt extends vt{constructor(e,n,i,s){super(),this.strength=n!==void 0?n:1,this.radius=i,this.threshold=s,this.resolution=e!==void 0?new Ee(e.x,e.y):new Ee(256,256),this.clearColor=new Ne(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let r=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new xt(r,o),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let h=0;h<this.nMips;h++){const u=new xt(r,o);u.texture.name="UnrealBloomPass.h"+h,u.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(u);const m=new xt(r,o);m.texture.name="UnrealBloomPass.v"+h,m.texture.generateMipmaps=!1,this.renderTargetsVertical.push(m),r=Math.round(r/2),o=Math.round(o/2)}Rn===void 0&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");const l=Rn;this.highPassUniforms=Nt.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ut({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const a=[3,5,7,9,11];r=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let h=0;h<this.nMips;h++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(a[h])),this.separableBlurMaterials[h].uniforms.texSize.value=new Ee(r,o),r=Math.round(r/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=n,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const c=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=c,this.bloomTintColors=[new q(1,1,1),new q(1,1,1),new q(1,1,1),new q(1,1,1),new q(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,kt===void 0&&console.error("THREE.UnrealBloomPass relies on CopyShader");const _=kt;this.copyUniforms=Nt.clone(_.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ut({uniforms:this.copyUniforms,vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,blending:Oi,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Ne,this.oldClearAlpha=1,this.basic=new Ei,this.fsQuad=new Zn(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}setSize(e,n){let i=Math.round(e/2),s=Math.round(n/2);this.renderTargetBright.setSize(i,s);for(let r=0;r<this.nMips;r++)this.renderTargetsHorizontal[r].setSize(i,s),this.renderTargetsVertical[r].setSize(i,s),this.separableBlurMaterials[r].uniforms.texSize.value=new Ee(i,s),i=Math.round(i/2),s=Math.round(s/2)}render(e,n,i,s,r){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),r&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let l=this.renderTargetBright;for(let a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=l.texture,this.separableBlurMaterials[a].uniforms.direction.value=Tt.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[a]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=Tt.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[a]),e.clear(),this.fsQuad.render(e),l=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,r&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){return new ut({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Ee(.5,.5)},direction:{value:new Ee(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new ut({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Tt.BlurDirectionX=new Ee(1,0);Tt.BlurDirectionY=new Ee(0,1);const cs=Math.PI/180;class Mn extends vt{constructor(e,n){super(),this.textureID=n!==void 0?n:"tDiffuse",e instanceof ut?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Nt.clone(e.uniforms),this.material=new ut({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Zn(this.material)}render(e,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class yn extends vt{constructor(e,n){super(),this.scene=e,this.camera=n,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,n,i){const s=e.getContext(),r=e.state;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0);let o,l;this.inverse?(o=0,l=1):(o=1,l=0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),r.buffers.stencil.setFunc(s.ALWAYS,o,4294967295),r.buffers.stencil.setClear(l),r.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.stencil.setLocked(!1),r.buffers.stencil.setFunc(s.EQUAL,1,4294967295),r.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),r.buffers.stencil.setLocked(!0)}}class us extends vt{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class fs{constructor(e,n){if(this.renderer=e,n===void 0){const i=e.getSize(new Ee);this._pixelRatio=e.getPixelRatio(),this._width=i.width,this._height=i.height,n=new xt(this._width*this._pixelRatio,this._height*this._pixelRatio),n.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=n.width,this._height=n.height;this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],kt===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),Mn===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Mn(kt),this.clock=new Wn}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,n){this.passes.splice(n,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const n=this.passes.indexOf(e);n!==-1&&this.passes.splice(n,1)}isLastEnabledPass(e){for(let n=e+1;n<this.passes.length;n++)if(this.passes[n].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const n=this.renderer.getRenderTarget();let i=!1;for(let s=0,r=this.passes.length;s<r;s++){const o=this.passes[s];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const l=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}yn!==void 0&&(o instanceof yn?i=!0:o instanceof us&&(i=!1))}}this.renderer.setRenderTarget(n)}reset(e){if(e===void 0){const n=this.renderer.getSize(new Ee);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,n){this._width=e,this._height=n;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let r=0;r<this.passes.length;r++)this.passes[r].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new Rt(-1,1,1,-1,0,1);const qn=new zn;qn.setAttribute("position",new Xt([-1,3,0,-1,-1,0,3,-1,0],3));qn.setAttribute("uv",new Xt([0,2,0,0,2,0],2));class Jn extends vt{constructor(e,n,i,s,r){super(),this.scene=e,this.camera=n,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=r!==void 0?r:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ne}render(e,n,i){const s=e.autoClear;e.autoClear=!1;let r,o;this.overrideMaterial!==void 0&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,r),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=o),e.autoClear=s}}const ds=(t,e,n)=>{t.renderer=new Li({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n}),t.composer=new fs(t.renderer),t.composer.addPass(new Jn(t.scene,jt(t.camera)))},vn=(t,e,n)=>{!t.renderer||(e?t.renderer.outputEncoding=fn:t.renderer.outputEncoding=gt,n?t.renderer.toneMapping=Ci:t.renderer.toneMapping=Fi)},On=(t,e,n)=>{!t.renderer||!t.composer||(t.renderer.setSize(e.width,e.height),t.renderer.setPixelRatio(n),t.composer.setSize(e.width,e.height),t.composer.setPixelRatio(n))},En=(t,e,n)=>{!t.renderer||(t.renderer.shadowMap.enabled=e,t.renderer.shadowMap.type=n)},Fe=t=>t.userData,hs=(t,e)=>{t.pointer.update(n=>t.renderer?n.set(e.offsetX/t.renderer.domElement.clientWidth*2-1,-(e.offsetY/t.renderer.domElement.clientHeight)*2+1):n)},$n=(t,e,n,i)=>(t.raycaster.setFromCamera(e,n),t.raycaster.intersectObjects(i,!1)),ms=(t,e)=>t.object.uuid!==e.object.uuid||t.instanceId!==e.instanceId,_s=(t,e,n)=>{let i;const s=t.camera.subscribe(a=>i=a);pe(s);let r;const o=t.pointer.subscribe(a=>r=a);pe(o);const l=a=>{var _,h;if(a.preventDefault(),t.pointerOverCanvas.set(!0),n.pointerInvalidated=!0,hs(t,a),e.interactiveObjects.size===0||e.raycastableObjects.size===0)return;const c=$n(e,r,i,Array.from(e.raycastableObjects));c.length>0&&e.interactiveObjects.has(c[0].object)&&((h=(_=Fe(c[0].object)).eventDispatcher)==null||h.call(_,a.type,{...c[0],event:a}))};return{onClick:l,onContextMenu:l,onPointerUp:l,onPointerDown:l,onPointerMove:l}},ps=(t,e)=>{let n=jt(t.pointerOverCanvas);const i=t.pointerOverCanvas.subscribe(c=>n=c);pe(i);let s;const r=t.camera.subscribe(c=>s=c);pe(r);let o;const l=t.pointer.subscribe(c=>o=c);return pe(l),{raycast:()=>{var h,u,m,A,f,d,g,p;if(e.interactiveObjects.size===0||e.raycastableObjects.size===0)return;const c=n?$n(e,o,s,Array.from(e.raycastableObjects)):[],_=c.length&&e.interactiveObjects.has(c[0].object)?c[0]:null;_?e.lastIntersection?e.lastIntersection&&ms(e.lastIntersection,_)&&((d=(f=Fe(e.lastIntersection.object)).eventDispatcher)==null||d.call(f,"pointerleave",e.lastIntersection),(p=(g=Fe(_.object)).eventDispatcher)==null||p.call(g,"pointerenter",_)):(A=(m=Fe(_.object)).eventDispatcher)==null||A.call(m,"pointerenter",_):e.lastIntersection&&((u=(h=Fe(e.lastIntersection.object)).eventDispatcher)==null||u.call(h,"pointerleave",e.lastIntersection)),e.lastIntersection=_}}},Qt=typeof window<"u",gs=t=>{if(!Qt)return;let e;const n=()=>{t(),e=requestAnimationFrame(n)};n(),pe(()=>{!e||cancelAnimationFrame(e)})},ws=(t,e)=>{if(e.frameHandlers.size===0)return;if(e.debugFrameloop){let s=0;e.frameHandlers.forEach(r=>{r.debugFrameloopMessage?e.invalidations[r.debugFrameloopMessage]=r.debugFrameloopMessage in e.invalidations?e.invalidations[r.debugFrameloopMessage]+1:1:++s}),s>0&&(e.invalidations.onFrame=e.frameHandlers.size)}const n=Array.from(e.frameHandlers).reduce((s,r)=>r.order?!0:s,!1),i=t.clock.getDelta();n?Array.from(e.frameHandlers).sort((s,r)=>{var o,l;return((o=s.order)!=null?o:0)>((l=r.order)!=null?l:0)?1:-1}).forEach(s=>s.fn(t,i)):e.frameHandlers.forEach(s=>s.fn(t,i))},Ts=t=>{!t.debugFrameloop||(t.frame+=1,console.log(`frame: ${t.frame}${Object.keys(t.invalidations).length>0?", requested by \u21B4":""}`),Object.keys(t.invalidations).length>0&&console.table(t.invalidations),t.invalidations={})},As=(t,e,n)=>{let i=jt(t.camera);const s=t.camera.subscribe(o=>i=o);pe(s);const{raycast:r}=ps(t,e);gs(()=>{const o=n.frameloop==="always"||n.frameloop==="demand"&&(n.frameInvalidated||n.frameHandlers.size>0)||n.frameloop==="never"&&n.advance;(o||n.pointerInvalidated)&&(r(),n.pointerInvalidated=!1),o&&(!i||!t.composer||!t.renderer||(ws(t,n),t.composer.passes.length>1?t.composer.render():t.renderer.render(t.scene,i),Ts(n),n.frameInvalidated=!1,n.advance=!1))})},Ss=()=>{const t=new Mt(75,0,.1,1e3);return Fe(t).threlteDefaultCamera=!0,t.position.z=5,t.lookAt(0,0,0),t},bs=t=>{const e=t.size.subscribe(n=>{Fe(jt(t.camera)).threlteDefaultCamera&&t.camera.update(i=>{const s=i;return s.aspect=n.width/n.height,s.updateProjectionMatrix(),t.invalidate("Default camera: aspect ratio changed"),s})});pe(e)},Rs=(t,e,n,i,s,r,o)=>{const l={audioListeners:new Map,addAudioListener:(f,d)=>{if(d=d!=null?d:"default",l.audioListeners.has(d)){console.warn(`An AudioListener with the id "${d}" has already been added, aborting.`);return}l.audioListeners.set(d,f)},removeAudioListener:f=>{if(f=f!=null?f:"default",!l.audioListeners.has(f)){console.warn(`No AudioListener with the id "${f}" found, aborting.`);return}l.audioListeners.delete(f)},getAudioListener:f=>{if(f=f!=null?f:"default",!l.audioListeners.has(f)){console.warn(`No AudioListener with the id "${f}" found, aborting.`);return}return l.audioListeners.get(f)}},a={debugFrameloop:r,frameloop:o,frame:0,frameInvalidated:!0,pointerInvalidated:!0,invalidations:{},frameHandlers:new Set,advance:!1},c={size:Ve([i,s],([f,d])=>f||d),pointer:ae(new Ee),pointerOverCanvas:ae(!1),clock:new Wn,camera:ae(Ss()),scene:new Pi,renderer:void 0,composer:void 0,invalidate:f=>{a.frameInvalidated=!0,a.debugFrameloop&&f&&(a.invalidations[f]=a.invalidations[f]?a.invalidations[f]+1:1)},advance:()=>{a.advance=!0}},_={flat:ae(e),linear:ae(t),dpr:ae(n),setCamera:f=>{c.camera.set(f),c.composer&&(c.composer.passes.forEach(d=>{d instanceof Jn&&(d.camera=f)}),c.invalidate("Canvas: setting camera"))},raycastableObjects:new Set,interactiveObjects:new Set,raycaster:new Yn,lastIntersection:null,addRaycastableObject:f=>{_.raycastableObjects.add(f)},removeRaycastableObject:f=>{_.raycastableObjects.delete(f)},addInteractiveObject:f=>{_.interactiveObjects.add(f)},removeInteractiveObject:f=>{_.interactiveObjects.delete(f)},addPass:f=>{!c.composer||(c.composer.addPass(f),c.invalidate("Canvas: adding pass"))},removePass:f=>{!c.composer||(c.composer.removePass(f),c.invalidate("Canvas: removing pass"))}};return ct("threlte",c),ct("threlte-root",_),ct("threlte-render-context",a),ct("threlte-audio-context",l),{ctx:c,rootCtx:_,renderCtx:a,audioCtx:l,getCtx:()=>c,getRootCtx:()=>_,getRenderCtx:()=>a,getAudioCtx:()=>l}},Ms=()=>{const t=ae({width:0,height:0});let e={width:0,height:0};const n=t.subscribe(o=>e=o);pe(n);let i;const s=()=>{const o=e;if(!i||!i.parentElement)return;const{clientWidth:l,clientHeight:a}=i.parentElement;(l!==o.width||a!==o.height)&&t.set({width:l,height:a})},r=o=>{i=o,s(),window.addEventListener("resize",s)};return Qt?(pe(()=>{window.removeEventListener("resize",s)}),{parentSizeAction:r,parentSize:t}):{parentSize:t,parentSizeAction:r}};function Cn(t){let e;const n=t[30].default,i=Se(n,t,t[29],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[0]&536870912)&&be(i,n,s,s[29],e?Me(n,s[29],r,null):Re(s[29]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function ys(t){let e,n,i,s,r=t[1]&&Cn(t);return{c(){e=we("canvas"),r&&r.c(),this.h()},l(o){e=Te(o,"CANVAS",{class:!0});var l=Ae(e);r&&r.l(l),l.forEach(K),this.h()},h(){Ce(e,"class","svelte-15bl8wt")},m(o,l){Q(o,e,l),r&&r.m(e,null),t[31](e),n=!0,i||(s=[un(t[2].call(null,e)),Ue(e,"click",t[8]),Ue(e,"contextmenu",t[9]),Ue(e,"pointerup",t[12]),Ue(e,"pointerdown",t[10]),Ue(e,"pointermove",t[11]),Ue(e,"pointerenter",t[32]),Ue(e,"pointerleave",t[33])],i=!0)},p(o,l){o[1]?r?(r.p(o,l),l[0]&2&&B(r,1)):(r=Cn(o),r.c(),B(r,1),r.m(e,null)):r&&(Ht(),x(r,1,1,()=>{r=null}),zt())},i(o){n||(B(r),n=!0)},o(o){x(r),n=!1},d(o){o&&K(e),r&&r.d(),t[31](null),i=!1,Ri(s)}}}const Fn=new Set;function vs(t,e,n){let i,s,r,o,{$$slots:l={},$$scope:a}=e,{dpr:c=Qt?window.devicePixelRatio:1}=e,{flat:_=!1}=e,{linear:h=!1}=e,{frameloop:u="demand"}=e,{debugFrameloop:m=!1}=e,{shadows:A=!0}=e,{shadowMapType:f=Bi}=e,{size:d=void 0}=e,{rendererParameters:g=void 0}=e,p,w=!1;const S=ae(d),{parentSize:M,parentSizeAction:T}=Ms(),O=Rs(h,_,c,S,M,m,u),{getCtx:R,getRootCtx:v,getRenderCtx:I,renderCtx:y}=O,{ctx:U,rootCtx:E,audioCtx:L}=O;bs(U),Fn.add(U.invalidate),pe(()=>{Fn.delete(U.invalidate)});const{size:X,scene:ne}=U;W(t,X,V=>n(26,s=V));const{flat:D,linear:Z,dpr:F}=E;W(t,D,V=>n(27,r=V)),W(t,Z,V=>n(28,o=V)),W(t,F,V=>n(25,i=V)),ct("threlte-parent",ae(ne)),Gn(()=>{!p||(ds(U,p,g),vn(U,o,r),On(U,s,i),En(U,A,f),n(1,w=!0))}),As(U,E,y);const{onClick:C,onContextMenu:le,onPointerDown:ge,onPointerMove:de,onPointerUp:he}=_s(U,E,y);function P(V){fe[V?"unshift":"push"](()=>{p=V,n(0,p)})}const ie=()=>R().pointerOverCanvas.set(!0),Y=()=>R().pointerOverCanvas.set(!1);return t.$$set=V=>{"dpr"in V&&n(13,c=V.dpr),"flat"in V&&n(14,_=V.flat),"linear"in V&&n(15,h=V.linear),"frameloop"in V&&n(16,u=V.frameloop),"debugFrameloop"in V&&n(17,m=V.debugFrameloop),"shadows"in V&&n(18,A=V.shadows),"shadowMapType"in V&&n(19,f=V.shadowMapType),"size"in V&&n(20,d=V.size),"rendererParameters"in V&&n(21,g=V.rendererParameters),"$$scope"in V&&n(29,a=V.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1048576&&S.set(d),t.$$.dirty[0]&32768&&tt(Z,o=h,o),t.$$.dirty[0]&16384&&tt(D,r=_,r),t.$$.dirty[0]&8192&&tt(F,i=c,i),t.$$.dirty[0]&402653184&&vn(R(),o,r),t.$$.dirty[0]&100663296&&On(R(),s,i),t.$$.dirty[0]&786432&&En(R(),A,f)},[p,w,T,R,X,D,Z,F,C,le,ge,de,he,c,_,h,u,m,A,f,d,g,U,E,L,i,s,r,o,a,l,P,ie,Y]}class Os extends ee{constructor(e){super(),te(this,e,vs,ys,J,{dpr:13,flat:14,linear:15,frameloop:16,debugFrameloop:17,shadows:18,shadowMapType:19,size:20,rendererParameters:21,ctx:22,rootCtx:23,audioCtx:24},null,[-1,-1])}get ctx(){return this.$$.ctx[22]}get rootCtx(){return this.$$.ctx[23]}get audioCtx(){return this.$$.ctx[24]}}const Le=()=>St("threlte"),Zt=()=>St("threlte-root"),hn=t=>{const e=ae(t);let n=t;const i=e.subscribe(r=>n=r);return pe(i),{...e,set:r=>{r.uuid!==n.uuid&&e.set(r)}}};function Es(t){let e;const n=t[8].default,i=Se(n,t,t[7],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,[r]){i&&i.p&&(!e||r&128)&&be(i,n,s,s[7],e?Me(n,s[7],r,null):Re(s[7]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}const Cs=t=>{ct("threlte-parent",t)},ei=()=>St("threlte-parent");function Fs(t,e,n){let i,s,{$$slots:r={},$$scope:o}=e;const l=ei();W(t,l,m=>n(6,s=m));let a=s,{object:c}=e;const _=ae(c);W(t,_,m=>n(5,i=m));let h=c;Cs(_);const{invalidate:u}=Le();return s.add(i),u("HierarchicalObject: object added"),pe(()=>{s.remove(i),u("HierarchicalObject: object removed")}),t.$$set=m=>{"object"in m&&n(2,c=m.object),"$$scope"in m&&n(7,o=m.$$scope)},t.$$.update=()=>{t.$$.dirty&4&&tt(_,i=c,i),t.$$.dirty&112&&i!==h&&(h&&s.remove(h),s.add(i),u("HierarchicalObject: object changed"),n(4,h=i)),t.$$.dirty&104&&s!==a&&(a.remove(i),s.add(i),u("HierarchicalObject: parent changed"),n(3,a=s))},[l,_,c,a,h,i,s,o,r]}class ti extends ee{constructor(e){super(),te(this,e,Fs,Es,J,{object:2})}}function Ls(t,e,n){let i,s,{object:r}=e;const o=hn(r);W(t,o,c=>n(4,s=c));const l=St("threlte-layers");W(t,l,c=>n(3,i=c));const{invalidate:a}=Le();return t.$$set=c=>{"object"in c&&n(2,r=c.object)},t.$$.update=()=>{if(t.$$.dirty&4&&o.set(r),t.$$.dirty&24){if(i==="all")s.layers.enableAll();else if(i==="none")s.layers.disableAll();else if(Array.isArray(i))for(let c=0;c<32;c+=1){const _=c;i.includes(_)?s.layers.enable(c):s.layers.disable(c)}else i!==void 0&&s.layers.set(i);a("LayerableObject")}},[o,l,r,i,s]}class Ps extends ee{constructor(e){super(),te(this,e,Ls,null,J,{object:2})}}const Ot=(t,e)=>{var l;if(!Qt)return{start:()=>{},stop:()=>{},started:as(!1)};const n=St("threlte-render-context"),i={fn:t,order:e==null?void 0:e.order,debugFrameloopMessage:e==null?void 0:e.debugFrameloopMessage},s=ae(!1),r=()=>{n.frameHandlers.delete(i),s.set(!1)},o=()=>{n.frameHandlers.add(i),s.set(!0)};return((l=e==null?void 0:e.autostart)==null||l)&&o(),pe(()=>{r()}),{start:o,stop:r,started:{subscribe:s.subscribe}}},ni=()=>{const t=ae(!1);return(async()=>{await Kt(),t.set(!0)})(),t};function Bs(t,e,n){let i,s,{object:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e;const _=new q,h=bt(),{invalidate:u}=Le(),m=ni();W(t,m,w=>n(8,s=w));const A=async()=>{s||await Kt(),h("transform")},f=async()=>{u("TransformableObject: transformed"),await A()};Fe(r).onTransform=f;const{start:d,stop:g}=Ot(async()=>{c&&!a&&c instanceof Ge&&(c.getWorldPosition(_),r.lookAt(_),await A())},{autostart:!1,debugFrameloopMessage:"TransformableObject: tracking object"}),p=hn(r);return W(t,p,w=>n(7,i=w)),t.$$set=w=>{"object"in w&&n(2,r=w.object),"position"in w&&n(3,o=w.position),"scale"in w&&n(4,l=w.scale),"rotation"in w&&n(5,a=w.rotation),"lookAt"in w&&n(6,c=w.lookAt)},t.$$.update=()=>{var w,S,M,T,O,R,v,I,y,U,E,L,X;t.$$.dirty&4&&p.set(r),t.$$.dirty&232&&(o&&(i.position.set((w=o.x)!=null?w:0,(S=o.y)!=null?S:0,(M=o.z)!=null?M:0),f()),c&&!a&&(c instanceof Ge?d():(g(),i.lookAt((T=c.x)!=null?T:0,(O=c.y)!=null?O:0,(R=c.z)!=null?R:0),f())),c||g()),t.$$.dirty&144&&l&&(typeof l=="number"?i.scale.set(l,l,l):i.scale.set((v=l.x)!=null?v:1,(I=l.y)!=null?I:1,(y=l.z)!=null?y:1),f()),t.$$.dirty&160&&a&&(i.rotation.set((U=a.x)!=null?U:0,(E=a.y)!=null?E:0,(L=a.z)!=null?L:0,(X=a.order)!=null?X:"XYZ"),f())},[m,p,r,o,l,a,c,i]}class mn extends ee{constructor(e){super(),te(this,e,Bs,null,J,{object:2,position:3,scale:4,rotation:5,lookAt:6})}}function xs(t,e,n){let i,s,r,{object:o}=e,{viewportAware:l=!1}=e;const a=bt(),{camera:c,invalidate:_}=Le();W(t,c,T=>n(8,r=T));const h=new xi,u=new yt,m=T=>T.type==="Mesh",A=new q,f=()=>r?(u.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),h.setFromProjectionMatrix(u),m(o)?h.intersectsObject(o):(o.getWorldPosition(A),h.containsPoint(A))):!0,d=ni();W(t,d,T=>n(7,s=T));let{inViewport:g=f()}=e;const p=async T=>{T?(s||await Kt(),a("viewportenter",o)):(s||await Kt(),a("viewportleave",o))},{start:w,stop:S,started:M}=Ot(()=>{const T=f();g===void 0?(n(3,g=f()),p(g)):T!==g&&(p(T),n(3,g=T))},{autostart:l,debugFrameloopMessage:"ViewportAwareObject: tracking viewport visibility"});return W(t,M,T=>n(6,i=T)),_("ViewportAwareObject"),t.$$set=T=>{"object"in T&&n(4,o=T.object),"viewportAware"in T&&n(5,l=T.viewportAware),"inViewport"in T&&n(3,g=T.inViewport)},t.$$.update=()=>{t.$$.dirty&96&&(l&&!i?w():!l&&i&&S())},[c,d,M,g,o,l,i]}class Is extends ee{constructor(e){super(),te(this,e,xs,null,J,{object:4,viewportAware:5,inViewport:3})}}function Us(t){let e;const n=t[12].default,i=Se(n,t,t[16],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&65536)&&be(i,n,s,s[16],e?Me(n,s[16],r,null):Re(s[16]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function Ds(t){let e,n,i,s,r,o,l,a,c;e=new Ps({props:{object:t[1]}}),i=new mn({props:{object:t[1],position:t[2],rotation:t[4],scale:t[3],lookAt:t[5]}}),r=new ti({props:{object:t[1],$$slots:{default:[Us]},$$scope:{ctx:t}}});function _(u){t[13](u)}let h={object:t[1],viewportAware:t[6]};return t[0]!==void 0&&(h.inViewport=t[0]),l=new Is({props:h}),fe.push(()=>ye(l,"inViewport",_)),l.$on("viewportenter",t[14]),l.$on("viewportleave",t[15]),{c(){k(e.$$.fragment),n=re(),k(i.$$.fragment),s=re(),k(r.$$.fragment),o=re(),k(l.$$.fragment)},l(u){G(e.$$.fragment,u),n=oe(u),G(i.$$.fragment,u),s=oe(u),G(r.$$.fragment,u),o=oe(u),G(l.$$.fragment,u)},m(u,m){j(e,u,m),Q(u,n,m),j(i,u,m),Q(u,s,m),j(r,u,m),Q(u,o,m),j(l,u,m),c=!0},p(u,[m]){const A={};m&2&&(A.object=u[1]),e.$set(A);const f={};m&2&&(f.object=u[1]),m&4&&(f.position=u[2]),m&16&&(f.rotation=u[4]),m&8&&(f.scale=u[3]),m&32&&(f.lookAt=u[5]),i.$set(f);const d={};m&2&&(d.object=u[1]),m&65536&&(d.$$scope={dirty:m,ctx:u}),r.$set(d);const g={};m&2&&(g.object=u[1]),m&64&&(g.viewportAware=u[6]),!a&&m&1&&(a=!0,g.inViewport=u[0],ve(()=>a=!1)),l.$set(g)},i(u){c||(B(e.$$.fragment,u),B(i.$$.fragment,u),B(r.$$.fragment,u),B(l.$$.fragment,u),c=!0)},o(u){x(e.$$.fragment,u),x(i.$$.fragment,u),x(r.$$.fragment,u),x(l.$$.fragment,u),c=!1},d(u){H(e,u),u&&K(n),H(i,u),u&&K(s),H(r,u),u&&K(o),H(l,u)}}}function Ks(t,e,n){let{$$slots:i={},$$scope:s}=e,{object:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e,{viewportAware:_=!1}=e,{inViewport:h=!1}=e,{castShadow:u=void 0}=e,{receiveShadow:m=void 0}=e,{frustumCulled:A=void 0}=e,{renderOrder:f=void 0}=e,{visible:d=void 0}=e;const{invalidate:g}=Le(),p=()=>r;function w(T){h=T,n(0,h)}function S(T){N.call(this,t,T)}function M(T){N.call(this,t,T)}return t.$$set=T=>{"object"in T&&n(1,r=T.object),"position"in T&&n(2,o=T.position),"scale"in T&&n(3,l=T.scale),"rotation"in T&&n(4,a=T.rotation),"lookAt"in T&&n(5,c=T.lookAt),"viewportAware"in T&&n(6,_=T.viewportAware),"inViewport"in T&&n(0,h=T.inViewport),"castShadow"in T&&n(7,u=T.castShadow),"receiveShadow"in T&&n(8,m=T.receiveShadow),"frustumCulled"in T&&n(9,A=T.frustumCulled),"renderOrder"in T&&n(10,f=T.renderOrder),"visible"in T&&n(11,d=T.visible),"$$scope"in T&&n(16,s=T.$$scope)},t.$$.update=()=>{t.$$.dirty&3968&&(d!==void 0&&(p().visible=d),u!==void 0&&(p().castShadow=u),m!==void 0&&(p().receiveShadow=m),A!==void 0&&(p().frustumCulled=A),f!==void 0&&(p().renderOrder=f),g("Object3DInstance: props changed"))},[h,r,o,l,a,c,_,u,m,A,f,d,i,w,S,M,s]}class qt extends ee{constructor(e){super(),te(this,e,Ks,Ds,J,{object:1,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:0,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11})}}function Vs(t){let e;const n=t[15].default,i=Se(n,t,t[19],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&524288)&&be(i,n,s,s[19],e?Me(n,s[19],r,null):Re(s[19]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function Ns(t){let e,n,i;function s(o){t[16](o)}let r={object:t[1],lookAt:t[5],castShadow:t[7],receiveShadow:t[8],frustumCulled:t[9],renderOrder:t[10],position:t[2],scale:t[3],rotation:t[4],viewportAware:t[6],visible:t[11],$$slots:{default:[Vs]},$$scope:{ctx:t}};return t[0]!==void 0&&(r.inViewport=t[0]),e=new qt({props:r}),fe.push(()=>ye(e,"inViewport",s)),e.$on("viewportenter",t[17]),e.$on("viewportleave",t[18]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,[l]){const a={};l&2&&(a.object=o[1]),l&32&&(a.lookAt=o[5]),l&128&&(a.castShadow=o[7]),l&256&&(a.receiveShadow=o[8]),l&512&&(a.frustumCulled=o[9]),l&1024&&(a.renderOrder=o[10]),l&4&&(a.position=o[2]),l&8&&(a.scale=o[3]),l&16&&(a.rotation=o[4]),l&64&&(a.viewportAware=o[6]),l&2048&&(a.visible=o[11]),l&524288&&(a.$$scope={dirty:l,ctx:o}),!n&&l&1&&(n=!0,a.inViewport=o[0],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function ks(t,e,n){let i,{$$slots:s={},$$scope:r}=e,{camera:o}=e,{position:l=void 0}=e,{scale:a=void 0}=e,{rotation:c=void 0}=e,{lookAt:_=void 0}=e,{viewportAware:h=!1}=e,{inViewport:u=!1}=e,{castShadow:m=void 0}=e,{receiveShadow:A=void 0}=e,{frustumCulled:f=void 0}=e,{renderOrder:d=void 0}=e,{visible:g=void 0}=e,{useCamera:p=!1}=e;const w=hn(o);W(t,w,R=>n(14,i=R));const{setCamera:S}=Zt();function M(R){u=R,n(0,u)}function T(R){N.call(this,t,R)}function O(R){N.call(this,t,R)}return t.$$set=R=>{"camera"in R&&n(1,o=R.camera),"position"in R&&n(2,l=R.position),"scale"in R&&n(3,a=R.scale),"rotation"in R&&n(4,c=R.rotation),"lookAt"in R&&n(5,_=R.lookAt),"viewportAware"in R&&n(6,h=R.viewportAware),"inViewport"in R&&n(0,u=R.inViewport),"castShadow"in R&&n(7,m=R.castShadow),"receiveShadow"in R&&n(8,A=R.receiveShadow),"frustumCulled"in R&&n(9,f=R.frustumCulled),"renderOrder"in R&&n(10,d=R.renderOrder),"visible"in R&&n(11,g=R.visible),"useCamera"in R&&n(13,p=R.useCamera),"$$scope"in R&&n(19,r=R.$$scope)},t.$$.update=()=>{t.$$.dirty&2&&w.set(o),t.$$.dirty&24576&&p&&S(i)},[u,o,l,a,c,_,h,m,A,f,d,g,w,p,i,s,M,T,O,r]}class Gs extends ee{constructor(e){super(),te(this,e,ks,Ns,J,{camera:1,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:0,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11,useCamera:13})}}function js(t){let e;const n=t[18].default,i=Se(n,t,t[22],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&4194304)&&be(i,n,s,s[22],e?Me(n,s[22],r,null):Re(s[22]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function Hs(t){let e,n,i;function s(o){t[19](o)}let r={camera:t[0],position:t[2],scale:t[3],rotation:t[4],castShadow:t[6],receiveShadow:t[7],frustumCulled:t[8],renderOrder:t[9],visible:t[10],viewportAware:t[11],lookAt:t[5],useCamera:t[12],$$slots:{default:[js]},$$scope:{ctx:t}};return t[1]!==void 0&&(r.inViewport=t[1]),e=new Gs({props:r}),fe.push(()=>ye(e,"inViewport",s)),e.$on("viewportenter",t[20]),e.$on("viewportleave",t[21]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,[l]){const a={};l&1&&(a.camera=o[0]),l&4&&(a.position=o[2]),l&8&&(a.scale=o[3]),l&16&&(a.rotation=o[4]),l&64&&(a.castShadow=o[6]),l&128&&(a.receiveShadow=o[7]),l&256&&(a.frustumCulled=o[8]),l&512&&(a.renderOrder=o[9]),l&1024&&(a.visible=o[10]),l&2048&&(a.viewportAware=o[11]),l&32&&(a.lookAt=o[5]),l&4096&&(a.useCamera=o[12]),l&4194304&&(a.$$scope={dirty:l,ctx:o}),!n&&l&2&&(n=!0,a.inViewport=o[1],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function zs(t,e,n){let i,{$$slots:s={},$$scope:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e,{castShadow:_=void 0}=e,{receiveShadow:h=void 0}=e,{frustumCulled:u=void 0}=e,{renderOrder:m=void 0}=e,{visible:A=void 0}=e,{viewportAware:f=!1}=e,{inViewport:d=!1}=e,{useCamera:g=!0}=e,{near:p=void 0}=e,{far:w=void 0}=e,{fov:S=void 0}=e;const{size:M,invalidate:T}=Le();W(t,M,y=>n(17,i=y));const O=new Mt(S,i.width/i.height,p,w);function R(y){d=y,n(1,d)}function v(y){N.call(this,t,y)}function I(y){N.call(this,t,y)}return t.$$set=y=>{"position"in y&&n(2,o=y.position),"scale"in y&&n(3,l=y.scale),"rotation"in y&&n(4,a=y.rotation),"lookAt"in y&&n(5,c=y.lookAt),"castShadow"in y&&n(6,_=y.castShadow),"receiveShadow"in y&&n(7,h=y.receiveShadow),"frustumCulled"in y&&n(8,u=y.frustumCulled),"renderOrder"in y&&n(9,m=y.renderOrder),"visible"in y&&n(10,A=y.visible),"viewportAware"in y&&n(11,f=y.viewportAware),"inViewport"in y&&n(1,d=y.inViewport),"useCamera"in y&&n(12,g=y.useCamera),"near"in y&&n(14,p=y.near),"far"in y&&n(15,w=y.far),"fov"in y&&n(16,S=y.fov),"$$scope"in y&&n(22,r=y.$$scope)},t.$$.update=()=>{t.$$.dirty&131073&&(n(0,O.aspect=i.width/i.height,O),O.updateProjectionMatrix(),T("PerspectiveCamera: aspect changed")),t.$$.dirty&114689&&(p!==void 0&&n(0,O.near=p,O),w!==void 0&&n(0,O.far=w,O),S!==void 0&&n(0,O.fov=S,O),O.updateProjectionMatrix(),T("PerspectiveCamera: props changed"))},[O,d,o,l,a,c,_,h,u,m,A,f,g,M,p,w,S,i,s,R,v,I,r]}class Xs extends ee{constructor(e){super(),te(this,e,zs,Hs,J,{position:2,scale:3,rotation:4,lookAt:5,castShadow:6,receiveShadow:7,frustumCulled:8,renderOrder:9,visible:10,viewportAware:11,inViewport:1,useCamera:12,near:14,far:15,fov:16,camera:0})}get camera(){return this.$$.ctx[0]}}const Ln=[],Ws=(t,e)=>{const n=Ln.find(s=>s instanceof t);if(n)return n;const i=e();return Ln.push(i),i};function Ys(t){let e,n;return e=new mn({props:{object:t[2],position:t[0]}}),e.$on("transform",t[3]),{c(){k(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,s){j(e,i,s),n=!0},p(i,s){const r={};s[0]&1&&(r.position=i[0]),e.$set(r)},i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){x(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Qs(t,e,n){let i,{autoRotate:s=void 0}=e,{autoRotateSpeed:r=void 0}=e,{dampingFactor:o=void 0}=e,{enableDamping:l=void 0}=e,{enabled:a=void 0}=e,{enablePan:c=void 0}=e,{enableRotate:_=void 0}=e,{enableZoom:h=void 0}=e,{keyPanSpeed:u=void 0}=e,{keys:m=void 0}=e,{maxAzimuthAngle:A=void 0}=e,{maxDistance:f=void 0}=e,{maxPolarAngle:d=void 0}=e,{maxZoom:g=void 0}=e,{minAzimuthAngle:p=void 0}=e,{minDistance:w=void 0}=e,{minPolarAngle:S=void 0}=e,{minZoom:M=void 0}=e,{mouseButtons:T=void 0}=e,{panSpeed:O=void 0}=e,{rotateSpeed:R=void 0}=e,{screenSpacePanning:v=void 0}=e,{touches:I=void 0}=e,{zoomSpeed:y=void 0}=e,{target:U=void 0}=e;const E=ei();W(t,E,P=>n(29,i=P));const{renderer:L,invalidate:X}=Le();if(!L)throw new Error("Threlte Context missing: Is <OrbitControls> a child of <Canvas>?");if(!(i instanceof Ii))throw new Error("Parent missing: <OrbitControls> need to be a child of a <Camera>");const ne=bt(),D=()=>{X("Orbitcontrols: change event"),ne("change")},Z=()=>ne("start"),F=()=>ne("end"),C=new Ui(i,L.domElement);Fe(i).orbitControls=C,C.addEventListener("change",D),C.addEventListener("start",Z),C.addEventListener("end",F),pe(()=>{delete Fe(i).orbitControls,C.removeEventListener("change",D),C.removeEventListener("start",Z),C.removeEventListener("end",F)});const{start:le,stop:ge}=Ot(()=>C.update(),{autostart:!1,debugFrameloopMessage:"OrbitControlts: updating controls"}),de=new Ge,he=()=>{n(4,C.target=de.position,C),C.update(),X("OrbitControls: target changed")};return pe(()=>{C.dispose(),X("OrbitControls: onDestroy")}),t.$$set=P=>{"autoRotate"in P&&n(5,s=P.autoRotate),"autoRotateSpeed"in P&&n(6,r=P.autoRotateSpeed),"dampingFactor"in P&&n(7,o=P.dampingFactor),"enableDamping"in P&&n(8,l=P.enableDamping),"enabled"in P&&n(9,a=P.enabled),"enablePan"in P&&n(10,c=P.enablePan),"enableRotate"in P&&n(11,_=P.enableRotate),"enableZoom"in P&&n(12,h=P.enableZoom),"keyPanSpeed"in P&&n(13,u=P.keyPanSpeed),"keys"in P&&n(14,m=P.keys),"maxAzimuthAngle"in P&&n(15,A=P.maxAzimuthAngle),"maxDistance"in P&&n(16,f=P.maxDistance),"maxPolarAngle"in P&&n(17,d=P.maxPolarAngle),"maxZoom"in P&&n(18,g=P.maxZoom),"minAzimuthAngle"in P&&n(19,p=P.minAzimuthAngle),"minDistance"in P&&n(20,w=P.minDistance),"minPolarAngle"in P&&n(21,S=P.minPolarAngle),"minZoom"in P&&n(22,M=P.minZoom),"mouseButtons"in P&&n(23,T=P.mouseButtons),"panSpeed"in P&&n(24,O=P.panSpeed),"rotateSpeed"in P&&n(25,R=P.rotateSpeed),"screenSpacePanning"in P&&n(26,v=P.screenSpacePanning),"touches"in P&&n(27,I=P.touches),"zoomSpeed"in P&&n(28,y=P.zoomSpeed),"target"in P&&n(0,U=P.target)},t.$$.update=()=>{t.$$.dirty[0]&536870896&&(s!==void 0&&n(4,C.autoRotate=s,C),r!==void 0&&n(4,C.autoRotateSpeed=r,C),o!==void 0&&n(4,C.dampingFactor=o,C),l!==void 0&&n(4,C.enableDamping=l,C),a!==void 0&&n(4,C.enabled=a,C),c!==void 0&&n(4,C.enablePan=c,C),_!==void 0&&n(4,C.enableRotate=_,C),h!==void 0&&n(4,C.enableZoom=h,C),u!==void 0&&n(4,C.keyPanSpeed=u,C),m!==void 0&&n(4,C.keys=m,C),A!==void 0&&n(4,C.maxAzimuthAngle=A,C),f!==void 0&&n(4,C.maxDistance=f,C),d!==void 0&&n(4,C.maxPolarAngle=d,C),g!==void 0&&n(4,C.maxZoom=g,C),p!==void 0&&n(4,C.minAzimuthAngle=p,C),w!==void 0&&n(4,C.minDistance=w,C),S!==void 0&&n(4,C.minPolarAngle=S,C),M!==void 0&&n(4,C.minZoom=M,C),T!==void 0&&n(4,C.mouseButtons=T,C),O!==void 0&&n(4,C.panSpeed=O,C),R!==void 0&&n(4,C.rotateSpeed=R,C),v!==void 0&&n(4,C.screenSpacePanning=v,C),I!==void 0&&n(4,C.touches=I,C),y!==void 0&&n(4,C.zoomSpeed=y,C),C.update(),X("OrbitControls: props changed")),t.$$.dirty[0]&288&&(s||l?le():ge())},[U,E,de,he,C,s,r,o,l,a,c,_,h,u,m,A,f,d,g,p,w,S,M,T,O,R,v,I,y]}class Zs extends ee{constructor(e){super(),te(this,e,Qs,Ys,J,{autoRotate:5,autoRotateSpeed:6,dampingFactor:7,enableDamping:8,enabled:9,enablePan:10,enableRotate:11,enableZoom:12,keyPanSpeed:13,keys:14,maxAzimuthAngle:15,maxDistance:16,maxPolarAngle:17,maxZoom:18,minAzimuthAngle:19,minDistance:20,minPolarAngle:21,minZoom:22,mouseButtons:23,panSpeed:24,rotateSpeed:25,screenSpacePanning:26,touches:27,zoomSpeed:28,target:0,controls:4},null,[-1,-1])}get controls(){return this.$$.ctx[4]}}const Hf=new Yn,zf=new q,Xf=new q,Wf=new Wt,Yf={X:new q(1,0,0),Y:new q(0,1,0),Z:new q(0,0,1)};const Qf=new Di,Zf=new q(0,1,0),qf=new q(0,0,0),Jf=new yt,$f=new Wt,ed=new Wt,td=new q,nd=new yt,id=new q(1,0,0),sd=new q(0,1,0),rd=new q(0,0,1),od=new q,ad=new q,ld=new q;const qs=(t,e)=>e?new Ne(t):new Ne().setHex(new Ne(t).getHex()).convertSRGBToLinear();function Js(t){let e;const n=t[16].default,i=Se(n,t,t[20],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&1048576)&&be(i,n,s,s[20],e?Me(n,s[20],r,null):Re(s[20]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function $s(t){let e,n,i;function s(o){t[17](o)}let r={object:t[0],lookAt:t[5],castShadow:t[7],receiveShadow:t[8],frustumCulled:t[9],renderOrder:t[10],position:t[2],scale:t[3],rotation:t[4],viewportAware:t[6],visible:t[11],$$slots:{default:[Js]},$$scope:{ctx:t}};return t[1]!==void 0&&(r.inViewport=t[1]),e=new qt({props:r}),fe.push(()=>ye(e,"inViewport",s)),e.$on("viewportenter",t[18]),e.$on("viewportleave",t[19]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,[l]){const a={};l&1&&(a.object=o[0]),l&32&&(a.lookAt=o[5]),l&128&&(a.castShadow=o[7]),l&256&&(a.receiveShadow=o[8]),l&512&&(a.frustumCulled=o[9]),l&1024&&(a.renderOrder=o[10]),l&4&&(a.position=o[2]),l&8&&(a.scale=o[3]),l&16&&(a.rotation=o[4]),l&64&&(a.viewportAware=o[6]),l&2048&&(a.visible=o[11]),l&1048576&&(a.$$scope={dirty:l,ctx:o}),!n&&l&2&&(n=!0,a.inViewport=o[1],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function er(t,e,n){let i,{$$slots:s={},$$scope:r}=e,{light:o}=e,{position:l=void 0}=e,{scale:a=void 0}=e,{rotation:c=void 0}=e,{lookAt:_=void 0}=e,{viewportAware:h=!1}=e,{inViewport:u=!1}=e,{castShadow:m=void 0}=e,{receiveShadow:A=void 0}=e,{frustumCulled:f=void 0}=e,{renderOrder:d=void 0}=e,{visible:g=void 0}=e,{color:p=void 0}=e,{intensity:w=void 0}=e;const{invalidate:S}=Le(),{linear:M}=Zt();W(t,M,v=>n(15,i=v));function T(v){u=v,n(1,u)}function O(v){N.call(this,t,v)}function R(v){N.call(this,t,v)}return t.$$set=v=>{"light"in v&&n(0,o=v.light),"position"in v&&n(2,l=v.position),"scale"in v&&n(3,a=v.scale),"rotation"in v&&n(4,c=v.rotation),"lookAt"in v&&n(5,_=v.lookAt),"viewportAware"in v&&n(6,h=v.viewportAware),"inViewport"in v&&n(1,u=v.inViewport),"castShadow"in v&&n(7,m=v.castShadow),"receiveShadow"in v&&n(8,A=v.receiveShadow),"frustumCulled"in v&&n(9,f=v.frustumCulled),"renderOrder"in v&&n(10,d=v.renderOrder),"visible"in v&&n(11,g=v.visible),"color"in v&&n(13,p=v.color),"intensity"in v&&n(14,w=v.intensity),"$$scope"in v&&n(20,r=v.$$scope)},t.$$.update=()=>{t.$$.dirty&57344&&(w!==void 0&&n(0,o.intensity=w,o),p!==void 0&&n(0,o.color=qs(p,i),o),S("LightInstance: props changed"))},[o,u,l,a,c,_,h,m,A,f,d,g,M,p,w,i,s,T,O,R,r]}class ii extends ee{constructor(e){super(),te(this,e,er,$s,J,{light:0,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:1,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11,color:13,intensity:14})}}function tr(t){let e;const n=t[14].default,i=Se(n,t,t[18],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&262144)&&be(i,n,s,s[18],e?Me(n,s[18],r,null):Re(s[18]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function nr(t){let e,n,i;function s(o){t[15](o)}let r={light:t[13],lookAt:t[4],position:t[1],scale:t[2],rotation:t[3],castShadow:t[5],receiveShadow:t[6],frustumCulled:t[7],renderOrder:t[8],visible:t[9],viewportAware:t[10],color:t[11],intensity:t[12],$$slots:{default:[tr]},$$scope:{ctx:t}};return t[0]!==void 0&&(r.inViewport=t[0]),e=new ii({props:r}),fe.push(()=>ye(e,"inViewport",s)),e.$on("viewportenter",t[16]),e.$on("viewportleave",t[17]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,[l]){const a={};l&16&&(a.lookAt=o[4]),l&2&&(a.position=o[1]),l&4&&(a.scale=o[2]),l&8&&(a.rotation=o[3]),l&32&&(a.castShadow=o[5]),l&64&&(a.receiveShadow=o[6]),l&128&&(a.frustumCulled=o[7]),l&256&&(a.renderOrder=o[8]),l&512&&(a.visible=o[9]),l&1024&&(a.viewportAware=o[10]),l&2048&&(a.color=o[11]),l&4096&&(a.intensity=o[12]),l&262144&&(a.$$scope={dirty:l,ctx:o}),!n&&l&1&&(n=!0,a.inViewport=o[0],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function ir(t,e,n){let{$$slots:i={},$$scope:s}=e,{position:r=void 0}=e,{scale:o=void 0}=e,{rotation:l=void 0}=e,{lookAt:a=void 0}=e,{castShadow:c=void 0}=e,{receiveShadow:_=void 0}=e,{frustumCulled:h=void 0}=e,{renderOrder:u=void 0}=e,{visible:m=void 0}=e,{viewportAware:A=!1}=e,{inViewport:f=!1}=e,{color:d=void 0}=e,{intensity:g=void 0}=e;const p=new Ni(d,g);function w(T){f=T,n(0,f)}function S(T){N.call(this,t,T)}function M(T){N.call(this,t,T)}return t.$$set=T=>{"position"in T&&n(1,r=T.position),"scale"in T&&n(2,o=T.scale),"rotation"in T&&n(3,l=T.rotation),"lookAt"in T&&n(4,a=T.lookAt),"castShadow"in T&&n(5,c=T.castShadow),"receiveShadow"in T&&n(6,_=T.receiveShadow),"frustumCulled"in T&&n(7,h=T.frustumCulled),"renderOrder"in T&&n(8,u=T.renderOrder),"visible"in T&&n(9,m=T.visible),"viewportAware"in T&&n(10,A=T.viewportAware),"inViewport"in T&&n(0,f=T.inViewport),"color"in T&&n(11,d=T.color),"intensity"in T&&n(12,g=T.intensity),"$$scope"in T&&n(18,s=T.$$scope)},[f,r,o,l,a,c,_,h,u,m,A,d,g,p,i,w,S,M,s]}class sr extends ee{constructor(e){super(),te(this,e,ir,nr,J,{position:1,scale:2,rotation:3,lookAt:4,castShadow:5,receiveShadow:6,frustumCulled:7,renderOrder:8,visible:9,viewportAware:10,inViewport:0,color:11,intensity:12,light:13})}get light(){return this.$$.ctx[13]}}function Pn(t){let e,n,i,s;return e=new ti({props:{object:t[14]}}),i=new mn({props:{object:t[14],position:t[13]}}),{c(){k(e.$$.fragment),n=re(),k(i.$$.fragment)},l(r){G(e.$$.fragment,r),n=oe(r),G(i.$$.fragment,r)},m(r,o){j(e,r,o),Q(r,n,o),j(i,r,o),s=!0},p(r,o){const l={};o&8192&&(l.position=r[13]),i.$set(l)},i(r){s||(B(e.$$.fragment,r),B(i.$$.fragment,r),s=!0)},o(r){x(e.$$.fragment,r),x(i.$$.fragment,r),s=!1},d(r){H(e,r),r&&K(n),H(i,r)}}}function rr(t){let e;const n=t[16].default,i=Se(n,t,t[20],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&1048576)&&be(i,n,s,s[20],e?Me(n,s[20],r,null):Re(s[20]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function or(t){let e,n,i,s,r=t[13]&&!(t[13]instanceof Ge)&&Pn(t);function o(a){t[17](a)}let l={light:t[1],position:t[2],scale:t[3],rotation:t[4],castShadow:!!t[12],receiveShadow:t[5],frustumCulled:t[6],renderOrder:t[7],visible:t[8],viewportAware:t[9],color:t[10],intensity:t[11],$$slots:{default:[rr]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.inViewport=t[0]),n=new ii({props:l}),fe.push(()=>ye(n,"inViewport",o)),n.$on("viewportenter",t[18]),n.$on("viewportleave",t[19]),{c(){r&&r.c(),e=re(),k(n.$$.fragment)},l(a){r&&r.l(a),e=oe(a),G(n.$$.fragment,a)},m(a,c){r&&r.m(a,c),Q(a,e,c),j(n,a,c),s=!0},p(a,[c]){a[13]&&!(a[13]instanceof Ge)?r?(r.p(a,c),c&8192&&B(r,1)):(r=Pn(a),r.c(),B(r,1),r.m(e.parentNode,e)):r&&(Ht(),x(r,1,1,()=>{r=null}),zt());const _={};c&2&&(_.light=a[1]),c&4&&(_.position=a[2]),c&8&&(_.scale=a[3]),c&16&&(_.rotation=a[4]),c&4096&&(_.castShadow=!!a[12]),c&32&&(_.receiveShadow=a[5]),c&64&&(_.frustumCulled=a[6]),c&128&&(_.renderOrder=a[7]),c&256&&(_.visible=a[8]),c&512&&(_.viewportAware=a[9]),c&1024&&(_.color=a[10]),c&2048&&(_.intensity=a[11]),c&1048576&&(_.$$scope={dirty:c,ctx:a}),!i&&c&1&&(i=!0,_.inViewport=a[0],ve(()=>i=!1)),n.$set(_)},i(a){s||(B(r),B(n.$$.fragment,a),s=!0)},o(a){x(r),x(n.$$.fragment,a),s=!1},d(a){r&&r.d(a),a&&K(e),H(n,a)}}}function ar(t,e,n){let i,{$$slots:s={},$$scope:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{receiveShadow:c=void 0}=e,{frustumCulled:_=void 0}=e,{renderOrder:h=void 0}=e,{visible:u=void 0}=e,{viewportAware:m=!1}=e,{inViewport:A=!1}=e,{color:f=void 0}=e,{intensity:d=void 0}=e,{shadow:g=void 0}=e,{target:p=void 0}=e;const w=new ki(f,d),{invalidate:S}=Le(),M=w.target,{start:T,stop:O,started:R}=Ot(()=>{},{autostart:!1,debugFrameloopMessage:"DirectionalLight: tracking target"});W(t,R,L=>n(21,i=L));const v=L=>{L&&L instanceof Ge&&!i?(n(1,w.target=L,w),T(),S("DirectionalLight: target changed")):(!L||!(L instanceof Ge))&&i&&(n(1,w.target=M,w),O(),S("DirectionalLight: target changed"))},I=L=>{if(L){const{mapSize:X=[512,512],camera:{left:ne=-5,bottom:D=-5,right:Z=5,top:F=5,near:C=.5,far:le=500}={},bias:ge=0,radius:de=1}=L===!0?{}:L;w.shadow.mapSize.set(X[0],X[1]),n(1,w.shadow.camera.left=ne,w),n(1,w.shadow.camera.top=F,w),n(1,w.shadow.camera.right=Z,w),n(1,w.shadow.camera.bottom=D,w),n(1,w.shadow.camera.near=C,w),n(1,w.shadow.camera.far=le,w),n(1,w.shadow.bias=ge,w),n(1,w.shadow.radius=de,w)}S("DirectionalLight: shadow changed")};function y(L){A=L,n(0,A)}function U(L){N.call(this,t,L)}function E(L){N.call(this,t,L)}return t.$$set=L=>{"position"in L&&n(2,o=L.position),"scale"in L&&n(3,l=L.scale),"rotation"in L&&n(4,a=L.rotation),"receiveShadow"in L&&n(5,c=L.receiveShadow),"frustumCulled"in L&&n(6,_=L.frustumCulled),"renderOrder"in L&&n(7,h=L.renderOrder),"visible"in L&&n(8,u=L.visible),"viewportAware"in L&&n(9,m=L.viewportAware),"inViewport"in L&&n(0,A=L.inViewport),"color"in L&&n(10,f=L.color),"intensity"in L&&n(11,d=L.intensity),"shadow"in L&&n(12,g=L.shadow),"target"in L&&n(13,p=L.target),"$$scope"in L&&n(20,r=L.$$scope)},t.$$.update=()=>{t.$$.dirty&8192&&v(p),t.$$.dirty&4096&&I(g)},[A,w,o,l,a,c,_,h,u,m,f,d,g,p,M,R,s,y,U,E,r]}class lr extends ee{constructor(e){super(),te(this,e,ar,or,J,{position:2,scale:3,rotation:4,receiveShadow:5,frustumCulled:6,renderOrder:7,visible:8,viewportAware:9,inViewport:0,color:10,intensity:11,shadow:12,target:13,light:1})}get light(){return this.$$.ctx[1]}}function cr(t,e,n){let{object:i}=e,s=i,{interactive:r=!1}=e,{ignorePointer:o=!1}=e;const l=bt(),{addInteractiveObject:a,removeInteractiveObject:c,addRaycastableObject:_,removeRaycastableObject:h}=Zt(),{invalidate:u}=Le(),m=f=>{h(f),c(f),delete Fe(f).eventDispatcher},A=(f,d,g)=>{Fe(f).eventDispatcher=l,d?(h(f),c(f)):(_(f),g?a(f):c(f))};return pe(()=>{m(i),u("InteractiveObject: object removed")}),t.$$set=f=>{"object"in f&&n(0,i=f.object),"interactive"in f&&n(1,r=f.interactive),"ignorePointer"in f&&n(2,o=f.ignorePointer)},t.$$.update=()=>{t.$$.dirty&15&&(i!==s?(m(s),A(i,o,r),u("InteractiveObject: object changed"),n(3,s=i)):i===s&&(A(i,o,r),u("InteractiveObject: props changed")))},[i,r,o,s]}class ur extends ee{constructor(e){super(),te(this,e,cr,null,J,{object:0,interactive:1,ignorePointer:2})}}function fr(t){let e;const n=t[14].default,i=Se(n,t,t[25],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&33554432)&&be(i,n,s,s[25],e?Me(n,s[25],r,null):Re(s[25]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function dr(t){let e,n,i,s,r;function o(a){t[15](a)}let l={object:t[1],lookAt:t[5],position:t[2],scale:t[3],rotation:t[4],castShadow:t[7],receiveShadow:t[8],frustumCulled:t[9],renderOrder:t[10],visible:t[11],viewportAware:t[6],$$slots:{default:[fr]},$$scope:{ctx:t}};return t[0]!==void 0&&(l.inViewport=t[0]),e=new qt({props:l}),fe.push(()=>ye(e,"inViewport",o)),e.$on("viewportenter",t[16]),e.$on("viewportleave",t[17]),s=new ur({props:{object:t[1],interactive:t[12],ignorePointer:t[13]}}),s.$on("click",t[18]),s.$on("contextmenu",t[19]),s.$on("pointerup",t[20]),s.$on("pointerdown",t[21]),s.$on("pointerenter",t[22]),s.$on("pointerleave",t[23]),s.$on("pointermove",t[24]),{c(){k(e.$$.fragment),i=re(),k(s.$$.fragment)},l(a){G(e.$$.fragment,a),i=oe(a),G(s.$$.fragment,a)},m(a,c){j(e,a,c),Q(a,i,c),j(s,a,c),r=!0},p(a,[c]){const _={};c&2&&(_.object=a[1]),c&32&&(_.lookAt=a[5]),c&4&&(_.position=a[2]),c&8&&(_.scale=a[3]),c&16&&(_.rotation=a[4]),c&128&&(_.castShadow=a[7]),c&256&&(_.receiveShadow=a[8]),c&512&&(_.frustumCulled=a[9]),c&1024&&(_.renderOrder=a[10]),c&2048&&(_.visible=a[11]),c&64&&(_.viewportAware=a[6]),c&33554432&&(_.$$scope={dirty:c,ctx:a}),!n&&c&1&&(n=!0,_.inViewport=a[0],ve(()=>n=!1)),e.$set(_);const h={};c&2&&(h.object=a[1]),c&4096&&(h.interactive=a[12]),c&8192&&(h.ignorePointer=a[13]),s.$set(h)},i(a){r||(B(e.$$.fragment,a),B(s.$$.fragment,a),r=!0)},o(a){x(e.$$.fragment,a),x(s.$$.fragment,a),r=!1},d(a){H(e,a),a&&K(i),H(s,a)}}}function hr(t,e,n){let{$$slots:i={},$$scope:s}=e,{mesh:r}=e,{position:o=void 0}=e,{scale:l=void 0}=e,{rotation:a=void 0}=e,{lookAt:c=void 0}=e,{viewportAware:_=!1}=e,{inViewport:h=!1}=e,{castShadow:u=void 0}=e,{receiveShadow:m=void 0}=e,{frustumCulled:A=void 0}=e,{renderOrder:f=void 0}=e,{visible:d=void 0}=e,{interactive:g=!1}=e,{ignorePointer:p=!1}=e;function w(E){h=E,n(0,h)}function S(E){N.call(this,t,E)}function M(E){N.call(this,t,E)}function T(E){N.call(this,t,E)}function O(E){N.call(this,t,E)}function R(E){N.call(this,t,E)}function v(E){N.call(this,t,E)}function I(E){N.call(this,t,E)}function y(E){N.call(this,t,E)}function U(E){N.call(this,t,E)}return t.$$set=E=>{"mesh"in E&&n(1,r=E.mesh),"position"in E&&n(2,o=E.position),"scale"in E&&n(3,l=E.scale),"rotation"in E&&n(4,a=E.rotation),"lookAt"in E&&n(5,c=E.lookAt),"viewportAware"in E&&n(6,_=E.viewportAware),"inViewport"in E&&n(0,h=E.inViewport),"castShadow"in E&&n(7,u=E.castShadow),"receiveShadow"in E&&n(8,m=E.receiveShadow),"frustumCulled"in E&&n(9,A=E.frustumCulled),"renderOrder"in E&&n(10,f=E.renderOrder),"visible"in E&&n(11,d=E.visible),"interactive"in E&&n(12,g=E.interactive),"ignorePointer"in E&&n(13,p=E.ignorePointer),"$$scope"in E&&n(25,s=E.$$scope)},[h,r,o,l,a,c,_,u,m,A,f,d,g,p,i,w,S,M,T,O,R,v,I,y,U,s]}class mr extends ee{constructor(e){super(),te(this,e,hr,dr,J,{mesh:1,position:2,scale:3,rotation:4,lookAt:5,viewportAware:6,inViewport:0,castShadow:7,receiveShadow:8,frustumCulled:9,renderOrder:10,visible:11,interactive:12,ignorePointer:13})}}function _r(t){let e;const n=t[18].default,i=Se(n,t,t[29],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[0]&536870912)&&be(i,n,s,s[29],e?Me(n,s[29],r,null):Re(s[29]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function pr(t){let e,n,i;function s(o){t[19](o)}let r={mesh:t[13],position:t[1],scale:t[2],rotation:t[3],lookAt:t[12],castShadow:t[5],receiveShadow:t[6],frustumCulled:t[7],renderOrder:t[8],visible:t[9],interactive:t[10],ignorePointer:t[11],viewportAware:t[4],$$slots:{default:[_r]},$$scope:{ctx:t}};return t[0]!==void 0&&(r.inViewport=t[0]),e=new mr({props:r}),fe.push(()=>ye(e,"inViewport",s)),e.$on("click",t[20]),e.$on("contextmenu",t[21]),e.$on("pointerup",t[22]),e.$on("pointerdown",t[23]),e.$on("pointerenter",t[24]),e.$on("pointerleave",t[25]),e.$on("pointermove",t[26]),e.$on("viewportenter",t[27]),e.$on("viewportleave",t[28]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,l){const a={};l[0]&2&&(a.position=o[1]),l[0]&4&&(a.scale=o[2]),l[0]&8&&(a.rotation=o[3]),l[0]&4096&&(a.lookAt=o[12]),l[0]&32&&(a.castShadow=o[5]),l[0]&64&&(a.receiveShadow=o[6]),l[0]&128&&(a.frustumCulled=o[7]),l[0]&256&&(a.renderOrder=o[8]),l[0]&512&&(a.visible=o[9]),l[0]&1024&&(a.interactive=o[10]),l[0]&2048&&(a.ignorePointer=o[11]),l[0]&16&&(a.viewportAware=o[4]),l[0]&536870912&&(a.$$scope={dirty:l,ctx:o}),!n&&l[0]&1&&(n=!0,a.inViewport=o[0],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function gr(t,e,n){let{$$slots:i={},$$scope:s}=e,{position:r=void 0}=e,{scale:o=void 0}=e,{rotation:l=void 0}=e,{viewportAware:a=!1}=e,{inViewport:c=!1}=e,{castShadow:_=void 0}=e,{receiveShadow:h=void 0}=e,{frustumCulled:u=void 0}=e,{renderOrder:m=void 0}=e,{visible:A=void 0}=e,{interactive:f=!1}=e,{ignorePointer:d=!1}=e,{lookAt:g=void 0}=e,{geometry:p}=e,{material:w}=e,S=w,M=p;const{invalidate:T}=Le(),O=new Xn(p,w),R=()=>O;function v(F){c=F,n(0,c)}function I(F){N.call(this,t,F)}function y(F){N.call(this,t,F)}function U(F){N.call(this,t,F)}function E(F){N.call(this,t,F)}function L(F){N.call(this,t,F)}function X(F){N.call(this,t,F)}function ne(F){N.call(this,t,F)}function D(F){N.call(this,t,F)}function Z(F){N.call(this,t,F)}return t.$$set=F=>{"position"in F&&n(1,r=F.position),"scale"in F&&n(2,o=F.scale),"rotation"in F&&n(3,l=F.rotation),"viewportAware"in F&&n(4,a=F.viewportAware),"inViewport"in F&&n(0,c=F.inViewport),"castShadow"in F&&n(5,_=F.castShadow),"receiveShadow"in F&&n(6,h=F.receiveShadow),"frustumCulled"in F&&n(7,u=F.frustumCulled),"renderOrder"in F&&n(8,m=F.renderOrder),"visible"in F&&n(9,A=F.visible),"interactive"in F&&n(10,f=F.interactive),"ignorePointer"in F&&n(11,d=F.ignorePointer),"lookAt"in F&&n(12,g=F.lookAt),"geometry"in F&&n(14,p=F.geometry),"material"in F&&n(15,w=F.material),"$$scope"in F&&n(29,s=F.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&98304&&(w!==S?(R().material=w,T("Mesh: material changed")):T("Mesh: material props changed"),n(16,S=w)),t.$$.dirty[0]&147456&&(p!==M?(R().geometry=p,T("Mesh: geometry changed")):T("Mesh: geometry props changed"),n(17,M=p))},[c,r,o,l,a,_,h,u,m,A,f,d,g,O,p,w,S,M,i,v,I,y,U,E,L,X,ne,D,Z,s]}class At extends ee{constructor(e){super(),te(this,e,gr,pr,J,{position:1,scale:2,rotation:3,viewportAware:4,inViewport:0,castShadow:5,receiveShadow:6,frustumCulled:7,renderOrder:8,visible:9,interactive:10,ignorePointer:11,lookAt:12,geometry:14,material:15,mesh:13},null,[-1,-1])}get mesh(){return this.$$.ctx[13]}}const si=new Ge;si.scale.set(0,0,0);si.matrix;new yt().fromArray(new Array(16).fill(0));new Ne(16777215);function wr(t){let e;const n=t[12].default,i=Se(n,t,t[16],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&65536)&&be(i,n,s,s[16],e?Me(n,s[16],r,null):Re(s[16]),null)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function Tr(t){let e,n,i;function s(o){t[13](o)}let r={object:t[11],position:t[1],scale:t[2],rotation:t[3],lookAt:t[4],frustumCulled:t[8],renderOrder:t[9],visible:t[10],castShadow:t[6],receiveShadow:t[7],viewportAware:t[5],$$slots:{default:[wr]},$$scope:{ctx:t}};return t[0]!==void 0&&(r.inViewport=t[0]),e=new qt({props:r}),fe.push(()=>ye(e,"inViewport",s)),e.$on("viewportenter",t[14]),e.$on("viewportleave",t[15]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,[l]){const a={};l&2&&(a.position=o[1]),l&4&&(a.scale=o[2]),l&8&&(a.rotation=o[3]),l&16&&(a.lookAt=o[4]),l&256&&(a.frustumCulled=o[8]),l&512&&(a.renderOrder=o[9]),l&1024&&(a.visible=o[10]),l&64&&(a.castShadow=o[6]),l&128&&(a.receiveShadow=o[7]),l&32&&(a.viewportAware=o[5]),l&65536&&(a.$$scope={dirty:l,ctx:o}),!n&&l&1&&(n=!0,a.inViewport=o[0],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function Ar(t,e,n){let{$$slots:i={},$$scope:s}=e,{position:r=void 0}=e,{scale:o=void 0}=e,{rotation:l=void 0}=e,{lookAt:a=void 0}=e,{viewportAware:c=!1}=e,{inViewport:_=!1}=e,{castShadow:h=void 0}=e,{receiveShadow:u=void 0}=e,{frustumCulled:m=void 0}=e,{renderOrder:A=void 0}=e,{visible:f=void 0}=e;const d=new Gi;function g(S){_=S,n(0,_)}function p(S){N.call(this,t,S)}function w(S){N.call(this,t,S)}return t.$$set=S=>{"position"in S&&n(1,r=S.position),"scale"in S&&n(2,o=S.scale),"rotation"in S&&n(3,l=S.rotation),"lookAt"in S&&n(4,a=S.lookAt),"viewportAware"in S&&n(5,c=S.viewportAware),"inViewport"in S&&n(0,_=S.inViewport),"castShadow"in S&&n(6,h=S.castShadow),"receiveShadow"in S&&n(7,u=S.receiveShadow),"frustumCulled"in S&&n(8,m=S.frustumCulled),"renderOrder"in S&&n(9,A=S.renderOrder),"visible"in S&&n(10,f=S.visible),"$$scope"in S&&n(16,s=S.$$scope)},[_,r,o,l,a,c,h,u,m,A,f,d,i,g,p,w,s]}class Gt extends ee{constructor(e){super(),te(this,e,Ar,Tr,J,{position:1,scale:2,rotation:3,lookAt:4,viewportAware:5,inViewport:0,castShadow:6,receiveShadow:7,frustumCulled:8,renderOrder:9,visible:10,group:11})}get group(){return this.$$.ctx[11]}}const cd=new Wt;class Sr{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const n=this.workerCreator();n.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=n}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,n){const i=this.workersResolve[e];if(i&&i(n),this.queue.length){const{resolve:s,msg:r,transfer:o}=this.queue.shift();this.workersResolve[e]=s,this.workers[e].postMessage(r,o)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,n){return new Promise(i=>{const s=this._getIdleWorker();s!==-1?(this._initWorker(s),this.workerStatus|=1<<s,this.workersResolve[s]=i,this.workers[s].postMessage(e,n)):this.queue.push({resolve:i,msg:e,transfer:n})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const br=0,Rr=1,Mr=2,yr=3,vr=0,Or=0,Er=2,Cr=0,Fr=1,Lr=160,Pr=161,Br=162,xr=163,Ir=0,Ur=1,Dr=0,Kr=1,Vr=2,Nr=3,kr=4,Gr=5,jr=6,Hr=7,zr=8,Xr=9,Wr=10,Yr=11,Qr=12,Zr=13,qr=14,Jr=15,$r=16,eo=17,to=18,no=0,io=1,so=2,ro=3,oo=4,ao=5,lo=6,co=7,uo=8,fo=9,ho=10,mo=11,_o=0,po=1,go=2,wo=13,To=14,Ao=15,So=128,bo=64,Ro=32,Mo=16,yo=0,vo=1,Oo=2,Eo=3,Co=4,Fo=5,Lo=6,Po=7,Bo=8,xo=9,Io=10,Uo=13,Do=14,Ko=15,Vo=16,No=17,ko=20,Go=21,jo=22,Ho=23,zo=24,Xo=27,Wo=28,Yo=29,Qo=30,Zo=31,qo=34,Jo=35,$o=36,ea=37,ta=38,na=41,ia=42,sa=43,ra=44,oa=45,aa=48,la=49,ca=50,ua=58,fa=59,da=62,ha=63,ma=64,_a=65,pa=68,ga=69,wa=70,Ta=71,Aa=74,Sa=75,ba=76,Ra=77,Ma=78,ya=81,va=82,Oa=83,Ea=84,Ca=85,Fa=88,La=89,Pa=90,Ba=91,xa=92,Ia=95,Ua=96,Da=97,Ka=98,Va=99,Na=100,ka=101,Ga=102,ja=103,Ha=104,za=105,Xa=106,Wa=107,Ya=108,Qa=109,Za=110,qa=111,Ja=112,$a=113,el=114,tl=115,nl=116,il=117,sl=118,rl=119,ol=120,al=121,ll=122,cl=123,ul=124,fl=125,dl=126,hl=127,ml=128,_l=129,pl=130,gl=131,wl=132,Tl=133,Al=134,Sl=135,bl=136,Rl=137,Ml=138,yl=139,vl=140,Ol=141,El=142,Cl=143,Fl=144,Ll=145,Pl=146,Bl=147,xl=148,Il=149,Ul=150,Dl=151,Kl=152,Vl=153,Nl=154,kl=155,Gl=156,jl=157,Hl=158,zl=159,Xl=160,Wl=161,Yl=162,Ql=163,Zl=164,ql=165,Jl=166,$l=167,ec=168,tc=169,nc=170,ic=171,sc=172,rc=173,oc=174,ac=175,lc=176,cc=177,uc=178,fc=179,dc=180,hc=181,mc=182,_c=183,pc=184,gc=1000156007,wc=1000156008,Tc=1000156009,Ac=1000156010,Sc=1000156011,bc=1000156017,Rc=1000156018,Mc=1000156019,yc=1000156020,vc=1000156021,Oc=1000054e3,Ec=1000054001,Cc=1000054002,Fc=1000054003,Lc=1000054004,Pc=1000054005,Bc=1000054006,xc=1000054007,Ic=1000066e3,Uc=1000066001,Dc=1000066002,Kc=1000066003,Vc=1000066004,Nc=1000066005,kc=1000066006,Gc=1000066007,jc=1000066008,Hc=1000066009,zc=1000066010,Xc=1000066011,Wc=1000066012,Yc=1000066013,Qc=100034e4,Zc=1000340001;class ri{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class mt{constructor(e,n,i,s){this._dataView=new DataView(e.buffer,e.byteOffset+n,i),this._littleEndian=s,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,n=0){const i=this._offset;let s=0;for(;this._dataView.getUint8(this._offset)!==n&&s<e;)s++,this._offset++;return s<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,s)}}const Bn=new Uint8Array([0]),_e=[171,75,84,88,32,50,48,187,13,10,26,10];function xn(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Buffer.from(t)}function In(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Buffer.from(t).toString("utf8")}function Pt(t){let e=0;for(const s of t)e+=s.byteLength;const n=new Uint8Array(e);let i=0;for(const s of t)n.set(new Uint8Array(s),i),i+=s.byteLength;return n}function qc(t){const e=new Uint8Array(t.buffer,t.byteOffset,_e.length);if(e[0]!==_e[0]||e[1]!==_e[1]||e[2]!==_e[2]||e[3]!==_e[3]||e[4]!==_e[4]||e[5]!==_e[5]||e[6]!==_e[6]||e[7]!==_e[7]||e[8]!==_e[8]||e[9]!==_e[9]||e[10]!==_e[10]||e[11]!==_e[11])throw new Error("Missing KTX 2.0 identifier.");const n=new ri,i=17*Uint32Array.BYTES_PER_ELEMENT,s=new mt(t,_e.length,i,!0);n.vkFormat=s._nextUint32(),n.typeSize=s._nextUint32(),n.pixelWidth=s._nextUint32(),n.pixelHeight=s._nextUint32(),n.pixelDepth=s._nextUint32(),n.layerCount=s._nextUint32(),n.faceCount=s._nextUint32();const r=s._nextUint32();n.supercompressionScheme=s._nextUint32();const o=s._nextUint32(),l=s._nextUint32(),a=s._nextUint32(),c=s._nextUint32(),_=s._nextUint64(),h=s._nextUint64(),u=new mt(t,_e.length+i,3*r*8,!0);for(let D=0;D<r;D++)n.levels.push({levelData:new Uint8Array(t.buffer,t.byteOffset+u._nextUint64(),u._nextUint64()),uncompressedByteLength:u._nextUint64()});const m=new mt(t,o,l,!0),A={vendorId:m._skip(4)._nextUint16(),descriptorType:m._nextUint16(),versionNumber:m._nextUint16(),descriptorBlockSize:m._nextUint16(),colorModel:m._nextUint8(),colorPrimaries:m._nextUint8(),transferFunction:m._nextUint8(),flags:m._nextUint8(),texelBlockDimension:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],bytesPlane:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],samples:[]},f=(A.descriptorBlockSize/4-6)/4;for(let D=0;D<f;D++){const Z={bitOffset:m._nextUint16(),bitLength:m._nextUint8(),channelType:m._nextUint8(),samplePosition:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&Z.channelType?(Z.sampleLower=m._nextInt32(),Z.sampleUpper=m._nextInt32()):(Z.sampleLower=m._nextUint32(),Z.sampleUpper=m._nextUint32()),A.samples[D]=Z}n.dataFormatDescriptor.length=0,n.dataFormatDescriptor.push(A);const d=new mt(t,a,c,!0);for(;d._offset<c;){const D=d._nextUint32(),Z=d._scan(D),F=In(Z),C=d._scan(D-Z.byteLength);n.keyValue[F]=F.match(/^ktx/i)?In(C):C,d._offset%4&&d._skip(4-d._offset%4)}if(h<=0)return n;const g=new mt(t,_,h,!0),p=g._nextUint16(),w=g._nextUint16(),S=g._nextUint32(),M=g._nextUint32(),T=g._nextUint32(),O=g._nextUint32(),R=[];for(let D=0;D<r;D++)R.push({imageFlags:g._nextUint32(),rgbSliceByteOffset:g._nextUint32(),rgbSliceByteLength:g._nextUint32(),alphaSliceByteOffset:g._nextUint32(),alphaSliceByteLength:g._nextUint32()});const v=_+g._offset,I=v+S,y=I+M,U=y+T,E=new Uint8Array(t.buffer,t.byteOffset+v,S),L=new Uint8Array(t.buffer,t.byteOffset+I,M),X=new Uint8Array(t.buffer,t.byteOffset+y,T),ne=new Uint8Array(t.buffer,t.byteOffset+U,O);return n.globalData={endpointCount:p,selectorCount:w,imageDescs:R,endpointsData:E,selectorsData:L,tablesData:X,extendedData:ne},n}function ln(){return(ln=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}const Jc={keepWriter:!1};function $c(t,e={}){e=ln({},Jc,e);let n=new ArrayBuffer(0);if(t.globalData){const p=new ArrayBuffer(20+5*t.globalData.imageDescs.length*4),w=new DataView(p);w.setUint16(0,t.globalData.endpointCount,!0),w.setUint16(2,t.globalData.selectorCount,!0),w.setUint32(4,t.globalData.endpointsData.byteLength,!0),w.setUint32(8,t.globalData.selectorsData.byteLength,!0),w.setUint32(12,t.globalData.tablesData.byteLength,!0),w.setUint32(16,t.globalData.extendedData.byteLength,!0);for(let S=0;S<t.globalData.imageDescs.length;S++){const M=t.globalData.imageDescs[S];w.setUint32(20+5*S*4+0,M.imageFlags,!0),w.setUint32(20+5*S*4+4,M.rgbSliceByteOffset,!0),w.setUint32(20+5*S*4+8,M.rgbSliceByteLength,!0),w.setUint32(20+5*S*4+12,M.alphaSliceByteOffset,!0),w.setUint32(20+5*S*4+16,M.alphaSliceByteLength,!0)}n=Pt([p,t.globalData.endpointsData,t.globalData.selectorsData,t.globalData.tablesData,t.globalData.extendedData])}const i=[];let s=t.keyValue;e.keepWriter||(s=ln({},t.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const p in s){const w=s[p],S=xn(p),M=typeof w=="string"?xn(w):w,T=S.byteLength+1+M.byteLength+1,O=T%4?4-T%4:0;i.push(Pt([new Uint32Array([T]),S,Bn,M,Bn,new Uint8Array(O).fill(0)]))}const r=Pt(i);if(t.dataFormatDescriptor.length!==1||t.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const o=t.dataFormatDescriptor[0],l=new ArrayBuffer(28+16*o.samples.length),a=new DataView(l),c=24+16*o.samples.length;if(a.setUint32(0,l.byteLength,!0),a.setUint16(4,o.vendorId,!0),a.setUint16(6,o.descriptorType,!0),a.setUint16(8,o.versionNumber,!0),a.setUint16(10,c,!0),a.setUint8(12,o.colorModel),a.setUint8(13,o.colorPrimaries),a.setUint8(14,o.transferFunction),a.setUint8(15,o.flags),!Array.isArray(o.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");a.setUint8(16,o.texelBlockDimension[0]),a.setUint8(17,o.texelBlockDimension[1]),a.setUint8(18,o.texelBlockDimension[2]),a.setUint8(19,o.texelBlockDimension[3]);for(let p=0;p<8;p++)a.setUint8(20+p,o.bytesPlane[p]);for(let p=0;p<o.samples.length;p++){const w=o.samples[p],S=28+16*p;if(w.channelID)throw new Error("channelID has been renamed to channelType.");a.setUint16(S+0,w.bitOffset,!0),a.setUint8(S+2,w.bitLength),a.setUint8(S+3,w.channelType),a.setUint8(S+4,w.samplePosition[0]),a.setUint8(S+5,w.samplePosition[1]),a.setUint8(S+6,w.samplePosition[2]),a.setUint8(S+7,w.samplePosition[3]),64&w.channelType?(a.setInt32(S+8,w.sampleLower,!0),a.setInt32(S+12,w.sampleUpper,!0)):(a.setUint32(S+8,w.sampleLower,!0),a.setUint32(S+12,w.sampleUpper,!0))}const _=_e.length+68+3*t.levels.length*8,h=_+l.byteLength;let u=n.byteLength>0?h+r.byteLength:0;u%8&&(u+=8-u%8);const m=[],A=new DataView(new ArrayBuffer(3*t.levels.length*8));let f=(u||h+r.byteLength)+n.byteLength;for(let p=0;p<t.levels.length;p++){const w=t.levels[p];m.push(w.levelData),A.setBigUint64(24*p+0,BigInt(f),!0),A.setBigUint64(24*p+8,BigInt(w.levelData.byteLength),!0),A.setBigUint64(24*p+16,BigInt(w.uncompressedByteLength),!0),f+=w.levelData.byteLength}const d=new ArrayBuffer(68),g=new DataView(d);return g.setUint32(0,t.vkFormat,!0),g.setUint32(4,t.typeSize,!0),g.setUint32(8,t.pixelWidth,!0),g.setUint32(12,t.pixelHeight,!0),g.setUint32(16,t.pixelDepth,!0),g.setUint32(20,t.layerCount,!0),g.setUint32(24,t.faceCount,!0),g.setUint32(28,t.levels.length,!0),g.setUint32(32,t.supercompressionScheme,!0),g.setUint32(36,_,!0),g.setUint32(40,l.byteLength,!0),g.setUint32(44,h,!0),g.setUint32(48,r.byteLength,!0),g.setBigUint64(52,BigInt(n.byteLength>0?u:0),!0),g.setBigUint64(60,BigInt(n.byteLength),!0),new Uint8Array(Pt([new Uint8Array(_e).buffer,d,A.buffer,l,r,u>0?new ArrayBuffer(u-(h+r.byteLength)):new ArrayBuffer(0),n,...m]))}const eu=Object.freeze(Object.defineProperty({__proto__:null,KHR_DF_CHANNEL_RGBSDA_ALPHA:Ao,KHR_DF_CHANNEL_RGBSDA_BLUE:go,KHR_DF_CHANNEL_RGBSDA_DEPTH:To,KHR_DF_CHANNEL_RGBSDA_GREEN:po,KHR_DF_CHANNEL_RGBSDA_RED:_o,KHR_DF_CHANNEL_RGBSDA_STENCIL:wo,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:Ur,KHR_DF_FLAG_ALPHA_STRAIGHT:Ir,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:vr,KHR_DF_MODEL_ASTC:Br,KHR_DF_MODEL_ETC1:Lr,KHR_DF_MODEL_ETC1S:xr,KHR_DF_MODEL_ETC2:Pr,KHR_DF_MODEL_RGBSDA:Fr,KHR_DF_MODEL_UNSPECIFIED:Cr,KHR_DF_PRIMARIES_ACES:lo,KHR_DF_PRIMARIES_ACESCC:co,KHR_DF_PRIMARIES_ADOBERGB:mo,KHR_DF_PRIMARIES_BT2020:oo,KHR_DF_PRIMARIES_BT601_EBU:so,KHR_DF_PRIMARIES_BT601_SMPTE:ro,KHR_DF_PRIMARIES_BT709:io,KHR_DF_PRIMARIES_CIEXYZ:ao,KHR_DF_PRIMARIES_DISPLAYP3:ho,KHR_DF_PRIMARIES_NTSC1953:uo,KHR_DF_PRIMARIES_PAL525:fo,KHR_DF_PRIMARIES_UNSPECIFIED:no,KHR_DF_SAMPLE_DATATYPE_EXPONENT:Ro,KHR_DF_SAMPLE_DATATYPE_FLOAT:So,KHR_DF_SAMPLE_DATATYPE_LINEAR:Mo,KHR_DF_SAMPLE_DATATYPE_SIGNED:bo,KHR_DF_TRANSFER_ACESCC:$r,KHR_DF_TRANSFER_ACESCCT:eo,KHR_DF_TRANSFER_ADOBERGB:to,KHR_DF_TRANSFER_BT1886:Hr,KHR_DF_TRANSFER_DCIP3:Qr,KHR_DF_TRANSFER_HLG_EOTF:Xr,KHR_DF_TRANSFER_HLG_OETF:zr,KHR_DF_TRANSFER_ITU:Nr,KHR_DF_TRANSFER_LINEAR:Kr,KHR_DF_TRANSFER_NTSC:kr,KHR_DF_TRANSFER_PAL625_EOTF:qr,KHR_DF_TRANSFER_PAL_OETF:Zr,KHR_DF_TRANSFER_PQ_EOTF:Wr,KHR_DF_TRANSFER_PQ_OETF:Yr,KHR_DF_TRANSFER_SLOG:Gr,KHR_DF_TRANSFER_SLOG2:jr,KHR_DF_TRANSFER_SRGB:Vr,KHR_DF_TRANSFER_ST240:Jr,KHR_DF_TRANSFER_UNSPECIFIED:Dr,KHR_DF_VENDORID_KHRONOS:Or,KHR_DF_VERSION:Er,KHR_SUPERCOMPRESSION_BASISLZ:Rr,KHR_SUPERCOMPRESSION_NONE:br,KHR_SUPERCOMPRESSION_ZLIB:yr,KHR_SUPERCOMPRESSION_ZSTD:Mr,KTX2Container:ri,VK_FORMAT_A1R5G5B5_UNORM_PACK16:Bo,VK_FORMAT_A2B10G10R10_SINT_PACK32:ga,VK_FORMAT_A2B10G10R10_SNORM_PACK32:_a,VK_FORMAT_A2B10G10R10_UINT_PACK32:pa,VK_FORMAT_A2B10G10R10_UNORM_PACK32:ma,VK_FORMAT_A2R10G10B10_SINT_PACK32:ha,VK_FORMAT_A2R10G10B10_SNORM_PACK32:fa,VK_FORMAT_A2R10G10B10_UINT_PACK32:da,VK_FORMAT_A2R10G10B10_UNORM_PACK32:ua,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:Zc,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:Qc,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:Xc,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:dc,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:fc,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:jc,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:oc,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:rc,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:Hc,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:lc,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:ac,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:zc,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:uc,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:cc,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:Wc,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:mc,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:hc,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:Yc,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:pc,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:_c,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:Ic,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:Hl,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:jl,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:Uc,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:Xl,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:zl,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:Dc,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:Yl,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:Wl,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:Kc,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:Zl,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:Ql,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:Vc,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:Jl,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:ql,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:Nc,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:ec,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:$l,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:kc,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:nc,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:tc,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:Gc,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:sc,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:ic,VK_FORMAT_B10G11R11_UFLOAT_PACK32:ll,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:Sc,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:vc,VK_FORMAT_B4G4R4A4_UNORM_PACK16:Eo,VK_FORMAT_B5G5R5A1_UNORM_PACK16:Po,VK_FORMAT_B5G6R5_UNORM_PACK16:Fo,VK_FORMAT_B8G8R8A8_SINT:la,VK_FORMAT_B8G8R8A8_SNORM:oa,VK_FORMAT_B8G8R8A8_SRGB:ca,VK_FORMAT_B8G8R8A8_UINT:aa,VK_FORMAT_B8G8R8A8_UNORM:ra,VK_FORMAT_B8G8R8_SINT:Jo,VK_FORMAT_B8G8R8_SNORM:Zo,VK_FORMAT_B8G8R8_SRGB:$o,VK_FORMAT_B8G8R8_UINT:qo,VK_FORMAT_B8G8R8_UNORM:Qo,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:Al,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:Tl,VK_FORMAT_BC1_RGB_SRGB_BLOCK:wl,VK_FORMAT_BC1_RGB_UNORM_BLOCK:gl,VK_FORMAT_BC2_SRGB_BLOCK:bl,VK_FORMAT_BC2_UNORM_BLOCK:Sl,VK_FORMAT_BC3_SRGB_BLOCK:Ml,VK_FORMAT_BC3_UNORM_BLOCK:Rl,VK_FORMAT_BC4_SNORM_BLOCK:vl,VK_FORMAT_BC4_UNORM_BLOCK:yl,VK_FORMAT_BC5_SNORM_BLOCK:El,VK_FORMAT_BC5_UNORM_BLOCK:Ol,VK_FORMAT_BC6H_SFLOAT_BLOCK:Fl,VK_FORMAT_BC6H_UFLOAT_BLOCK:Cl,VK_FORMAT_BC7_SRGB_BLOCK:Pl,VK_FORMAT_BC7_UNORM_BLOCK:Ll,VK_FORMAT_D16_UNORM:ul,VK_FORMAT_D16_UNORM_S8_UINT:ml,VK_FORMAT_D24_UNORM_S8_UINT:_l,VK_FORMAT_D32_SFLOAT:dl,VK_FORMAT_D32_SFLOAT_S8_UINT:pl,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:cl,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:Gl,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:kl,VK_FORMAT_EAC_R11_SNORM_BLOCK:Nl,VK_FORMAT_EAC_R11_UNORM_BLOCK:Vl,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:Ul,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:Il,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:Kl,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:Dl,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:xl,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:Bl,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:Ac,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:yc,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:Lc,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:Oc,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:Pc,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:Ec,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:Bc,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:Cc,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:xc,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:Fc,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:Tc,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:wc,VK_FORMAT_R10X6_UNORM_PACK16:gc,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:Mc,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:Rc,VK_FORMAT_R12X4_UNORM_PACK16:bc,VK_FORMAT_R16G16B16A16_SFLOAT:Da,VK_FORMAT_R16G16B16A16_SINT:Ua,VK_FORMAT_R16G16B16A16_SNORM:xa,VK_FORMAT_R16G16B16A16_UINT:Ia,VK_FORMAT_R16G16B16A16_UNORM:Ba,VK_FORMAT_R16G16B16_SFLOAT:Pa,VK_FORMAT_R16G16B16_SINT:La,VK_FORMAT_R16G16B16_SNORM:Ca,VK_FORMAT_R16G16B16_UINT:Fa,VK_FORMAT_R16G16B16_UNORM:Ea,VK_FORMAT_R16G16_SFLOAT:Oa,VK_FORMAT_R16G16_SINT:va,VK_FORMAT_R16G16_SNORM:Ma,VK_FORMAT_R16G16_UINT:ya,VK_FORMAT_R16G16_UNORM:Ra,VK_FORMAT_R16_SFLOAT:ba,VK_FORMAT_R16_SINT:Sa,VK_FORMAT_R16_SNORM:Ta,VK_FORMAT_R16_UINT:Aa,VK_FORMAT_R16_UNORM:wa,VK_FORMAT_R32G32B32A32_SFLOAT:Qa,VK_FORMAT_R32G32B32A32_SINT:Ya,VK_FORMAT_R32G32B32A32_UINT:Wa,VK_FORMAT_R32G32B32_SFLOAT:Xa,VK_FORMAT_R32G32B32_SINT:za,VK_FORMAT_R32G32B32_UINT:Ha,VK_FORMAT_R32G32_SFLOAT:ja,VK_FORMAT_R32G32_SINT:Ga,VK_FORMAT_R32G32_UINT:ka,VK_FORMAT_R32_SFLOAT:Na,VK_FORMAT_R32_SINT:Va,VK_FORMAT_R32_UINT:Ka,VK_FORMAT_R4G4B4A4_UNORM_PACK16:Oo,VK_FORMAT_R4G4_UNORM_PACK8:vo,VK_FORMAT_R5G5B5A1_UNORM_PACK16:Lo,VK_FORMAT_R5G6B5_UNORM_PACK16:Co,VK_FORMAT_R64G64B64A64_SFLOAT:al,VK_FORMAT_R64G64B64A64_SINT:ol,VK_FORMAT_R64G64B64A64_UINT:rl,VK_FORMAT_R64G64B64_SFLOAT:sl,VK_FORMAT_R64G64B64_SINT:il,VK_FORMAT_R64G64B64_UINT:nl,VK_FORMAT_R64G64_SFLOAT:tl,VK_FORMAT_R64G64_SINT:el,VK_FORMAT_R64G64_UINT:$a,VK_FORMAT_R64_SFLOAT:Ja,VK_FORMAT_R64_SINT:qa,VK_FORMAT_R64_UINT:Za,VK_FORMAT_R8G8B8A8_SINT:ia,VK_FORMAT_R8G8B8A8_SNORM:ta,VK_FORMAT_R8G8B8A8_SRGB:sa,VK_FORMAT_R8G8B8A8_UINT:na,VK_FORMAT_R8G8B8A8_UNORM:ea,VK_FORMAT_R8G8B8_SINT:Wo,VK_FORMAT_R8G8B8_SNORM:zo,VK_FORMAT_R8G8B8_SRGB:Yo,VK_FORMAT_R8G8B8_UINT:Xo,VK_FORMAT_R8G8B8_UNORM:Ho,VK_FORMAT_R8G8_SINT:Go,VK_FORMAT_R8G8_SNORM:No,VK_FORMAT_R8G8_SRGB:jo,VK_FORMAT_R8G8_UINT:ko,VK_FORMAT_R8G8_UNORM:Vo,VK_FORMAT_R8_SINT:Do,VK_FORMAT_R8_SNORM:Io,VK_FORMAT_R8_SRGB:Ko,VK_FORMAT_R8_UINT:Uo,VK_FORMAT_R8_UNORM:xo,VK_FORMAT_S8_UINT:hl,VK_FORMAT_UNDEFINED:yo,VK_FORMAT_X8_D24_UNORM_PACK32:fl,read:qc,write:$c},Symbol.toStringTag,{value:"Module"})),{read:tu,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:nu,KHR_DF_TRANSFER_SRGB:iu,VK_FORMAT_UNDEFINED:su,VK_FORMAT_R16_SFLOAT:oi,VK_FORMAT_R16G16_SFLOAT:ai,VK_FORMAT_R16G16B16A16_SFLOAT:li,VK_FORMAT_R32_SFLOAT:ci,VK_FORMAT_R32G32_SFLOAT:ui,VK_FORMAT_R32G32B32A32_SFLOAT:fi,VK_FORMAT_R8_SRGB:_n,VK_FORMAT_R8_UNORM:di,VK_FORMAT_R8G8_SRGB:pn,VK_FORMAT_R8G8_UNORM:hi,VK_FORMAT_R8G8B8A8_SRGB:gn,VK_FORMAT_R8G8B8A8_UNORM:mi}=eu,$t=new WeakMap;let en=0;class De extends ji{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new Sr,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}detectSupport(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const e=new Jt(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const n=e.loadAsync("basis_transcoder.js"),i=new Jt(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);const s=i.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([n,s]).then(([r,o])=>{const l=De.BasisWorker.toString(),a=["/* constants */","let _EngineFormat = "+JSON.stringify(De.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(De.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(De.BasisFormat),"/* basis_transcoder.js */",r,"/* worker */",l.substring(l.indexOf("{")+1,l.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a])),this.transcoderBinary=o,this.workerPool.setWorkerCreator(()=>{const c=new Worker(this.workerSourceURL),_=this.transcoderBinary.slice(0);return c.postMessage({type:"init",config:this.workerConfig,transcoderBinary:_},[_]),c})}),en>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),en++}return this.transcoderPending}load(e,n,i,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const r=new Jt(this.manager);r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials),r.load(e,o=>{if($t.has(o))return $t.get(o).promise.then(n).catch(s);this._createTexture(o).then(l=>n?n(l):null).catch(s)},i,s)}_createTextureFrom(e){const{mipmaps:n,width:i,height:s,format:r,type:o,error:l,dfdTransferFn:a,dfdFlags:c}=e;if(o==="error")return Promise.reject(l);const _=new Xi(n,i,s,r,et);return _.minFilter=n.length===1?Sn:Hi,_.magFilter=Sn,_.generateMipmaps=!1,_.needsUpdate=!0,_.encoding=a===iu?gt:fn,_.premultiplyAlpha=!!(c&nu),_}_createTexture(e,n={}){const i=tu(new Uint8Array(e));if(i.vkFormat!==su)return ou(i);const s=n,r=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:s},[e])).then(o=>this._createTextureFrom(o.data));return $t.set(e,{promise:r}),r}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),en--,this}}De.BasisFormat={ETC1S:0,UASTC_4x4:1};De.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16};De.EngineFormat={RGBAFormat:pt,RGBA_ASTC_4x4_Format:Wi,RGBA_BPTC_Format:Yi,RGBA_ETC2_EAC_Format:Qi,RGBA_PVRTC_4BPPV1_Format:Zi,RGBA_S3TC_DXT5_Format:qi,RGB_ETC1_Format:Ji,RGB_ETC2_Format:$i,RGB_PVRTC_4BPPV1_Format:es,RGB_S3TC_DXT1_Format:ts};De.BasisWorker=function(){let t,e,n;const i=_EngineFormat,s=_TranscoderFormat,r=_BasisFormat;self.addEventListener("message",function(m){const A=m.data;switch(A.type){case"init":t=A.config,o(A.transcoderBinary);break;case"transcode":e.then(()=>{try{const{width:f,height:d,hasAlpha:g,mipmaps:p,format:w,dfdTransferFn:S,dfdFlags:M}=l(A.buffer),T=[];for(let O=0;O<p.length;++O)T.push(p[O].data.buffer);self.postMessage({type:"transcode",id:A.id,width:f,height:d,hasAlpha:g,mipmaps:p,format:w,dfdTransferFn:S,dfdFlags:M},T)}catch(f){console.error(f),self.postMessage({type:"error",id:A.id,error:f.message})}});break}});function o(m){e=new Promise(A=>{n={wasmBinary:m,onRuntimeInitialized:A},BASIS(n)}).then(()=>{n.initializeBasis(),n.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function l(m){const A=new n.KTX2File(new Uint8Array(m));function f(){A.close(),A.delete()}if(!A.isValid())throw f(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const d=A.isUASTC()?r.UASTC_4x4:r.ETC1S,g=A.getWidth(),p=A.getHeight(),w=A.getLevels(),S=A.getHasAlpha(),M=A.getDFDTransferFunc(),T=A.getDFDFlags(),{transcoderFormat:O,engineFormat:R}=h(d,g,p,S);if(!g||!p||!w)throw f(),new Error("THREE.KTX2Loader:	Invalid texture");if(!A.startTranscoding())throw f(),new Error("THREE.KTX2Loader: .startTranscoding failed");const v=[];for(let I=0;I<w;I++){const y=A.getImageLevelInfo(I,0,0),U=y.origWidth,E=y.origHeight,L=new Uint8Array(A.getImageTranscodedSizeInBytes(I,0,0,O));if(!A.transcodeImage(L,I,0,0,O,0,-1,-1))throw f(),new Error("THREE.KTX2Loader: .transcodeImage failed.");v.push({data:L,width:U,height:E})}return f(),{width:g,height:p,hasAlpha:S,mipmaps:v,format:R,dfdTransferFn:M,dfdFlags:T}}const a=[{if:"astcSupported",basisFormat:[r.UASTC_4x4],transcoderFormat:[s.ASTC_4x4,s.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.BC7_M5,s.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.BC1,s.BC3],engineFormat:[i.RGB_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.ETC1,s.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.ETC1],engineFormat:[i.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[s.PVRTC1_4_RGB,s.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],c=a.sort(function(m,A){return m.priorityETC1S-A.priorityETC1S}),_=a.sort(function(m,A){return m.priorityUASTC-A.priorityUASTC});function h(m,A,f,d){let g,p;const w=m===r.ETC1S?c:_;for(let S=0;S<w.length;S++){const M=w[S];if(!!t[M.if]&&!!M.basisFormat.includes(m)&&!(d&&M.transcoderFormat.length<2)&&!(M.needsPowerOfTwo&&!(u(A)&&u(f))))return g=M.transcoderFormat[d?1:0],p=M.engineFormat[d?1:0],{transcoderFormat:g,engineFormat:p}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),g=s.RGBA32,p=i.RGBAFormat,{transcoderFormat:g,engineFormat:p}}function u(m){return m<=2?!0:(m&m-1)===0&&m!==0}};const Un={[fi]:pt,[li]:pt,[mi]:pt,[gn]:pt,[ui]:Ct,[ai]:Ct,[hi]:Ct,[pn]:Ct,[ci]:Ft,[oi]:Ft,[_n]:Ft,[di]:Ft},tn={[fi]:It,[li]:Ut,[mi]:et,[gn]:et,[ui]:It,[ai]:Ut,[hi]:et,[pn]:et,[ci]:It,[oi]:Ut,[_n]:et,[di]:et},ru={[gn]:gt,[pn]:gt,[_n]:gt};function ou(t){const{vkFormat:e,pixelWidth:n,pixelHeight:i,pixelDepth:s}=t;if(Un[e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let r;const o=t.levels[0].levelData;tn[e]===It?r=new Float32Array(o.buffer,o.byteOffset,o.byteLength/Float32Array.BYTES_PER_ELEMENT):tn[e]===Ut?r=new Uint16Array(o.buffer,o.byteOffset,o.byteLength/Uint16Array.BYTES_PER_ELEMENT):r=o;const l=s===0?new ns(r,n,i):new is(r,n,i,s);return l.type=tn[e],l.format=Un[e],l.encoding=ru[e]||fn,l.needsUpdate=!0,Promise.resolve(l)}const ud=new Qn,fd=new q;Dt.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ee(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};ss.line={uniforms:Nt.merge([Dt.common,Dt.fog,Dt.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				// get the offset direction as perpendicular to the view vector
				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 offset;
				if ( position.y < 0.5 ) {

					offset = normalize( cross( start.xyz, worldDir ) );

				} else {

					offset = normalize( cross( end.xyz, worldDir ) );

				}

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// extend the line bounds to encompass  endcaps
					start.xyz += - worldDir * linewidth * 0.5;
					end.xyz += worldDir * linewidth * 0.5;

					// shift the position of the quad so it hugs the forward edge of the line
					offset.xy -= dir * forwardOffset;
					offset.z += 0.5;

				#endif

				// endcaps
				if ( position.y > 1.0 || position.y < 0.0 ) {

					offset.xy += dir * 2.0 * forwardOffset;

				}

				// adjust for linewidth
				offset *= linewidth * 0.5;

				// set the world position
				worldPos = ( position.y < 0.5 ) ? start : end;
				worldPos.xyz += offset;

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <encodings_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};const dd=new q,hd=new q,md=new Yt,_d=new Yt,pd=new Yt,gd=new q,wd=new yt,Td=new rs,Ad=new q,Sd=new Qn,bd=new zi,Rd=new Yt;Ws(bn,()=>new bn);const au=()=>{const t=Mi();return{hasEventListeners:n=>{const i=t.$$.callbacks;return n in i&&i[n].length>0}}},Et=new q,wn=new q,lu=new q,cu=(t,e,n)=>{const i=Et.setFromMatrixPosition(t.matrixWorld);i.project(e);const s=n.width/2,r=n.height/2;return[i.x*s+s,-(i.y*r)+r]},uu=(t,e)=>{const n=Et.setFromMatrixPosition(t.matrixWorld),i=wn.setFromMatrixPosition(e.matrixWorld),s=n.sub(i),r=e.getWorldDirection(lu);return s.angleTo(r)>Math.PI/2},fu=(t,e,n,i)=>{const s=Et.setFromMatrixPosition(t.matrixWorld),r=s.clone();r.project(e),n.setFromCamera(r,e);const o=n.intersectObjects(i,!0);if(o.length){const l=o[0].distance;return s.distanceTo(n.ray.origin)<l}return!0},du=(t,e)=>{if(e instanceof Rt)return e.zoom;if(e instanceof Mt){const n=Et.setFromMatrixPosition(t.matrixWorld),i=wn.setFromMatrixPosition(e.matrixWorld),s=e.fov*Math.PI/180,r=n.distanceTo(i),o=2*Math.tan(s/2)*r;return 1/o}else return 1},Dn=(t,e,n)=>{if(e instanceof Mt||e instanceof Rt){const i=Et.setFromMatrixPosition(t.matrixWorld),s=wn.setFromMatrixPosition(e.matrixWorld),r=i.distanceTo(s),o=(n[1]-n[0])/(e.far-e.near),l=n[1]-o*e.far;return Math.round(o*r+l)}},cn=t=>Math.abs(t)<1e-10?0:t,_i=(t,e,n="")=>{let i="matrix3d(";for(let s=0;s!==16;s++)i+=cn(e[s]*t.elements[s])+(s!==15?",":")");return n+i},hu=(t=>e=>_i(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),mu=(t=>(e,n)=>_i(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]),_u=t=>t.split(/(?=[A-Z])/).join("-").toLowerCase(),Ie=t=>Object.entries(t).filter(([e,n])=>!!n).map(([e,n])=>`${_u(e)}: ${n}`).join("; "),Oe=(t,e)=>{t.update(n=>({...n,...e}))},pu=t=>({}),Kn=t=>({});function gu(t){let e;const n=t[41].threlte,i=Se(n,t,t[50],Kn);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[1]&524288)&&be(i,n,s,s[50],e?Me(n,s[50],r,pu):Re(s[50]),Kn)},i(s){e||(B(i,s),e=!0)},o(s){x(i,s),e=!1},d(s){i&&i.d(s)}}}function wu(t){let e=t[7],n,i,s=t[7]&&nn(t);return{c(){s&&s.c(),n=ke()},l(r){s&&s.l(r),n=ke()},m(r,o){s&&s.m(r,o),Q(r,n,o),i=!0},p(r,o){r[7]?e?J(e,r[7])?(s.d(1),s=nn(r),s.c(),s.m(n.parentNode,n)):s.p(r,o):(s=nn(r),s.c(),s.m(n.parentNode,n)):e&&(s.d(1),s=null),e=r[7]},i(r){i||(B(s),i=!0)},o(r){x(s),i=!1},d(r){r&&K(n),s&&s.d(r)}}}function Tu(t){let e=t[7],n,i,s=t[7]&&sn(t);return{c(){s&&s.c(),n=ke()},l(r){s&&s.l(r),n=ke()},m(r,o){s&&s.m(r,o),Q(r,n,o),i=!0},p(r,o){r[7]?e?J(e,r[7])?(s.d(1),s=sn(r),s.c(),s.m(n.parentNode,n)):s.p(r,o):(s=sn(r),s.c(),s.m(n.parentNode,n)):e&&(s.d(1),s=null),e=r[7]},i(r){i||(B(s),i=!0)},o(r){x(s),i=!1},d(r){r&&K(n),s&&s.d(r)}}}function nn(t){let e,n,i,s,r,o,l;const a=t[41].default,c=Se(a,t,t[50],null);let _=[{style:s=Ie(t[15])}],h={};for(let u=0;u<_.length;u+=1)h=jn(h,_[u]);return{c(){e=we(t[7]),n=we("div"),c&&c.c(),this.h()},l(u){e=Te(u,(t[7]||"null").toUpperCase(),{style:!0});var m=Ae(e);n=Te(m,"DIV",{style:!0});var A=Ae(n);c&&c.l(A),A.forEach(K),m.forEach(K),this.h()},h(){Ce(n,"style",i=Ie(t[16])),Vt(e,h)},m(u,m){Q(u,e,m),ue(e,n),c&&c.m(n,null),t[49](e),r=!0,o||(l=un(t[26].call(null,e)),o=!0)},p(u,m){c&&c.p&&(!r||m[1]&524288)&&be(c,a,u,u[50],r?Me(a,u[50],m,null):Re(u[50]),null),(!r||m[0]&65536&&i!==(i=Ie(u[16])))&&Ce(n,"style",i),Vt(e,h=Hn(_,[(!r||m[0]&32768&&s!==(s=Ie(u[15])))&&{style:s}]))},i(u){r||(B(c,u),r=!0)},o(u){x(c,u),r=!1},d(u){u&&K(e),c&&c.d(u),t[49](null),o=!1,l()}}}function sn(t){let e,n,i,s,r,o,l,a,c;const _=t[41].default,h=Se(_,t,t[50],null);let u=[{style:o=Ie(t[12])}],m={};for(let A=0;A<u.length;A+=1)m=jn(m,u[A]);return{c(){e=we(t[7]),n=we("div"),i=we("div"),h&&h.c(),this.h()},l(A){e=Te(A,(t[7]||"null").toUpperCase(),{style:!0});var f=Ae(e);n=Te(f,"DIV",{style:!0});var d=Ae(n);i=Te(d,"DIV",{style:!0});var g=Ae(i);h&&h.l(g),g.forEach(K),d.forEach(K),f.forEach(K),this.h()},h(){Ce(i,"style",s=Ie(t[14])),Ce(n,"style",r=Ie(t[13])),Vt(e,m)},m(A,f){Q(A,e,f),ue(e,n),ue(n,i),h&&h.m(i,null),t[46](i),t[47](n),t[48](e),l=!0,a||(c=un(t[26].call(null,e)),a=!0)},p(A,f){h&&h.p&&(!l||f[1]&524288)&&be(h,_,A,A[50],l?Me(_,A[50],f,null):Re(A[50]),null),(!l||f[0]&16384&&s!==(s=Ie(A[14])))&&Ce(i,"style",s),(!l||f[0]&8192&&r!==(r=Ie(A[13])))&&Ce(n,"style",r),Vt(e,m=Hn(u,[(!l||f[0]&4096&&o!==(o=Ie(A[12])))&&{style:o}]))},i(A){l||(B(h,A),l=!0)},o(A){x(h,A),l=!1},d(A){A&&K(e),h&&h.d(A),t[46](null),t[47](null),t[48](null),a=!1,c()}}}function Au(t){let e,n,i,s,r,o,l,a;function c(f){t[42](f)}function _(f){t[43](f)}let h={position:t[1],scale:t[2],rotation:t[3],lookAt:t[4],viewportAware:t[5],$$slots:{default:[gu]},$$scope:{ctx:t}};t[8]!==void 0&&(h.group=t[8]),t[0]!==void 0&&(h.inViewport=t[0]),e=new Gt({props:h}),fe.push(()=>ye(e,"group",c)),fe.push(()=>ye(e,"inViewport",_)),e.$on("viewportenter",t[44]),e.$on("viewportleave",t[45]);const u=[Tu,wu],m=[];function A(f,d){return f[6]?0:1}return r=A(t),o=m[r]=u[r](t),{c(){k(e.$$.fragment),s=re(),o.c(),l=ke()},l(f){G(e.$$.fragment,f),s=oe(f),o.l(f),l=ke()},m(f,d){j(e,f,d),Q(f,s,d),m[r].m(f,d),Q(f,l,d),a=!0},p(f,d){const g={};d[0]&2&&(g.position=f[1]),d[0]&4&&(g.scale=f[2]),d[0]&8&&(g.rotation=f[3]),d[0]&16&&(g.lookAt=f[4]),d[0]&32&&(g.viewportAware=f[5]),d[1]&524288&&(g.$$scope={dirty:d,ctx:f}),!n&&d[0]&256&&(n=!0,g.group=f[8],ve(()=>n=!1)),!i&&d[0]&1&&(i=!0,g.inViewport=f[0],ve(()=>i=!1)),e.$set(g);let p=r;r=A(f),r===p?m[r].p(f,d):(Ht(),x(m[p],1,1,()=>{m[p]=null}),zt(),o=m[r],o?o.p(f,d):(o=m[r]=u[r](f),o.c()),B(o,1),o.m(l.parentNode,l))},i(f){a||(B(e.$$.fragment,f),B(o),a=!0)},o(f){x(e.$$.fragment,f),x(o),a=!1},d(f){H(e,f),f&&K(s),m[r].d(f),f&&K(l)}}}function Su(t,e,n){let i,s,r,o,l,a,c,_,h,{$$slots:u={},$$scope:m}=e,{position:A=void 0}=e,{scale:f=void 0}=e,{rotation:d=void 0}=e,{lookAt:g=void 0}=e,{viewportAware:p=!1}=e,{inViewport:w=!1}=e,{transform:S=!1}=e,{calculatePosition:M=cu}=e,{eps:T=.001}=e,{occlude:O=void 0}=e,{zIndexRange:R=[16777271,0]}=e,{sprite:v=!1}=e,{pointerEvents:I="auto"}=e,{center:y=!1}=e,{fullscreen:U=!1}=e,{distanceFactor:E=void 0}=e,{as:L="div"}=e,{portal:X=void 0}=e;const ne=bt();let D;const{renderer:Z,camera:F,scene:C,size:le}=Le();W(t,F,b=>n(54,s=b)),W(t,le,b=>n(38,i=b));const ge=()=>{if(!(s instanceof Mt)&&!(s instanceof Rt))throw new Error("Only PerspectiveCamera or OrthographicCamera supported for component <HTML>");return s},{raycaster:de}=Zt();let he=[0,0],P=0,{visible:ie=!0}=e,Y=document.createElement(L),V,Ke;const{hasEventListeners:dt}=au();let je=typeof O=="boolean"&&O===!0?[C]:Array.isArray(O)?O:void 0;const nt=Ve(le,b=>b.width/2);W(t,nt,b=>n(40,o=b));const it=Ve(le,b=>b.height/2);W(t,it,b=>n(39,r=b));let $={common:{el:ae({})},transform:{el:ae({position:"absolute",top:"0",left:"0",pointerEvents:"none",overflow:"hidden",display:"block",width:`${i.width}px`,height:`${i.height}px`}),outerRef:ae({position:"absolute",top:"0",left:"0",width:`${i.width}px`,height:`${i.height}px`,transformStyle:"preserve-3d",pointerEvents:"none"}),innerRef:ae({position:"absolute",pointerEvents:I})},noTransform:{el:ae({}),div:ae({position:"absolute",transform:y?"translate3d(-50%,-50%,0)":"none",top:U?`${-r}px`:void 0,left:U?`${-o}px`:void 0,width:U?`${i.width}px`:void 0,height:U?`${i.height}px`:void 0})}};const st=Ve([$.transform.el,$.common.el],([b,z])=>({...b,...z}));W(t,st,b=>n(12,l=b));const rt=Ve($.transform.outerRef,b=>b);W(t,rt,b=>n(13,a=b));const ot=Ve($.transform.innerRef,b=>b);W(t,ot,b=>n(14,c=b));const at=Ve($.noTransform.el,b=>b);W(t,at,b=>n(15,_=b));const lt=Ve($.noTransform.div,b=>b);W(t,lt,b=>n(16,h=b)),Ot(()=>{if(!D||!Y)return;const b=ge();b.updateMatrixWorld(),D.updateWorldMatrix(!0,!1);const z=S?he:M(D,b,i);if(S||Math.abs(P-b.zoom)>T||Math.abs(he[0]-z[0])>T||Math.abs(he[1]-z[1])>T){const Tn=uu(D,b),pi=ie;if(je){const Je=fu(D,b,de,je);n(27,ie=Je&&!Tn)}else n(27,ie=!Tn);if(pi!==ie&&(dt("visibilitychange")?ne("visibilitychange",ie):Oe($.common.el,{display:ie?"block":"none"})),n(9,Y.style.zIndex=`${Dn(D,b,R)}`,Y),Oe($.common.el,{zIndex:`${Dn(D,b,R)}`}),S){const Je=b.projectionMatrix.elements[5]*r,{isOrthographicCamera:An,top:gi,left:wi,bottom:Ti,right:Ai}=b;let $e=D.matrixWorld;if(v&&($e=b.matrixWorldInverse.clone().transpose().copyPosition($e).scale(D.scale),$e.elements[3]=$e.elements[7]=$e.elements[11]=0,$e.elements[15]=1),Oe($.transform.el,{perspective:An?"":`${Je}px`}),V&&Ke){const Si=An?`scale(${Je}) translate(${cn(-(Ai+wi)/2)}px,${cn((gi+Ti)/2)}px)`:`translateZ(${Je}px)`,bi=hu(b.matrixWorldInverse);Oe($.transform.outerRef,{transform:`${Si}${bi}translate(${o}px, ${r}px)`}),Oe($.transform.innerRef,{transform:mu($e,1/((E||10)/400))})}}else{const Je=E===void 0?1:du(D,b)*E;Oe($.noTransform.el,{transform:`translate3d(${z[0]}px, ${z[1]}px, 0) scale(${Je})`})}he=z,P=b.zoom}},{debugFrameloopMessage:"HTML: tracking parent"}),Gn(()=>{if(!D||S)return;C.updateMatrixWorld();const b=M(D,s,i);Oe($.noTransform.el,{position:"absolute",top:"0",left:"0",transform:`translate3d(${b[0]}px, ${b[1]}px, 0)`,transformOrigin:"0 0"})});const ht=b=>((X!=null?X:Z.domElement.parentElement).appendChild(b),{destroy:()=>{!b.parentNode||b.parentNode.removeChild(b)}});function He(b){D=b,n(8,D)}function ze(b){w=b,n(0,w)}function Xe(b){N.call(this,t,b)}function We(b){N.call(this,t,b)}function Ye(b){fe[b?"unshift":"push"](()=>{Ke=b,n(11,Ke)})}function Qe(b){fe[b?"unshift":"push"](()=>{V=b,n(10,V)})}function Ze(b){fe[b?"unshift":"push"](()=>{Y=b,n(9,Y)})}function qe(b){fe[b?"unshift":"push"](()=>{Y=b,n(9,Y)})}return t.$$set=b=>{"position"in b&&n(1,A=b.position),"scale"in b&&n(2,f=b.scale),"rotation"in b&&n(3,d=b.rotation),"lookAt"in b&&n(4,g=b.lookAt),"viewportAware"in b&&n(5,p=b.viewportAware),"inViewport"in b&&n(0,w=b.inViewport),"transform"in b&&n(6,S=b.transform),"calculatePosition"in b&&n(28,M=b.calculatePosition),"eps"in b&&n(29,T=b.eps),"occlude"in b&&n(30,O=b.occlude),"zIndexRange"in b&&n(31,R=b.zIndexRange),"sprite"in b&&n(32,v=b.sprite),"pointerEvents"in b&&n(33,I=b.pointerEvents),"center"in b&&n(34,y=b.center),"fullscreen"in b&&n(35,U=b.fullscreen),"distanceFactor"in b&&n(36,E=b.distanceFactor),"as"in b&&n(7,L=b.as),"portal"in b&&n(37,X=b.portal),"visible"in b&&n(27,ie=b.visible),"$$scope"in b&&n(50,m=b.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1073741824&&(je=typeof O=="boolean"&&O===!0?[C]:Array.isArray(O)?O:void 0),t.$$.dirty[1]&128&&Oe($.transform.el,{width:`${i.width}px`,height:`${i.height}px`}),t.$$.dirty[1]&128&&Oe($.transform.outerRef,{width:`${i.width}px`,height:`${i.height}px`}),t.$$.dirty[1]&4&&Oe($.transform.innerRef,{pointerEvents:I}),t.$$.dirty[1]&8&&Oe($.noTransform.div,{transform:y?"translate3d(-50%, -50%, 0)":"none"}),t.$$.dirty[1]&912&&Oe($.noTransform.div,{top:U?`${-r}px`:void 0,left:U?`${-o}px`:void 0,width:U?`${i.width}px`:void 0,height:U?`${i.height}px`:void 0})},[w,A,f,d,g,p,S,L,D,Y,V,Ke,l,a,c,_,h,F,le,nt,it,st,rt,ot,at,lt,ht,ie,M,T,O,R,v,I,y,U,E,X,i,r,o,u,He,ze,Xe,We,Ye,Qe,Ze,qe,m]}class bu extends ee{constructor(e){super(),te(this,e,Su,Au,J,{position:1,scale:2,rotation:3,lookAt:4,viewportAware:5,inViewport:0,transform:6,calculatePosition:28,eps:29,occlude:30,zIndexRange:31,sprite:32,pointerEvents:33,center:34,fullscreen:35,distanceFactor:36,as:7,portal:37,visible:27},null,[-1,-1])}}function Vn(t,e,n){const i=t.slice();i[2]=e[n];const s=Math.random();i[3]=s;const r=Math.random()>.5?1:-1;i[4]=r;const o=Math.random();i[5]=o;const l=Math.random()>.5?1:-1;return i[6]=l,i}function Nn(t){let e,n;return e=new At({props:{castShadow:!0,receiveShadow:!0,position:{x:t[4]*t[3],y:0,z:t[6]*t[5]},geometry:new on(1,1,1),material:new wt({side:an,color:"black"})}}),{c(){k(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,s){j(e,i,s),n=!0},p:ft,i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){x(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Ru(t){let e,n,i=[1,1,1],s=[];for(let o=0;o<3;o+=1)s[o]=Nn(Vn(t,i,o));const r=o=>x(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<3;o+=1)s[o].c();e=ke()},l(o){for(let l=0;l<3;l+=1)s[l].l(o);e=ke()},m(o,l){for(let a=0;a<3;a+=1)s[a].m(o,l);Q(o,e,l),n=!0},p(o,l){if(l&0){i=[1,1,1];let a;for(a=0;a<3;a+=1){const c=Vn(o,i,a);s[a]?(s[a].p(c,l),B(s[a],1)):(s[a]=Nn(c),s[a].c(),B(s[a],1),s[a].m(e.parentNode,e))}for(Ht(),a=3;a<3;a+=1)r(a);zt()}},i(o){if(!n){for(let l=0;l<3;l+=1)B(s[l]);n=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<3;l+=1)x(s[l]);n=!1},d(o){yi(s,o),o&&K(e)}}}function Mu(t){let e,n;return e=new Gt({props:{position:t[0],rotation:t[1],castShadow:!0,receiveShadow:!0,$$slots:{default:[Ru]},$$scope:{ctx:t}}}),{c(){k(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,s){j(e,i,s),n=!0},p(i,[s]){const r={};s&1&&(r.position=i[0]),s&2&&(r.rotation=i[1]),s&512&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){x(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function yu(t,e,n){let{position:i=void 0}=e,{rotation:s=void 0}=e;return t.$$set=r=>{"position"in r&&n(0,i=r.position),"rotation"in r&&n(1,s=r.rotation)},[i,s]}class rn extends ee{constructor(e){super(),te(this,e,yu,Mu,J,{position:0,rotation:1})}}const vu=.5*(Math.sqrt(3)-1),_t=(3-Math.sqrt(3))/6,Ou=1/3,Pe=1/6,Eu=(Math.sqrt(5)-1)/4,me=(5-Math.sqrt(5))/20,ce=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),se=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]);class Cu{constructor(e=Math.random){const n=typeof e=="function"?e:Pu(e);this.p=Lu(n),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(let i=0;i<512;i++)this.perm[i]=this.p[i&255],this.permMod12[i]=this.perm[i]%12}noise2D(e,n){const i=this.permMod12,s=this.perm;let r=0,o=0,l=0;const a=(e+n)*vu,c=Math.floor(e+a),_=Math.floor(n+a),h=(c+_)*_t,u=c-h,m=_-h,A=e-u,f=n-m;let d,g;A>f?(d=1,g=0):(d=0,g=1);const p=A-d+_t,w=f-g+_t,S=A-1+2*_t,M=f-1+2*_t,T=c&255,O=_&255;let R=.5-A*A-f*f;if(R>=0){const y=i[T+s[O]]*3;R*=R,r=R*R*(ce[y]*A+ce[y+1]*f)}let v=.5-p*p-w*w;if(v>=0){const y=i[T+d+s[O+g]]*3;v*=v,o=v*v*(ce[y]*p+ce[y+1]*w)}let I=.5-S*S-M*M;if(I>=0){const y=i[T+1+s[O+1]]*3;I*=I,l=I*I*(ce[y]*S+ce[y+1]*M)}return 70*(r+o+l)}noise3D(e,n,i){const s=this.permMod12,r=this.perm;let o,l,a,c;const _=(e+n+i)*Ou,h=Math.floor(e+_),u=Math.floor(n+_),m=Math.floor(i+_),A=(h+u+m)*Pe,f=h-A,d=u-A,g=m-A,p=e-f,w=n-d,S=i-g;let M,T,O,R,v,I;p>=w?w>=S?(M=1,T=0,O=0,R=1,v=1,I=0):p>=S?(M=1,T=0,O=0,R=1,v=0,I=1):(M=0,T=0,O=1,R=1,v=0,I=1):w<S?(M=0,T=0,O=1,R=0,v=1,I=1):p<S?(M=0,T=1,O=0,R=0,v=1,I=1):(M=0,T=1,O=0,R=1,v=1,I=0);const y=p-M+Pe,U=w-T+Pe,E=S-O+Pe,L=p-R+2*Pe,X=w-v+2*Pe,ne=S-I+2*Pe,D=p-1+3*Pe,Z=w-1+3*Pe,F=S-1+3*Pe,C=h&255,le=u&255,ge=m&255;let de=.6-p*p-w*w-S*S;if(de<0)o=0;else{const Y=s[C+r[le+r[ge]]]*3;de*=de,o=de*de*(ce[Y]*p+ce[Y+1]*w+ce[Y+2]*S)}let he=.6-y*y-U*U-E*E;if(he<0)l=0;else{const Y=s[C+M+r[le+T+r[ge+O]]]*3;he*=he,l=he*he*(ce[Y]*y+ce[Y+1]*U+ce[Y+2]*E)}let P=.6-L*L-X*X-ne*ne;if(P<0)a=0;else{const Y=s[C+R+r[le+v+r[ge+I]]]*3;P*=P,a=P*P*(ce[Y]*L+ce[Y+1]*X+ce[Y+2]*ne)}let ie=.6-D*D-Z*Z-F*F;if(ie<0)c=0;else{const Y=s[C+1+r[le+1+r[ge+1]]]*3;ie*=ie,c=ie*ie*(ce[Y]*D+ce[Y+1]*Z+ce[Y+2]*F)}return 32*(o+l+a+c)}noise4D(e,n,i,s){const r=this.perm;let o,l,a,c,_;const h=(e+n+i+s)*Eu,u=Math.floor(e+h),m=Math.floor(n+h),A=Math.floor(i+h),f=Math.floor(s+h),d=(u+m+A+f)*me,g=u-d,p=m-d,w=A-d,S=f-d,M=e-g,T=n-p,O=i-w,R=s-S;let v=0,I=0,y=0,U=0;M>T?v++:I++,M>O?v++:y++,M>R?v++:U++,T>O?I++:y++,T>R?I++:U++,O>R?y++:U++;const E=v>=3?1:0,L=I>=3?1:0,X=y>=3?1:0,ne=U>=3?1:0,D=v>=2?1:0,Z=I>=2?1:0,F=y>=2?1:0,C=U>=2?1:0,le=v>=1?1:0,ge=I>=1?1:0,de=y>=1?1:0,he=U>=1?1:0,P=M-E+me,ie=T-L+me,Y=O-X+me,V=R-ne+me,Ke=M-D+2*me,dt=T-Z+2*me,je=O-F+2*me,nt=R-C+2*me,it=M-le+3*me,$=T-ge+3*me,st=O-de+3*me,rt=R-he+3*me,ot=M-1+4*me,at=T-1+4*me,lt=O-1+4*me,ht=R-1+4*me,He=u&255,ze=m&255,Xe=A&255,We=f&255;let Ye=.6-M*M-T*T-O*O-R*R;if(Ye<0)o=0;else{const z=r[He+r[ze+r[Xe+r[We]]]]%32*4;Ye*=Ye,o=Ye*Ye*(se[z]*M+se[z+1]*T+se[z+2]*O+se[z+3]*R)}let Qe=.6-P*P-ie*ie-Y*Y-V*V;if(Qe<0)l=0;else{const z=r[He+E+r[ze+L+r[Xe+X+r[We+ne]]]]%32*4;Qe*=Qe,l=Qe*Qe*(se[z]*P+se[z+1]*ie+se[z+2]*Y+se[z+3]*V)}let Ze=.6-Ke*Ke-dt*dt-je*je-nt*nt;if(Ze<0)a=0;else{const z=r[He+D+r[ze+Z+r[Xe+F+r[We+C]]]]%32*4;Ze*=Ze,a=Ze*Ze*(se[z]*Ke+se[z+1]*dt+se[z+2]*je+se[z+3]*nt)}let qe=.6-it*it-$*$-st*st-rt*rt;if(qe<0)c=0;else{const z=r[He+le+r[ze+ge+r[Xe+de+r[We+he]]]]%32*4;qe*=qe,c=qe*qe*(se[z]*it+se[z+1]*$+se[z+2]*st+se[z+3]*rt)}let b=.6-ot*ot-at*at-lt*lt-ht*ht;if(b<0)_=0;else{const z=r[He+1+r[ze+1+r[Xe+1+r[We+1]]]]%32*4;b*=b,_=b*b*(se[z]*ot+se[z+1]*at+se[z+2]*lt+se[z+3]*ht)}return 27*(o+l+a+c+_)}}const Fu=Cu;function Lu(t){const e=new Uint8Array(256);for(let n=0;n<256;n++)e[n]=n;for(let n=0;n<255;n++){const i=n+~~(t()*(256-n)),s=e[n];e[n]=e[i],e[i]=s}return e}function Pu(t){let e=0,n=0,i=0,s=1;const r=Bu();return e=r(" "),n=r(" "),i=r(" "),e-=r(t),e<0&&(e+=1),n-=r(t),n<0&&(n+=1),i-=r(t),i<0&&(i+=1),function(){const o=2091639*e+s*23283064365386963e-26;return e=n,n=i,i=o-(s=o|0)}}function Bu(){let t=4022871197;return function(e){e=e.toString();for(let n=0;n<e.length;n++){t+=e.charCodeAt(n);let i=.02519603282416938*t;t=i>>>0,i-=t,i*=t,t=i>>>0,i-=t,t+=i*4294967296}return(t>>>0)*23283064365386963e-26}}function xu(t){let e,n;return e=new At({props:{interactive:!0,receiveShadow:!0,rotation:{x:-90*(Math.PI/180)},geometry:t[0],material:new wt({side:Vi,color:"grey"})}}),e.$on("click",t[10]),e.$on("contextmenu",t[11]),{c(){k(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,s){j(e,i,s),n=!0},p:ft,i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){x(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Iu(t,e,n){let{seed:i=123456789}=e,{exponentiation:s=7.5}=e,{height:r=800}=e,{lacunarity:o=1.6}=e,{octaves:l=10}=e,{persistence:a=.5}=e,{scale:c=1800}=e,{planeWidth:_=100}=e,{planeheight:h=100}=e,u=new Fu(i),m=new Ki(_,h,_,h);const A=m.attributes.position.array;for(let p=0,w=0,S=A.length;p<S;p++,w+=3)A[w+2]=f(A[w],A[w+1]);m.computeVertexNormals();function f(p,w){const S=Math.pow(2,-a),M=p/c,T=w/c;let O=1,R=1,v=0,I=0;for(let y=0;y<l;y++)I+=(u.noise2D(M*R,T*R)*.5+.5)*O,v+=O,O*=S,R*=o;return I/=v,Math.pow(I,s)*r}function d(p){N.call(this,t,p)}function g(p){N.call(this,t,p)}return t.$$set=p=>{"seed"in p&&n(1,i=p.seed),"exponentiation"in p&&n(2,s=p.exponentiation),"height"in p&&n(3,r=p.height),"lacunarity"in p&&n(4,o=p.lacunarity),"octaves"in p&&n(5,l=p.octaves),"persistence"in p&&n(6,a=p.persistence),"scale"in p&&n(7,c=p.scale),"planeWidth"in p&&n(8,_=p.planeWidth),"planeheight"in p&&n(9,h=p.planeheight)},[m,i,s,r,o,l,a,c,_,h,d,g]}class Uu extends ee{constructor(e){super(),te(this,e,Iu,xu,J,{seed:1,exponentiation:2,height:3,lacunarity:4,octaves:5,persistence:6,scale:7,planeWidth:8,planeheight:9})}}function kn(t){let e,n,i=t[0].position.x+"",s,r,o=Math.round(t[0].position.y)+"",l,a,c=Math.round(t[0].position.z)+"",_;return{c(){e=we("p"),n=Be("camera - "),s=Be(i),r=Be(", "),l=Be(o),a=Be(", "),_=Be(c)},l(h){e=Te(h,"P",{});var u=Ae(e);n=xe(u,"camera - "),s=xe(u,i),r=xe(u,", "),l=xe(u,o),a=xe(u,", "),_=xe(u,c),u.forEach(K)},m(h,u){Q(h,e,u),ue(e,n),ue(e,s),ue(e,r),ue(e,l),ue(e,a),ue(e,_)},p(h,u){u&1&&i!==(i=h[0].position.x+"")&&Bt(s,i),u&1&&o!==(o=Math.round(h[0].position.y)+"")&&Bt(l,o),u&1&&c!==(c=Math.round(h[0].position.z)+"")&&Bt(_,c)},d(h){h&&K(e)}}}function Du(t){let e,n;return e=new Zs({props:{maxPolarAngle:cs*80,target:{y:.5},enablePan:!1}}),{c(){k(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,s){j(e,i,s),n=!0},p:ft,i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){x(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Ku(t){let e,n,i,s,r;return{c(){e=we("div"),n=we("button"),i=Be("hello"),this.h()},l(o){e=Te(o,"DIV",{});var l=Ae(e);n=Te(l,"BUTTON",{class:!0});var a=Ae(n);i=xe(a,"hello"),a.forEach(K),l.forEach(K),this.h()},h(){Ce(n,"class","btn")},m(o,l){Q(o,e,l),ue(e,n),ue(n,i),s||(r=Ue(n,"click",t[13]),s=!0)},p:ft,d(o){o&&K(e),s=!1,r()}}}function Vu(t){let e,n;return e=new bu({props:{occlude:!0,distanceFactor:50,center:!0,position:{x:0,y:4,z:0},$$slots:{default:[Ku]},$$scope:{ctx:t}}}),{c(){k(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,s){j(e,i,s),n=!0},p(i,s){const r={};s&262144&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){x(e.$$.fragment,i),n=!1},d(i){H(e,i)}}}function Nu(t){let e,n,i;function s(o){t[14](o)}let r={interactive:!0,receiveShadow:!0,castShadow:!0,geometry:new os(1,3,2,10),material:new wt({color:"white"}),position:{y:2},$$slots:{default:[Vu]},$$scope:{ctx:t}};return t[1]!==void 0&&(r.mesh=t[1]),e=new At({props:r}),fe.push(()=>ye(e,"mesh",s)),e.$on("click",t[15]),e.$on("contextmenu",t[16]),{c(){k(e.$$.fragment)},l(o){G(e.$$.fragment,o)},m(o,l){j(e,o,l),i=!0},p(o,l){const a={};l&262144&&(a.$$scope={dirty:l,ctx:o}),!n&&l&2&&(n=!0,a.mesh=o[1],ve(()=>n=!1)),e.$set(a)},i(o){i||(B(e.$$.fragment,o),i=!0)},o(o){x(e.$$.fragment,o),i=!1},d(o){H(e,o)}}}function ku(t){let e,n,i,s,r,o,l,a,c,_;return e=new At({props:{castShadow:!0,receiveShadow:!0,position:{x:7,y:.5,z:5},geometry:new on(1,1,1),material:new wt({side:an,color:"black"})}}),i=new At({props:{castShadow:!0,receiveShadow:!0,position:{x:0,y:.5,z:-8},geometry:new on(1,1,1),material:new wt({side:an,color:"black"})}}),r=new rn({props:{position:{x:6,y:.5,z:-5}}}),l=new rn({props:{position:{x:-7,y:.5,z:-2}}}),c=new rn({props:{position:{x:-6,y:.5,z:6}}}),{c(){k(e.$$.fragment),n=re(),k(i.$$.fragment),s=re(),k(r.$$.fragment),o=re(),k(l.$$.fragment),a=re(),k(c.$$.fragment)},l(h){G(e.$$.fragment,h),n=oe(h),G(i.$$.fragment,h),s=oe(h),G(r.$$.fragment,h),o=oe(h),G(l.$$.fragment,h),a=oe(h),G(c.$$.fragment,h)},m(h,u){j(e,h,u),Q(h,n,u),j(i,h,u),Q(h,s,u),j(r,h,u),Q(h,o,u),j(l,h,u),Q(h,a,u),j(c,h,u),_=!0},p:ft,i(h){_||(B(e.$$.fragment,h),B(i.$$.fragment,h),B(r.$$.fragment,h),B(l.$$.fragment,h),B(c.$$.fragment,h),_=!0)},o(h){x(e.$$.fragment,h),x(i.$$.fragment,h),x(r.$$.fragment,h),x(l.$$.fragment,h),x(c.$$.fragment,h),_=!1},d(h){H(e,h),h&&K(n),H(i,h),h&&K(s),H(r,h),h&&K(o),H(l,h),h&&K(a),H(c,h)}}}function Gu(t){let e,n,i,s,r,o,l,a,c,_,h,u,m;function A(d){t[12](d)}let f={position:{x:0,y:20,z:20},fov:90,$$slots:{default:[Du]},$$scope:{ctx:t}};return t[0]!==void 0&&(f.camera=t[0]),e=new Xs({props:f}),fe.push(()=>ye(e,"camera",A)),s=new lr({props:{shadow:{mapSize:[2048,2048],camera:{bottom:-10,left:-10,right:10,top:10}},position:{x:10,y:10,z:10}}}),o=new sr({props:{intensity:.2}}),a=new Gt({props:{scale:t[3],position:{x:t[4],y:t[5],z:t[6]},$$slots:{default:[Nu]},$$scope:{ctx:t}}}),_=new Uu({}),_.$on("click",Hu),_.$on("contextmenu",t[17]),u=new Gt({props:{$$slots:{default:[ku]},$$scope:{ctx:t}}}),{c(){k(e.$$.fragment),i=re(),k(s.$$.fragment),r=re(),k(o.$$.fragment),l=re(),k(a.$$.fragment),c=re(),k(_.$$.fragment),h=re(),k(u.$$.fragment)},l(d){G(e.$$.fragment,d),i=oe(d),G(s.$$.fragment,d),r=oe(d),G(o.$$.fragment,d),l=oe(d),G(a.$$.fragment,d),c=oe(d),G(_.$$.fragment,d),h=oe(d),G(u.$$.fragment,d)},m(d,g){j(e,d,g),Q(d,i,g),j(s,d,g),Q(d,r,g),j(o,d,g),Q(d,l,g),j(a,d,g),Q(d,c,g),j(_,d,g),Q(d,h,g),j(u,d,g),m=!0},p(d,g){const p={};g&262144&&(p.$$scope={dirty:g,ctx:d}),!n&&g&1&&(n=!0,p.camera=d[0],ve(()=>n=!1)),e.$set(p);const w={};g&8&&(w.scale=d[3]),g&112&&(w.position={x:d[4],y:d[5],z:d[6]}),g&262150&&(w.$$scope={dirty:g,ctx:d}),a.$set(w);const S={};g&262144&&(S.$$scope={dirty:g,ctx:d}),u.$set(S)},i(d){m||(B(e.$$.fragment,d),B(s.$$.fragment,d),B(o.$$.fragment,d),B(a.$$.fragment,d),B(_.$$.fragment,d),B(u.$$.fragment,d),m=!0)},o(d){x(e.$$.fragment,d),x(s.$$.fragment,d),x(o.$$.fragment,d),x(a.$$.fragment,d),x(_.$$.fragment,d),x(u.$$.fragment,d),m=!1},d(d){H(e,d),d&&K(i),H(s,d),d&&K(r),H(o,d),d&&K(l),H(a,d),d&&K(c),H(_,d),d&&K(h),H(u,d)}}}function ju(t){let e,n,i,s=Math.round(t[3])+"",r,o,l,a,c,_,h,u,m,A,f,d=t[0]&&kn(t);return u=new Os({props:{$$slots:{default:[Gu]},$$scope:{ctx:t}}}),{c(){e=we("div"),n=we("p"),i=Be("scale - "),r=Be(s),o=re(),d&&d.c(),l=re(),a=we("button"),c=Be("test"),_=re(),h=we("div"),k(u.$$.fragment),this.h()},l(g){e=Te(g,"DIV",{class:!0});var p=Ae(e);n=Te(p,"P",{});var w=Ae(n);i=xe(w,"scale - "),r=xe(w,s),w.forEach(K),o=oe(p),d&&d.l(p),l=oe(p),a=Te(p,"BUTTON",{class:!0});var S=Ae(a);c=xe(S,"test"),S.forEach(K),p.forEach(K),_=oe(g),h=Te(g,"DIV",{class:!0});var M=Ae(h);G(u.$$.fragment,M),M.forEach(K),this.h()},h(){Ce(a,"class","btn"),Ce(e,"class","absolute z-10 flex flex-col items-center justify-center"),Ce(h,"class","h-full w-full overflow-clip")},m(g,p){Q(g,e,p),ue(e,n),ue(n,i),ue(n,r),ue(e,o),d&&d.m(e,null),ue(e,l),ue(e,a),ue(a,c),Q(g,_,p),Q(g,h,p),j(u,h,null),m=!0,A||(f=Ue(a,"click",t[11]),A=!0)},p(g,[p]){(!m||p&8)&&s!==(s=Math.round(g[3])+"")&&Bt(r,s),g[0]?d?d.p(g,p):(d=kn(g),d.c(),d.m(e,l)):d&&(d.d(1),d=null);const w={};p&262271&&(w.$$scope={dirty:p,ctx:g}),u.$set(w)},i(g){m||(B(u.$$.fragment,g),m=!0)},o(g){x(u.$$.fragment,g),m=!1},d(g){g&&K(e),d&&d.d(),g&&K(_),g&&K(h),H(u),A=!1,f()}}}const Hu=t=>{};function zu(t,e,n){let i,s,r,o;const l=Lt(1);W(t,l,M=>n(3,i=M));const a=Lt(0);W(t,a,M=>n(4,s=M));const c=Lt(0);W(t,c,M=>n(5,r=M));const _=Lt(0);W(t,_,M=>n(6,o=M));let h,u,m=!1;const A=()=>{console.log(h.position)};function f(M){h=M,n(0,h)}const d=()=>{console.log("world")};function g(M){u=M,n(1,u)}return[h,u,m,i,s,r,o,l,a,c,_,A,f,d,g,()=>{n(2,m=!0)},()=>{n(2,m=!1)},M=>{const{x:T,y:O,z:R}=M.detail.point;tt(a,s=T,s),tt(c,r=O,r),tt(_,o=R,o)}]}class Xu extends ee{constructor(e){super(),te(this,e,zu,ju,J,{})}}function Wu(t){let e,n,i,s;return i=new Xu({}),{c(){e=re(),n=we("div"),k(i.$$.fragment),this.h()},l(r){vi('[data-svelte="svelte-1hi2ed4"]',document.head).forEach(K),e=oe(r),n=Te(r,"DIV",{class:!0});var l=Ae(n);G(i.$$.fragment,l),l.forEach(K),this.h()},h(){document.title="Once Upon a Threlte",Ce(n,"class","relative h-screen w-screen")},m(r,o){Q(r,e,o),Q(r,n,o),j(i,n,null),s=!0},p:ft,i(r){s||(B(i.$$.fragment,r),s=!0)},o(r){x(i.$$.fragment,r),s=!1},d(r){r&&K(e),r&&K(n),H(i)}}}class Md extends ee{constructor(e){super(),te(this,e,null,Wu,J,{})}}export{Md as default};
